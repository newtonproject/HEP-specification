<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础架构 | HEP-specification</title>
    <meta name="description" content="HEP(Hyper Exchange Protocol) Specification for DApp development in Newton ecosystem">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/HEP-specification/assets/css/0.styles.ba461f21.css" as="style"><link rel="preload" href="/HEP-specification/assets/js/app.419242cf.js" as="script"><link rel="preload" href="/HEP-specification/assets/js/2.810d226b.js" as="script"><link rel="preload" href="/HEP-specification/assets/js/22.4852e8c3.js" as="script"><link rel="preload" href="/HEP-specification/assets/js/3.aada4df1.js" as="script"><link rel="prefetch" href="/HEP-specification/assets/js/10.07b5122b.js"><link rel="prefetch" href="/HEP-specification/assets/js/11.07ab2f5a.js"><link rel="prefetch" href="/HEP-specification/assets/js/12.ccd7c691.js"><link rel="prefetch" href="/HEP-specification/assets/js/13.590ca748.js"><link rel="prefetch" href="/HEP-specification/assets/js/14.2d893eb2.js"><link rel="prefetch" href="/HEP-specification/assets/js/15.b78077ba.js"><link rel="prefetch" href="/HEP-specification/assets/js/16.7829fee6.js"><link rel="prefetch" href="/HEP-specification/assets/js/17.0d23eaee.js"><link rel="prefetch" href="/HEP-specification/assets/js/18.fda3c910.js"><link rel="prefetch" href="/HEP-specification/assets/js/19.388dc885.js"><link rel="prefetch" href="/HEP-specification/assets/js/20.bd33d416.js"><link rel="prefetch" href="/HEP-specification/assets/js/21.fec79911.js"><link rel="prefetch" href="/HEP-specification/assets/js/23.02ca9ad2.js"><link rel="prefetch" href="/HEP-specification/assets/js/24.a27ecedb.js"><link rel="prefetch" href="/HEP-specification/assets/js/25.6d591597.js"><link rel="prefetch" href="/HEP-specification/assets/js/26.5b54232e.js"><link rel="prefetch" href="/HEP-specification/assets/js/27.db582809.js"><link rel="prefetch" href="/HEP-specification/assets/js/28.6fe812df.js"><link rel="prefetch" href="/HEP-specification/assets/js/29.e2c1a4a5.js"><link rel="prefetch" href="/HEP-specification/assets/js/30.c8bfc05d.js"><link rel="prefetch" href="/HEP-specification/assets/js/31.efd4bdf8.js"><link rel="prefetch" href="/HEP-specification/assets/js/32.8e817237.js"><link rel="prefetch" href="/HEP-specification/assets/js/33.5124ac4c.js"><link rel="prefetch" href="/HEP-specification/assets/js/34.425f35bd.js"><link rel="prefetch" href="/HEP-specification/assets/js/35.102079c4.js"><link rel="prefetch" href="/HEP-specification/assets/js/36.476ac90a.js"><link rel="prefetch" href="/HEP-specification/assets/js/37.04ff4ab5.js"><link rel="prefetch" href="/HEP-specification/assets/js/38.7da043dd.js"><link rel="prefetch" href="/HEP-specification/assets/js/39.b6051c5a.js"><link rel="prefetch" href="/HEP-specification/assets/js/4.65a1a4c3.js"><link rel="prefetch" href="/HEP-specification/assets/js/40.0f513e54.js"><link rel="prefetch" href="/HEP-specification/assets/js/41.d680db47.js"><link rel="prefetch" href="/HEP-specification/assets/js/42.5bf0e2d1.js"><link rel="prefetch" href="/HEP-specification/assets/js/43.1d061f75.js"><link rel="prefetch" href="/HEP-specification/assets/js/44.f794bd6d.js"><link rel="prefetch" href="/HEP-specification/assets/js/45.c060c4a9.js"><link rel="prefetch" href="/HEP-specification/assets/js/46.60bf6604.js"><link rel="prefetch" href="/HEP-specification/assets/js/47.88292d12.js"><link rel="prefetch" href="/HEP-specification/assets/js/48.f9953027.js"><link rel="prefetch" href="/HEP-specification/assets/js/49.79770fab.js"><link rel="prefetch" href="/HEP-specification/assets/js/5.11a4bfaf.js"><link rel="prefetch" href="/HEP-specification/assets/js/50.c47ea8c2.js"><link rel="prefetch" href="/HEP-specification/assets/js/51.f7c689e5.js"><link rel="prefetch" href="/HEP-specification/assets/js/52.081ff357.js"><link rel="prefetch" href="/HEP-specification/assets/js/53.e66884bb.js"><link rel="prefetch" href="/HEP-specification/assets/js/54.6884c4e5.js"><link rel="prefetch" href="/HEP-specification/assets/js/55.e1ad1900.js"><link rel="prefetch" href="/HEP-specification/assets/js/56.0bb83b11.js"><link rel="prefetch" href="/HEP-specification/assets/js/57.f85086c4.js"><link rel="prefetch" href="/HEP-specification/assets/js/58.2d1f834a.js"><link rel="prefetch" href="/HEP-specification/assets/js/59.18855501.js"><link rel="prefetch" href="/HEP-specification/assets/js/6.ee814126.js"><link rel="prefetch" href="/HEP-specification/assets/js/7.cfd8f4f1.js"><link rel="prefetch" href="/HEP-specification/assets/js/8.01bf51c2.js"><link rel="prefetch" href="/HEP-specification/assets/js/9.849c036f.js">
    <link rel="stylesheet" href="/HEP-specification/assets/css/0.styles.ba461f21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/HEP-specification/" class="home-link router-link-active"><!----> <span class="site-name">HEP-specification</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/HEP-specification/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/HEP-specification/hep-node/" class="nav-link router-link-active">
  hep-node
</a></div><div class="nav-item"><a href="/HEP-specification/oracle/oracle.html" class="nav-link">
  oracle
</a></div><div class="nav-item"><a href="https://github.com/newtonproject/HEP-specification" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/HEP-specification/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/HEP-specification/hep-node/" class="nav-link router-link-active">
  hep-node
</a></div><div class="nav-item"><a href="/HEP-specification/oracle/oracle.html" class="nav-link">
  oracle
</a></div><div class="nav-item"><a href="https://github.com/newtonproject/HEP-specification" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/HEP-specification/" class="sidebar-link">home</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HEP-specification/#hep-ecosystem" class="sidebar-link">HEP Ecosystem</a></li><li class="sidebar-sub-header"><a href="/HEP-specification/#architecture" class="sidebar-link">Architecture</a></li><li class="sidebar-sub-header"><a href="/HEP-specification/#building-your-dapp" class="sidebar-link">Building your Dapp</a></li></ul></li><li><a href="/HEP-specification/oracle/oracle.html" class="sidebar-link">oracle</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HEP-specification/oracle/oracle.html#why" class="sidebar-link">Why?</a></li><li class="sidebar-sub-header"><a href="/HEP-specification/oracle/oracle.html#how" class="sidebar-link">How?</a></li></ul></li><li><a href="/HEP-specification/DWeb.html" class="sidebar-link">DWeb</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/HEP-specification/DWeb.html#user-account-creation-and-login" class="sidebar-link">User Account Creation and Login</a></li><li class="sidebar-sub-header"><a href="/HEP-specification/DWeb.html#payments" class="sidebar-link">Payments</a></li><li class="sidebar-sub-header"><a href="/HEP-specification/DWeb.html#placeorder" class="sidebar-link">PlaceOrder</a></li></ul></li><li><a href="/HEP-specification/tutorial/" class="sidebar-link">Tutorial</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基础架构"><a href="#基础架构" class="header-anchor">#</a> 基础架构</h1> <img src="https://gitlab.newtonproject.org/xiawu/newton-documentation/uploads/012152af18aafb9f607fcb9967ccbcc4/14941558591441_.pic_hd.jpg"> <ol><li>NewChain  NewNet  NewIoT  NewAI</li></ol> <blockquote><p>Newton底层技术支持</p></blockquote> <ol start="2"><li><p>基础合约 + MarketPlace(提供合约模板)</p></li> <li><p>Proof Engine + HEP-Node</p></li></ol> <blockquote><p>Proof Engine: 用于查询工作量信息，提交数据信息（基于Proof的Blockchain）<br>
HEP-Node: 提供查询接口服务 第三方通过HEP-Node，去 ProofEngine 实现所需要的功能</p></blockquote> <ol start="4"><li>行业SDK, 基础服务SDK, Oracle服务</li></ol> <blockquote><p>行业SDK: TBD<br>
基础服务SDK: 联合登录，数据上链，New 支付（包括Native, Web, H5）</p></blockquote> <h1 id="dapp-分类"><a href="#dapp-分类" class="header-anchor">#</a> Dapp 分类</h1> <ol><li>Native Dapp</li></ol> <blockquote><p>运行在手机端的app，包括Native和js</p></blockquote> <ol start="2"><li>Web Dapp</li></ol> <blockquote><p>在网站中的app，需要接入提供的 hep.js,实现登录，提交数据等功能</p></blockquote> <ol start="3"><li>NewDapp</li></ol> <blockquote><p>运行在NewVM</p></blockquote> <h2 id="dapp-接入流程"><a href="#dapp-接入流程" class="header-anchor">#</a> Dapp 接入流程</h2> <h3 id="公共部分"><a href="#公共部分" class="header-anchor">#</a> 公共部分</h3> <ol><li>使用NewID登录 developer（使用NewId登录） 网站，填写DApp信息</li></ol> <blockquote><ol><li>申请的Dapp 类型（web，native(android/ios), h5）</li> <li>Icon</li> <li>Native的话需要 包名或者Bundle</li> <li>网站的话需要 api 域名</li> <li>应用名称</li> <li>填写公钥信息或者developer自动生成，给三方app私钥</li> <li>节点名称</li></ol></blockquote> <ol start="2"><li>获取信息如下:</li></ol> <blockquote><ol><li>AppId</li> <li>ApiKey, ApiSecret(可动态替换)</li> <li>对应平台的SDK。</li></ol></blockquote> <h3 id="web-部分流程"><a href="#web-部分流程" class="header-anchor">#</a> web 部分流程</h3> <ol><li>获取js的sdk（Hep.js）填写AppId，</li> <li>实现登录，支付，上链的回调接口，正在扫描中...</li> <li>需要为每笔商品生成交易编号</li></ol> <h4 id="hep-protocol"><a href="#hep-protocol" class="header-anchor">#</a> Hep protocol</h4> <ol><li>需要填入AppId,(需要时间戳，标记过期)</li> <li>Hep://AppId/ActionType/Params</li></ol> <blockquote><p>AppId 用于网址寻址，加密传输
ActionType:Login, Pay, PlaceOrder...</p></blockquote> <h4 id="hep-provider"><a href="#hep-provider" class="header-anchor">#</a> Hep provider</h4> <ol><li>登录将newid 信息传递到H5</li> <li>调起支付</li> <li>上链</li></ol> <h4 id="hep-node"><a href="#hep-node" class="header-anchor">#</a> Hep Node</h4> <h4 id="demo-网站"><a href="#demo-网站" class="header-anchor">#</a> Demo 网站</h4> <h5 id="登录"><a href="#登录" class="header-anchor">#</a> 登录</h5> <ol><li>点击使用 NewID 登录，通过 Hep.js 生成登录的QRCode（Hep://324/0）</li> <li>NewPay 扫描到信息，根据AppId和ActionType，先去 Hep-node 验证App信息，验证合法之后, 显示Dapp信息，调取授权页面，签名信息，发送到 Hep-node, Hep-node 查询ProofEngine 拿到登录需要的信息，发送到dapp的api接口（Hep.js处理，同时记录登录信息），Hep.js 拿到数据自己Decode验证信息，确认数据的合法性，通知网站前台页面登录成功。</li></ol> <h5 id="支付"><a href="#支付" class="header-anchor">#</a> 支付</h5> <ol><li>点击使用 New 支付，通过 Hep.js 生成支付的QRCode（Hep://324/1/100&amp;address）</li> <li>NewPay 扫描到信息，验证App信息，调取授权，支付，获取txid，将txid，发送到Hep-node，同时记录交易信息，然后发送txid到三方网站的Hep.js, hep.js 去链上查询交易信息，确认后显示支付成功页面</li></ol> <h5 id="上链"><a href="#上链" class="header-anchor">#</a> 上链</h5> <ol><li>点击数据上链，生成QRCode（Hep://324/2/(三方app的交易编号)）</li> <li>NewPay 扫描信息，验证App信息，授权，查询是否有上链资格，根据订单编号信息，获取交易信息，交易上链，发送txid到Hep-node和rpc，hep-node 将上链信息提交到Hep.js 自行处理数据信息，显示成功页面</li></ol> <h3 id="节点选择"><a href="#节点选择" class="header-anchor">#</a> 节点选择</h3> <ol><li>根据参加节点锁定的new的数量决定三方DApp的权益</li></ol> <blockquote><p>eg: 锁定 1000w New, （计算NewMall大致获得的NF，和交易额）设置每天获取NF的帽，比如 10W nf，如果超过10w nf数额，那么改Dapp就没有上链的能力，需要等到第二天，刷新数据（类似每月的定额发票），
关于收税：一方面从该Dapp的NF中扣点收税，进入NewTax，比如今天NewMall今天产生了10W NF，那么有30% NF 产生的new进入 newtax</p></blockquote> <h4 id="newcard-添加（开门，交互逻辑）"><a href="#newcard-添加（开门，交互逻辑）" class="header-anchor">#</a> NewCard 添加（开门，交互逻辑）</h4></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/HEP-specification/assets/js/app.419242cf.js" defer></script><script src="/HEP-specification/assets/js/2.810d226b.js" defer></script><script src="/HEP-specification/assets/js/22.4852e8c3.js" defer></script><script src="/HEP-specification/assets/js/3.aada4df1.js" defer></script>
  </body>
</html>
