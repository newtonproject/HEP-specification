(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{274:function(e,t,a){"use strict";a.r(t);var r=a(2),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"api-design-guidelines"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api-design-guidelines"}},[e._v("#")]),e._v(" API Design Guidelines")]),e._v(" "),a("h1",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),a("p",[e._v("HEP APIs follow the "),a("a",{attrs:{href:"https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm",title:"RESTful Architectural Style",target:"_blank",rel:"noopener noreferrer"}},[e._v("RESTful"),a("OutboundLink")],1),e._v(" architectural style as much as possible. To support our objectives, we have developed a set of rules, standards, and conventions that apply to the design of RESTful APIs.")]),e._v(" "),a("p",[e._v("We are sharing these guidelines to help propagate good API design practices in general. We have pulled extensively from the broader community and believe that it is important to give back. The documentation is as generic as possible to make it easier to incorporate into the guidelines you use in your projects. If you have any updates, suggestions, or additions that you would like to contribute, please feel free to submit a PR or create an issue.")]),e._v(" "),a("h3",{attrs:{id:"document-semantics-formatting-and-naming"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#document-semantics-formatting-and-naming"}},[e._v("#")]),e._v(" Document Semantics, Formatting, and Naming")]),e._v(" "),a("p",[e._v('The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in '),a("a",{attrs:{href:"https://www.ietf.org/rfc/rfc2119.txt",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 2119"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v('The words "REST" and "RESTful" MUST be written as presented here, representing the acronym as all upper-case letters. This is also true of "JSON," "XML," and other acronyms.')]),e._v(" "),a("p",[e._v("Machine-readable text, such as URLs, HTTP verbs, and source code, are represented using a fixed-width font.")]),e._v(" "),a("p",[e._v("URIs containing variable blocks are specified according to "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6570",target:"_blank",rel:"noopener noreferrer"}},[e._v("URI Template RFC 6570"),a("OutboundLink")],1),e._v(". For example, a URL containing a variable called account_id would be shown as https://foo.com/accounts/{account_id}/.")]),e._v(" "),a("p",[e._v("HTTP headers are written in camelCase + hyphenated syntax, e.g. Foo-Request-Id.")]),e._v(" "),a("h3",{attrs:{id:"contributors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contributors"}},[e._v("#")]),e._v(" Contributors")]),e._v(" "),a("p",[e._v("TBD")]),e._v(" "),a("h1",{attrs:{id:"table-of-contents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[e._v("#")]),e._v(" Table Of Contents")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#interpretation"}},[e._v("Interpreting the Guidelines")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#terms"}},[e._v("Terms Used")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#service-design-principles"}},[e._v("Service Design Principles")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#loose_coupling"}},[e._v("Loose Coupling")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#encapsulation"}},[e._v("Encapsulation")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#stability"}},[e._v("Stability")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#reusable"}},[e._v("Reusable")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#contract-based"}},[e._v("Contract-based")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#consistency"}},[e._v("Consistency")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#ease-of-use"}},[e._v("Ease of Use")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#externalizable"}},[e._v("Externalizable")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-methods-headers-status"}},[e._v("HTTP Methods, Headers and Statuses")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#data-resources"}},[e._v("Data Resources/HTTP Methods")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#business-capabilities"}},[e._v("Business Capabilities and Resource Modeling")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-methods"}},[e._v("HTTP Methods")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#processing"}},[e._v("Processing")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-headers"}},[e._v("HTTP Headers")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#assumptions"}},[e._v("Assumptions")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-standard-headers"}},[e._v("HTTP Standard Headers")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-custom-headers"}},[e._v("HTTP Custom Headers")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-header-propagation"}},[e._v("HTTP Header Propagation")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#http-status-codes"}},[e._v("HTTP Status Codes")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#status-code-ranges"}},[e._v("Status Code Ranges")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#status-reporting"}},[e._v("Status Reporting")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#allowed-status-codes"}},[e._v("Allowed Status Codes List")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#mapping"}},[e._v("HTTP Method to Status Code Mapping")])])])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#hypermedia"}},[e._v("Hypermedia")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#hateoas"}},[e._v("HATEOAS")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#hateoas-api"}},[e._v("Hypermedia Compliant API")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#link-description-object"}},[e._v("Link Description Object")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#links-array"}},[e._v("Links Array")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#link-relation-type"}},[e._v("Link Relation Type")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#use-cases"}},[e._v("Use Cases")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#naming-conventions"}},[e._v("Naming Conventions")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#uri-component-names"}},[e._v("URI Component Names")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#field-names"}},[e._v("Field Names")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#enum-names"}},[e._v("Enum Names")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#link-relation-names"}},[e._v("Link Relation Names")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#file-names"}},[e._v("File Names")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#uri"}},[e._v("URI")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#resource-path"}},[e._v("Resource Path")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#query-parameters"}},[e._v("Query Parameters")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#json-schema"}},[e._v("JSON Schema")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#api-contract-description"}},[e._v("API Contract Description")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#schema"}},[e._v("$schema")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#migration-from-draft03"}},[e._v("Migration From draft-03")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#advanced-syntax-draft04"}},[e._v("Advanced Syntax draft-04")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#json-types"}},[e._v("JSON Types")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#json-primitive"}},[e._v("JSON Primitive Types")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#string"}},[e._v("String")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#enum"}},[e._v("Enumeration")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#number"}},[e._v("Number")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#array"}},[e._v("Array")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#null"}},[e._v("Null")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#additional-properties"}},[e._v("Additional Properties")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#common-types"}},[e._v("Common Types")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#address"}},[e._v("Address")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#money"}},[e._v("Money")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#apr"}},[e._v("Percentage, Interest Rate, or APR")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#internationalization"}},[e._v("Internationalization")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#date-time"}},[e._v("Date,Time and Timezone")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#formats"}},[e._v("Formats")])])])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#error-handling"}},[e._v("Error Handling")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#error-schema"}},[e._v("Error Schema")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#error-samples"}},[e._v("Error Samples")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#error-declaration"}},[e._v("Error Declaration In API Specification")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#userguide-errors"}},[e._v("Samples With Error Scenarios In Documentation")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#error-catalog"}},[e._v("Error Catalog")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#api-versioning"}},[e._v("API Versioning")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#api-lifecycle"}},[e._v("API Lifecycle")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#api-versioning-policy"}},[e._v("API Versioning Policy")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#backwards-compatibility"}},[e._v("Backwards Compatibility")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#eol-policy"}},[e._v("End of Life Policy")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#deprecation"}},[e._v("Deprecation")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#deprecation-terms-used"}},[e._v("Terms Used")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#deprecation-background"}},[e._v("Background")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#deprecation-requirements"}},[e._v("Requirements")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#deprecation-solution"}},[e._v("Solution")])])])]),e._v(" "),a("li",[a("a",{attrs:{href:"#patterns-and-use-cases"}},[e._v("Patterns And Use Cases")])]),e._v(" "),a("li",[a("RouterLink",{attrs:{to:"/api-style-guide/references.html"}},[e._v("References")])],1)]),e._v(" "),a("h1",{attrs:{id:"interpretation"}},[e._v("Interpreting The Guidelines")]),e._v(" "),a("h2",{attrs:{id:"terms"}},[e._v("Terms Used")]),e._v(" "),a("h4",{attrs:{id:"resource"}},[e._v("Resource")]),e._v(" "),a("p",[e._v("The key abstraction of information in REST is a resource. According to "),a("a",{attrs:{href:"https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_2",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fielding's dissertation section 5.2"),a("OutboundLink")],1),e._v(', any information that can be named can be a resource: a document or image, a temporal service (e.g. "today\'s weather in Los Angeles"), a collection of other resources, a non-virtual object (e.g. a person), and so on. A resource is a conceptual mapping to a set of entities, not the entity that corresponds to the mapping at any particular point in time. More precisely, a resource R is a temporally varying membership function '),a("code",[e._v("MR(t)")]),e._v(", that for time "),a("code",[e._v("t")]),e._v(" maps to a set of entities, or values, that are equivalent. The values in the set may be resource representations and/or resource identifiers.")]),e._v(" "),a("p",[e._v("A resource can also map to the empty set, that allows references to be made to a concept before any realization of that concept exists.")]),e._v(" "),a("h4",{attrs:{id:"resource-identifier"}},[e._v("Resource Identifier")]),e._v(" "),a("p",[e._v("REST uses a resource identifier to identify the particular resource instance involved in an interaction between components. The naming authority (an organization providing APIs, for example) that assigned the resource identifier making it possible to reference the resource, is responsible for maintaining the semantic validity of the mapping over time (ensuring that the membership function does not change). - "),a("a",{attrs:{href:"https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_2",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fielding's dissertation section 5.2"),a("OutboundLink")],1)]),e._v(" "),a("h4",{attrs:{id:"representation"}},[e._v("Representation")]),e._v(" "),a("p",[e._v("REST components perform actions on a resource by using a representation to capture the current or intended state of that resource and by transferring that representation between components. A representation is a sequence of bytes, plus representation metadata to describe those bytes - "),a("a",{attrs:{href:"https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_2",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fielding dissertation section 5.2"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h4",{attrs:{id:"domain"}},[e._v("Domain")]),e._v(" "),a("p",[e._v("According to Wikipedia, a "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Domain_model",target:"_blank",rel:"noopener noreferrer"}},[e._v("domain model"),a("OutboundLink")],1),e._v(" is a system of abstractions that describes selected aspects of a sphere of knowledge, influence, or activity. The concepts include the data involved in a business, and the rules that the business uses in relation to that data. As an example, the PayPal domain model includes domains such as Payment, Risk, Compliance, Identity, Customer Support, etc.")]),e._v(" "),a("h4",{attrs:{id:"capability"}},[e._v("Capability")]),e._v(" "),a("p",[e._v("Capability represents a business-oriented and customer-facing view of an organization's business logic. Capabilities could be used to organize portfolio of APIs as a stable, business-driven view of its system, consumable by customers and experiences. Examples of capability are: Compliance, Credit, Identity, Retail and Risk, among other things.")]),e._v(" "),a("p",[e._v("Capabilities drive the interface, while domains are more coarse-grained and closer to the code and the organization's structure. Capability and domain are seen as orthogonal concerns from a service perspective.")]),e._v(" "),a("h4",{attrs:{id:"namespace"}},[e._v("Namespace")]),e._v(" "),a("p",[e._v("Capabilities drive service modeling and namespace concerns in an API portfolio. Namespaces are part of the Business Capability Model. Examples of namespace are: compliance, devices, transfers, credit, limits, etc.")]),e._v(" "),a("p",[e._v("Namespaces should reflect the domain that logically groups a set of business capabilities. Domain definition should reflect the customer's perspective on how platform capabilities are organized. Note that these may not necessarily reflect the company's hierarchy, organization, or (existing) code structure. In some cases, domain definitions are aspirational, in the sense that these reflect the target, customer-oriented platform organization model. Underlying service implementations and organization structures may need to migrate to reflect these boundaries over time.")]),e._v(" "),a("h4",{attrs:{id:"service"}},[e._v("Service")]),e._v(" "),a("p",[e._v("Services provide a generic API for accessing and manipulating the value set of a "),a("a",{attrs:{href:"#resource"}},[e._v("resource")]),e._v(", regardless of how the membership function is defined or the type of software that is handling the request. Services are generic pieces of software that can perform any number of functions. It is, therefore, instructive to think about the different types of services that exist.")]),e._v(" "),a("p",[e._v("Logically, we can segment the services and the APIs that they expose into two categories:")]),e._v(" "),a("ol",[a("li",[a("strong",[e._v("Capability APIs")]),e._v(" are public APIs exposed by services implementing generic, reusable business capabilities.")]),e._v(" "),a("li",[a("strong",[e._v("Experience-specific APIs")]),e._v(" are built on top of capability APIs and expose functionality which may be either specific to a channel, or optimized for a context-specific specialization of a generic capability. Contextual information could be related to time, location, device, channel, identity, user, role, privilege level among other things.")])]),e._v(" "),a("h5",{attrs:{id:"capability-based-services-and-apis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#capability-based-services-and-apis"}},[e._v("#")]),e._v(" Capability-based Services and APIs")]),e._v(" "),a("p",[e._v("Capability APIs are public interfaces to reusable business capabilities. "),a("em",[e._v("Public")]),e._v(" implies that these APIs are limited only to the interfaces meant for consumption by front-end experiences, external consumers, or internal consumers from a different domain.")]),e._v(" "),a("h5",{attrs:{id:"experience-based-services-and-apis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#experience-based-services-and-apis"}},[e._v("#")]),e._v(" Experience-based Services and APIs")]),e._v(" "),a("p",[e._v("Experience-specific services provide minimal additional business logic over core capabilities, and mainly provide transformation and lightweight orchestration to tailor an interaction to the needs of a specific experience, channel or device. Their input/output functionality is limited to service calls.")]),e._v(" "),a("h4",{attrs:{id:"client"}},[e._v("Client, API Client, API Consumer")]),e._v(" "),a("p",[e._v("An entity that invokes an API request and consumes the API response.")]),e._v(" "),a("h1",{attrs:{id:"service-design-principles"}},[e._v("Service Design Principles")]),e._v(" "),a("p",[e._v("This section captures the principles guiding the design of the services that expose APIs to internal and external developers, adjacencies, partners and affiliates. A service refers to functionality pertaining to a particular capability, exposed as an API.")]),e._v(" "),a("p",[e._v("Following are the core design principles for a service.")]),e._v(" "),a("h2",{attrs:{id:"loose_coupling"}},[e._v("Loose Coupling")]),e._v(" "),a("p",[a("strong",[e._v("Services and consumers must be loosely coupled from each other.")])]),e._v(" "),a("p",[e._v("Coupling refers to a connection or relationship between two things. A measure of coupling is comparable to a level of dependency. This principle advocates the design of service contracts, with a constant emphasis on reducing ("),a("em",[e._v("loosening")]),e._v(") dependencies between the service contract, its implementation, and service consumers.")]),e._v(" "),a("p",[e._v("The principle of Loose Coupling promotes the independent design and evolution of a service’s logic and implementation while still emphasizing baseline interoperability with consumers that have come to rely on the service’s capabilities.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("A service contract should not expose implementation details")]),e._v(" "),a("li",[e._v("A service contract can evolve without impacting existing consumers")]),e._v(" "),a("li",[e._v("A service in a particular domain can evolve independently of other domains")])]),e._v(" "),a("h2",{attrs:{id:"encapsulation"}}),e._v("Encapsulation"),e._v(" "),a("p",[a("strong",[e._v("A domain service can access data and functionality it does not own through other service contracts only.")])]),e._v(" "),a("p",[e._v("A service exposes functionality that comprises the functionality and data it owns and implements, as well as the functionality and data it depends upon which it does not own. This principle advocates that any functionality or data that a service depends on and which it does not own must be accessed through service contracts only.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("A service has a clear isolation boundary - a clear scope of ownership in terms of functionality and data")]),e._v(" "),a("li",[e._v("A service cannot expose the data it does not own directly")])]),e._v(" "),a("h2",{attrs:{id:"stability"}}),e._v("Stability"),e._v(" "),a("p",[a("strong",[e._v("Service contracts must be stable.")])]),e._v(" "),a("p",[e._v("Services must be designed in such a way that the contract they expose remains valid for existing customers. Should the service contract need to evolve in an incompatible fashion for the consumer, this should be communicated clearly.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("Existing clients of a service must be supported for a documented period of time")]),e._v(" "),a("li",[e._v("Additional functionality must be introduced in a way that does not impact existing consumers")]),e._v(" "),a("li",[e._v("Deprecation and migration policies must be clearly stated to set consumers' expectations")])]),e._v(" "),a("h2",{attrs:{id:"reusable"}}),e._v("Reusable"),e._v(" "),a("p",[a("strong",[e._v("Services must be developed to be reusable across multiple contexts and by multiple consumers.")])]),e._v(" "),a("p",[e._v("The main goal of an API platform is to enable applications to be developed quickly and cost effectively by using and combining services. This is possible only if the service contracts have been developed with flexibility for multiple use-cases and multiple consumers. This principle advocates that services be developed in a manner that enables them to be used by multiple consumers and in multiple contexts, some of which may evolve over time.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("A service contract should be designed for not just the immediate context, but with support and/or extensibility to be used by multiple consumers in different contexts")]),e._v(" "),a("li",[e._v("A service contract may need to incrementally evolve to support multiple contexts and consumers over time")])]),e._v(" "),a("h2",{attrs:{id:"contract-based"}}),e._v("Contract-based"),e._v(" "),a("p",[a("strong",[e._v("Functionality and data must only be exposed through standardized service contracts.")])]),e._v(" "),a("p",[e._v("A service exposes its purpose and capabilities via a service contract. A service contract comprises of functional aspects, non-functional aspects (such as availability, response-time), and business aspects (such as cost-per-call, terms and conditions). "),a("em",[e._v("Standardized")]),e._v(" means that the service contracts must be compliant with the contract design standards.")]),e._v(" "),a("p",[e._v("This principle advocates that all functionality and data must only be exposed through standardized service contracts. Consumers of services can, therefore, understand and access functionality and data only through service contracts.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("Functionality and data cannot be understood or accessed outside of service contracts")]),e._v(" "),a("li",[e._v("Each piece of data (such as that managed in a datastore) is owned by only one service")])]),e._v(" "),a("h2",{attrs:{id:"consistency"}}),e._v("Consistency"),e._v(" "),a("p",[a("strong",[e._v("Services must follow a common set of rules, interaction styles, vocabulary and shared types.")])]),e._v(" "),a("p",[e._v("A set of rules prescribes the definition of services in order to expose those in a consistent manner. This principle increases the ease of use of the API platform by reducing the learning curve for consumers of new services.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("A set of standards is defined for services to comply with")]),e._v(" "),a("li",[e._v("A service should use vocabulary from common and shared dictionaries")]),e._v(" "),a("li",[e._v("Compatible interaction styles, service granularity and shared types are key for full interoperability and ease of service compositions")])]),e._v(" "),a("h2",{attrs:{id:"ease-of-use"}}),e._v("Ease Of Use"),e._v(" "),a("p",[a("strong",[e._v("Services must be easy to use and compose in consumers (and applications).")])]),e._v(" "),a("p",[e._v("A service that is difficult and time consuming to use reduces the benefits of a microservices architecture by encouraging consumers to find alternate mechanisms to access the same functionality. Composability means that services can be combined easily because the service contracts and access protocols are consistent, and each service contract does not have to be understood differently.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("A service contract is easily discoverable and understandable")]),e._v(" "),a("li",[e._v("Service contracts and protocols are consistent on all aspects that they can be - e.g. identification and authentication mechanisms, error semantics, common type usage, pagination, etc.")]),e._v(" "),a("li",[e._v("A service has clear ownership, so that consumer providers can reach service owners regarding SLAs, requirements, issues")]),e._v(" "),a("li",[e._v("A consumer provider can easily integrate, test, and deploy a consumer that uses this service")]),e._v(" "),a("li",[e._v("A consumer provider can easily monitor the non-functional aspects of a service")])]),e._v(" "),a("h2",{attrs:{id:"externalizable"}}),e._v("Externalizable"),e._v(" "),a("p",[a("strong",[e._v("Service must be designed so that the functionality it provides is easily externalizable.")])]),e._v(" "),a("p",[e._v("A service is developed for use by consumers that may be from another domain or team, another business unit or another company. In all of these cases, the functionality exposed is the same; what changes is the access mechanism or the policies enforced by a service, like authentication, authorization and rate-limiting. Since the functionality exposed is the same, the service should be designed once and then externalized based on business needs through appropriate policies.")]),e._v(" "),a("p",[e._v("This principle implies the following:")]),e._v(" "),a("ul",[a("li",[e._v("The service interface must be derived from the domain model and the intended use-cases it is meant to support")]),e._v(" "),a("li",[e._v("The service contract and access (binding) protocols supported must meet the consumer's needs")]),e._v(" "),a("li",[e._v("The externalization of a service must not require reimplementation, or a change in service contract\n")])]),e._v(" "),a("h1",{attrs:{id:"http-methods-headers-status"}},[e._v("HTTP Methods, Headers, and Statuses")]),e._v(" "),a("h2",{attrs:{id:"data-resources"}},[e._v("Data Resources And HTTP Methods")]),e._v(" "),a("h3",{attrs:{id:"business-capabilities"}},[e._v("Business Capabilities and Resource Modeling")]),e._v(" "),a("p",[e._v("Various business "),a("a",{attrs:{href:"#capability"}},[e._v("capabilities")]),e._v(" of an organization are exposed through APIs as a set of "),a("a",{attrs:{href:"#resource"}},[e._v("resources")]),e._v(". Functionality MUST not be duplicated across APIs; rather resources (e.g., user account, credit card, etc.) are expected to be re-used as needed across use-cases.")]),e._v(" "),a("h3",{attrs:{id:"http-methods"}},[e._v("HTTP Methods")]),e._v(" "),a("p",[e._v("Most services will fall easily into the standard data resource model where primary operations can be represented by the acronym CRUD (Create, Read, Update, and Delete). These map very well to standard HTTP verbs.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("HTTP Method")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("GET")])]),e._v(" "),a("td",[e._v("To "),a("em",[e._v("retrieve")]),e._v(" a resource.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("POST")])]),e._v(" "),a("td",[e._v("To "),a("em",[e._v("create")]),e._v(" a resource, or to "),a("em",[e._v("execute")]),e._v(" a complex operation on a resource.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("PUT")])]),e._v(" "),a("td",[e._v("To "),a("em",[e._v("update")]),e._v(" a resource.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("DELETE")])]),e._v(" "),a("td",[e._v("To "),a("em",[e._v("delete")]),e._v(" a resource.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("PATCH")])]),e._v(" "),a("td",[e._v("To perform a "),a("em",[e._v("partial update")]),e._v(" to a resource.")])])])]),e._v(" "),a("p",[e._v("The actual operation invoked MUST match the HTTP method semantics as defined in the table above.")]),e._v(" "),a("ul",[a("li",[e._v("The "),a("strong",[a("code",[e._v("GET")])]),e._v(" method MUST NOT have side effects. It MUST NOT change the state of an underlying resource.")]),e._v(" "),a("li",[a("strong",[a("code",[e._v("POST")])]),e._v(": method SHOULD be used to create a new resource in a collection.\n"),a("ul",[a("li",[a("strong",[e._v("Example:")]),e._v(" To add a credit card on file, "),a("code",[e._v("POST https://api.foo.com/v1/vault/credit-cards")])]),e._v(" "),a("li",[e._v("Idempotency semantics: If this is a subsequent execution of the same invocation (including the "),a("a",{attrs:{href:"#http-custom-headers"}},[a("code",[e._v("Foo-Request-Id")])]),e._v(" header) and the resource was already created, then the request SHOULD be idempotent.")])])]),e._v(" "),a("li",[e._v("The "),a("strong",[a("code",[e._v("POST")])]),e._v(" method SHOULD be used to create a new sub-resource and establish its relationship with the main resource.\n"),a("ul",[a("li",[a("strong",[e._v("Example:")]),e._v(" To refund a payment with transaction ID 12345: "),a("code",[e._v("POST https://api.foo.com/v1/payments/payments/12345/refund")])])])]),e._v(" "),a("li",[e._v("The "),a("strong",[a("code",[e._v("POST")])]),e._v(" method MAY be used in complex operations, along with the name of the operation. This is also known as the "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#controller-resource"}},[a("em",[e._v("controller pattern")])]),e._v(" and is considered an exception to the RESTful model. It is more applicable in cases when resources represent a business process, and operations are the steps or actions to be performed as part of it. For more information, please refer to "),a("a",{attrs:{href:"http://techbus.safaribooksonline.com/9780596809140/chapter-identifying-resources",target:"_blank",rel:"noopener noreferrer"}},[e._v("section 2.6"),a("OutboundLink")],1),e._v(" of the "),a("a",{attrs:{href:"http://techbus.safaribooksonline.com/book/web-development/web-services/9780596809140",title:"RESTful Web Services Cookbook",target:"_blank",rel:"noopener noreferrer"}},[e._v("RESTful Web Services Cookbook"),a("OutboundLink")],1),e._v(".")],1),e._v(" "),a("li",[e._v("The "),a("strong",[a("code",[e._v("PUT")])]),e._v(" method SHOULD be used to update resource attributes or to establish a relationship from a resource to an existing sub-resource; it updates the main resource with a reference to the sub-resource.")])]),e._v(" "),a("h2",{attrs:{id:"processing"}},[e._v("Processing")]),e._v(" "),a("p",[e._v("It is assumed throughout these guidelines that\nrequest bodies and response bodies MUST be sent using "),a("a",{attrs:{href:"http://json.org/",title:"JSON",target:"_blank",rel:"noopener noreferrer"}},[e._v("JavaScript Object Notation (JSON)"),a("OutboundLink")],1),e._v(". JSON is a light-weight data representation for an object composed of unordered key-value pairs. JSON can represent four primitive types (strings, numbers, booleans, and null) and two structured types (objects and arrays). When processing an API method call, the following guidelines SHOULD be followed.")]),e._v(" "),a("h3",{attrs:{id:"data-model"}},[e._v("Data Model")]),e._v(" "),a("p",[e._v("The data model for representation MUST conform to the JSON Data Interchange Format as described in "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7159",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 7159"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"serialization"}},[e._v("Serialization")]),e._v(" "),a("ul",[a("li",[e._v("Resource endpoints MUST support "),a("code",[e._v("application/json")]),e._v(" as content type.")]),e._v(" "),a("li",[e._v("If an "),a("code",[e._v("Accept")]),e._v(" header is sent and "),a("code",[e._v("application/json")]),e._v(" is not an acceptable response, a "),a("code",[e._v("406 Not Acceptable")]),e._v(" error MUST be returned.")])]),e._v(" "),a("h3",{attrs:{id:"strictness"}},[e._v("Input and Output Strictness")]),e._v(" "),a("p",[e._v("APIs MUST be strict in the information they produce, and they SHOULD be strict in what they consume as well.")]),e._v(" "),a("p",[e._v("Since we are dealing with programming interfaces, we need to avoid guessing the meaning of what is being sent to us as much as possible. Given that integration is typically a one-time task for a developer and we provide good documentation, we need to be strict with using the data that is being received. "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Robustness_principle",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postel's law"),a("OutboundLink")],1),e._v(" must be weighed against the many dangers of permissive parsing.")]),e._v(" "),a("h2",{attrs:{id:"http-headers"}},[e._v("HTTP Headers")]),e._v(" "),a("p",[e._v("The purpose of HTTP headers is to provide metadata information about the body or the sender of the message in a uniform, standardized, and isolated way. HTTP header names are NOT case sensitive.")]),e._v(" "),a("ul",[a("li",[e._v("HTTP headers SHOULD only be used for the purpose of handling cross-cutting concerns.")]),e._v(" "),a("li",[e._v("API implementations SHOULD NOT introduce or depend on headers.")]),e._v(" "),a("li",[e._v("Headers MUST NOT include API or domain specific values.")]),e._v(" "),a("li",[e._v("If available, HTTP standard headers MUST be used instead of creating a custom header.")])]),e._v(" "),a("h3",{attrs:{id:"assumptions"}},[e._v("Assumptions")]),e._v(" "),a("p",[a("strong",[e._v("Service Consumers and Service Providers:")])]),e._v(" "),a("ul",[a("li",[e._v("SHOULD NOT expect that a particular HTTP header is available. It is possible that an intermediary component in call chain can drop an HTTP header. This is the reason business logic SHOULD NOT be based on HTTP headers.")]),e._v(" "),a("li",[e._v("SHOULD NOT assume the value of a header has not been changed as part of HTTP message transmission.")])]),e._v(" "),a("p",[a("strong",[e._v("Infrastructure Component")]),e._v(" (Web-services framework, Client invocation library, Enterprise Service Bus (ESB), Load Balancers (LB), etc. involved in HTTP message delivery):")]),e._v(" "),a("ul",[a("li",[e._v("MAY return an error based on availability and validity of a particular header without transmitting the message forward. For example, an authentication or authorization error for a request based on client identity and credentials.")]),e._v(" "),a("li",[e._v("MAY add, remove, or change a value of an HTTP header.")])]),e._v(" "),a("h3",{attrs:{id:"http-standard-headers"}},[e._v("HTTP Standard Headers")]),e._v(" "),a("p",[e._v("These are headers defined or referenced from "),a("a",{attrs:{href:"http://tools.ietf.org/html/rfc7231#page-33",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTTP/1.1 specification (RFC 7231)"),a("OutboundLink")],1),e._v(". Their purpose, syntax, values, and semantics are well defined and understood by many infrastructure components.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("HTTP Header Name")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("Accept")])]),e._v(" "),a("td",[e._v("This request header specifies the media types that the API client is capable of handling in the response. Systems issuing the HTTP request SHOULD send this header. Systems handling the request SHOULD NOT assume it is available. It is assumed throughout these API guidelines that APIs support "),a("code",[e._v("application/json")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Accept-Charset")])]),e._v(" "),a("td",[e._v("This request header specifies what character sets the API client is capable of handling in the response."),a("ul",[a("li",[e._v("The value of "),a("code",[e._v("Accept-Charset")]),e._v(" SHOULD include "),a("code",[e._v("utf-8")]),e._v(".")])])])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Content-Language")])]),e._v(" "),a("td",[e._v("This request/response header is used to specify the language of the content. The default locale is "),a("code",[e._v("en-US")]),e._v(". API clients SHOULD identify the language of the data using Content-Language header. APIs MUST provide this header in the response. "),a("br"),a("br"),e._v("Example: "),a("pre",[e._v("Content-Language: en-US")])])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Content-Type")])]),e._v(" "),a("td",[e._v("This request/response header indicates the media type of the request or response body. "),a("br"),a("ul",[a("li",[e._v("API client MUST include with request if the request contains a body, e.g. it is a "),a("code",[e._v("POST")]),e._v(", "),a("code",[e._v("PUT")]),e._v(", or "),a("code",[e._v("PATCH")]),e._v(" request.")]),a("li",[e._v("API developer MUST include it with response if a response body is included (not used with "),a("code",[e._v("204")]),e._v(" responses).")]),a("li",[e._v("If the content is a text-based type, such as "),a("a",{attrs:{href:"http://json.org/",title:"JSON",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON"),a("OutboundLink")],1),e._v(", the "),a("code",[e._v("Content-Type")]),e._v(" MUST include a character-set parameter. The character-set MUST be UTF-8.")]),a("li",[e._v("The only supported media type for now is "),a("code",[e._v("application/json")]),e._v(".")])]),e._v("Example:"),a("pre",[e._v("(in HTTP request)    Accept: application/json"),a("br"),e._v("                     Accept-Charset: utf-8"),a("br"),e._v("(in HTTP response)   Content-Type: application/json; charset=utf-8")])])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Link")])]),e._v(" "),a("td",[e._v("According to "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc5988",target:"_blank",rel:"noopener noreferrer"}},[e._v("Web Linking RFC 5988"),a("OutboundLink")],1),e._v(", a link is a typed connection between two resources that are identified by Internationalised Resource Identifiers (IRIs). The "),a("code",[e._v("Link")]),e._v(" entity-header field provides a means for serializing one or more links in HTTP headers. "),a("br"),a("br"),e._v(" APIs SHOULD be built with a design assumption that neither an API, nor an API client's business logic should depend on information provided in the headers. Headers must only be used to carry cross-cutting concern information such as security, traceability, monitoring, etc. "),a("br"),a("br"),e._v("Therefore, usage of the "),a("code",[e._v("Link")]),e._v(" header is prohibited with response codes "),a("code",[e._v("201")]),e._v(" or "),a("code",[e._v("3xx")]),e._v(". Consider using "),a("a",{attrs:{href:"#hypermedia"}},[e._v("HATEOAS links")]),e._v(" in the response body instead.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Location")])]),e._v(" "),a("td",[e._v("This response-header field is used to redirect the recipient to a location other than the Request-URI for completion of the request or identification of a new resource. "),a("br"),a("br"),e._v("APIs SHOULD be built with a design assumption that neither an API, nor an API client's business logic should depend on information provided in the headers. Headers must only be used to carry cross-cutting concern information such as security, traceability, monitoring, etc. "),a("br"),a("br"),e._v("Therefore, usage of the "),a("code",[e._v("Location")]),e._v(" header is prohibited with response codes "),a("code",[e._v("201")]),e._v(" or "),a("code",[e._v("3xx")]),e._v(". Consider using "),a("a",{attrs:{href:"#hypermedia"}},[e._v("HATEOAS links")]),e._v(" in response body instead.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("Prefer")])]),e._v(" "),a("td",[e._v("The "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7240",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("Prefer")]),a("OutboundLink")],1),e._v(" request header field is used to indicate that a particular server behavior(s) is "),a("code",[e._v("preferred")]),e._v(" by the client but is not required for successful completion of the request. It is an "),a("code",[e._v("end to end")]),e._v(" field and MUST be forwarded by a proxy if the request is forwarded unless "),a("code",[e._v("Prefer")]),e._v(" is explicitly identified as being "),a("code",[e._v("hop by hop")]),e._v(" using the "),a("code",[e._v("Connection")]),e._v(" header field. Following token values are possible to use for APIs provided an API documentation explicitly indicates support for "),a("code",[e._v("Prefer")]),e._v("."),a("br"),a("br"),a("code",[e._v("respond-async")]),e._v(": API client prefers that API server processes its request asynchronously. "),a("pre",[e._v("Prefer: respond-async ")]),e._v(" Server returns a "),a("code",[e._v("202 (Accepted)")]),e._v(" response and processes the request asynchronously. API server could use a webhook to inform the client subsequently, or the client may call "),a("code",[e._v("GET")]),e._v(" to get the response at a later time. Refer to "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#asynchronous-operations"}},[e._v("Asynchronous Operations")]),e._v(" for more details."),a("br"),a("br"),a("code",[e._v("read-consistent")]),e._v(": API client prefers that API server returns response from a durable store with consistent data. For APIs that are not offering any optimization preferences for their clients, this behavior would be the default and it would not require the client to set this token. "),a("pre",[e._v("Prefer: read-consistent")]),a("code",[e._v("read-eventual-consistent")]),e._v(": API client prefers that API server returns response from either cache or presumably eventually consistent datastore if applicable. If there is a miss in finding the data from either of these two types of sources, the API server might return response from a consistent, durable datastore."),a("pre",[e._v("Prefer: read-eventual-consistent")]),a("code",[e._v("read-cache")]),e._v(": API client prefers that API server returns response from cache if available. If the cache hit is a miss, the server could return response from other sources such as eventual consistent datastore or a consistent, durable datastore."),a("pre",[e._v("Prefer: read-cache")]),a("code",[e._v("return=representation")]),e._v(": API client prefers that API server include an entity representing the current state of the resource in the response to a successful request. This preference is intended to provide a means of optimizing communication between the client and server by eliminating the need for a subsequent "),a("code",[e._v("GET")]),e._v(" request to retrieve the current representation of the resource following a creation ("),a("code",[e._v("POST")]),e._v(") modification operation ("),a("code",[e._v("PUT")]),e._v(" or "),a("code",[e._v("PATCH")]),e._v(")."),a("pre",[e._v("Prefer: return=representation")]),a("code",[e._v("return=minimal")]),e._v(': API client indicates that the server returns only a minimal response to a successful request. The determination of what constitutes an appropriate "minimal" response is solely at the discretion of the server.'),a("pre",[e._v("Prefer: return=minimal")])],1)])])]),e._v(" "),a("h3",{attrs:{id:"http-custom-headers"}},[e._v("HTTP Custom Headers")]),e._v(" "),a("p",[e._v("Following are some custom headers used in these guidelines. These are not part of the HTTP specifications.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[e._v("HTTP Header Name")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[e._v("Foo-Request-Id")])]),e._v(" "),a("td",[e._v("API consumers MAY choose to send this header with a unique ID identifying the request header for tracking purpose. "),a("br"),a("br"),e._v("Such a header can be used internally for logging and tracking purpose too. It is RECOMMENDED to send this header back as a response header if response is synchronous or as request header of a webhook as applicable.")])])])]),e._v(" "),a("h3",{attrs:{id:"http-header-propagation"}},[e._v("HTTP Header Propagation")]),e._v(" "),a("p",[e._v("When services receive request headers, they MUST pass on relevant custom headers in addition to the HTTP standard headers in requests/messages dispatched to downstream applications.")]),e._v(" "),a("h2",{attrs:{id:"http-status-codes"}},[e._v("HTTP Status Codes")]),e._v(" "),a("p",[e._v("RESTful services use HTTP status codes to specify the outcomes of HTTP method execution. HTTP protocol specifies the outcome of a request execution using an integer and a message. The number is known as the "),a("em",[e._v("status code")]),e._v(" and the message as the "),a("em",[e._v("reason phrase")]),e._v(". The reason phrase is a human readable message used to clarify the outcome of the response. HTTP protocol categorizes status codes in ranges.")]),e._v(" "),a("h3",{attrs:{id:"status-code-ranges"}},[e._v("Status Code Ranges")]),e._v(" "),a("p",[e._v("When responding to API requests, the following status code ranges MUST be used.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Range")]),e._v(" "),a("th",[e._v("Meaning")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("2xx")])]),e._v(" "),a("td",[e._v("Successful execution. It is possible for a method execution to succeed in several ways. This status code specifies which way it succeeded.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("4xx")])]),e._v(" "),a("td",[e._v("Usually these are problems with the request, the data in the request, invalid authentication or authorization, etc. In most cases the client can modify their request and resubmit.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("5xx")])]),e._v(" "),a("td",[e._v("Server error: The server was not able to execute the method due to site outage or software defect. 5xx range status codes SHOULD NOT be utilized for validation or logical error handling.")])])])]),e._v(" "),a("h3",{attrs:{id:"status-reporting"}},[e._v("Status Reporting")]),e._v(" "),a("p",[e._v("Success and failure apply to the whole operation not just to the SOA framework portion or to the business logic portion of code exectuion.")]),e._v(" "),a("p",[e._v("Following are the guidelines for status codes and reason phrases.")]),e._v(" "),a("ul",[a("li",[e._v("Success MUST be reported with a status code in the "),a("code",[e._v("2xx")]),e._v(" range.")]),e._v(" "),a("li",[e._v("HTTP status codes in the "),a("code",[e._v("2xx")]),e._v(" range MUST be returned only if the complete code execution path is successful. This includes any container/SOA framework code as well as the business logic code execution of the method.")]),e._v(" "),a("li",[e._v("Failures MUST be reported in the "),a("code",[e._v("4xx")]),e._v(" or "),a("code",[e._v("5xx")]),e._v(" range. This is true for both system errors and application errors.")]),e._v(" "),a("li",[e._v("There MUST be a consistent, JSON-formatted error response in the body as defined by the "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json")])]),e._v(" schema. This schema is used to qualify the kind of error. Please refer to "),a("a",{attrs:{href:"#error-handling"}},[e._v("Error Handling")]),e._v(" guidelines for more details.")]),e._v(" "),a("li",[e._v("A server returning a status code in the "),a("code",[e._v("4xx")]),e._v(" or "),a("code",[e._v("5xx")]),e._v(" range MUST return the "),a("code",[e._v("error.json")]),e._v(" response body.")]),e._v(" "),a("li",[e._v("A server returning a status code in the "),a("code",[e._v("2xx")]),e._v(" range MUST NOT return response following "),a("code",[e._v("error.json")]),e._v(", or any kind of error code, as part of the response body.")]),e._v(" "),a("li",[e._v("For client errors in the "),a("code",[e._v("4xx")]),e._v(" code range, the reason phrase SHOULD provide enough information for the client to be able to determine what caused the error and how to fix it.")]),e._v(" "),a("li",[e._v("For server errors in the "),a("code",[e._v("5xx")]),e._v(" code range, the reason phrase and an error response following "),a("code",[e._v("error.json")]),e._v(" SHOULD limit the amount of information to avoid exposing internal service implementation details to clients. This is true for both external facing and internal APIs. Service developers should use logging and tracking utilities to provide additional information.")])]),e._v(" "),a("h3",{attrs:{id:"allowed-status-codes"}},[e._v("Allowed Status Codes List")]),e._v(" "),a("p",[e._v("All REST APIs MUST use only the following status codes. Status codes in "),a("strong",[a("code",[e._v("BOLD")])]),e._v(" SHOULD be used by API developers. The rest are primarily intended for web-services framework developers reporting framework-level errors related to security, content negotiation, etc.")]),e._v(" "),a("ul",[a("li",[e._v("APIs MUST NOT return a status code that is not defined in this table.")]),e._v(" "),a("li",[e._v("APIs MAY return only some of status codes defined in this table.")])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Status Code")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[a("code",[e._v("200 OK")])])]),e._v(" "),a("td",[e._v("Generic successful execution.")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("201 Created")])])]),e._v(" "),a("td",[e._v("Used as a response to "),a("code",[e._v("POST")]),e._v(" method execution to indicate successful creation of a resource. If the resource was already created (by a previous execution of the same method, for example), then the server should return status code "),a("code",[e._v("200 OK")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("202 Accepted")])])]),e._v(" "),a("td",[e._v("Used for asynchronous method execution to specify the server has accepted the request and will execute it at a later time. For more details, please refer "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#asynchronous-operations"}},[e._v("Asynchronous Operations")]),e._v(".")],1)]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("204 No Content")])])]),e._v(" "),a("td",[e._v("The server has successfully executed the method, but there is no entity body to return.")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("400 Bad Request")])])]),e._v(" "),a("td",[e._v("The request could not be understood by the server. Use this status code to specify:"),a("br"),e._v(" "),a("ul",[a("li",[e._v("The data as part of the payload cannot be converted to the underlying data type.")]),a("li",[e._v("The data is not in the expected data format.")]),a("li",[e._v("Required field is not available.")]),a("li",[e._v("Simple data validation type of error.")])])])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("401 Unauthorized")])]),e._v(" "),a("td",[e._v("The request requires authentication and none was provided. Note the difference between this and "),a("code",[e._v("403 Forbidden")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("403 Forbidden")])])]),e._v(" "),a("td",[e._v("The client is not authorized to access the resource, although it may have valid credentials. API could use this code in case business level authorization fails. For example, accound holder does not have enough funds.")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("404 Not Found")])])]),e._v(" "),a("td",[e._v("The server has not found anything matching the request URI. This either means that the URI is incorrect or the resource is not available. For example, it may be that no data exists in the database at that key.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("405 Method Not Allowed")])]),e._v(" "),a("td",[e._v("The server has not implemented the requested HTTP method. This is typically default behavior for API frameworks.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("406 Not Acceptable")])]),e._v(" "),a("td",[e._v("The server MUST return this status code when it cannot return the payload of the response using the media type requested by the client. For example, if the client sends an "),a("code",[e._v("Accept: application/xml")]),e._v(" header, and the API can only generate "),a("code",[e._v("application/json")]),e._v(", the server MUST return "),a("code",[e._v("406")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("415 Unsupported Media Type")])]),e._v(" "),a("td",[e._v("The server MUST return this status code when the media type of the request's payload cannot be processed. For example, if the client sends a "),a("code",[e._v("Content-Type: application/xml")]),e._v(" header, but the API can only accept "),a("code",[e._v("application/json")]),e._v(", the server MUST return "),a("code",[e._v("415")]),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("422 Unprocessable Entity")])])]),e._v(" "),a("td",[e._v("The requested action cannot be performed and may require interaction with APIs or processes outside of the current request. This is distinct from a 500 response in that there are no systemic problems limiting the API from performing the request.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("429 Too Many Requests")])]),e._v(" "),a("td",[e._v("The server must return this status code if the rate limit for the user, the application, or the token has exceeded a predefined value. Defined in Additional HTTP Status Codes "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6585",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 6585"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("tr",[a("td",[a("strong",[a("code",[e._v("500 Internal Server Error")])])]),e._v(" "),a("td",[e._v("This is either a system or application error, and generally indicates that although the client appeared to provide a correct request, something unexpected has gone wrong on the server. A "),a("code",[e._v("500")]),e._v(" response indicates a server-side software defect or site outage. "),a("code",[e._v("500")]),e._v(" SHOULD NOT be utilized for client validation or logic error handling.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("503 Service Unavailable")])]),e._v(" "),a("td",[e._v("The server is unable to handle the request for a service due to temporary maintenance.")])])])]),e._v(" "),a("h3",{attrs:{id:"mapping"}},[e._v("HTTP Method to Status Code Mapping")]),e._v(" "),a("p",[e._v('For each HTTP method, API developers SHOULD use only status codes marked as "X"  in this table. If an API needs to return any of the status codes marked with an '),a("strong",[a("code",[e._v("X")])]),e._v(", then the use case SHOULD be reviewed as part of API design review process and maturity level assessment. Most of these status codes are used to support very rare use cases.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Status Code")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("200 Success")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("201 Created")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("202 Accepted")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("204 No Content")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("400 Bad Request")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("404 Not Found")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("422 Unprocessable Entity")]),e._v(" "),a("th",{staticStyle:{"text-align":"left"}},[e._v("500 Internal Server Error")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("GET")])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("POST")])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("PUT")])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("PATCH")])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("DELETE")])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}}),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("strong",[a("code",[e._v("X")])])]),e._v(" "),a("td",{staticStyle:{"text-align":"left"}},[e._v("X")])])])]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("GET")]),e._v(": The purpose of the "),a("code",[e._v("GET")]),e._v(" method is to retrieve a resource. On success, a status code "),a("code",[e._v("200")]),e._v(" and a response with the content of the resource is expected. In cases where resource collections are empty (0 items in "),a("code",[e._v("/v1/namespace/resources")]),e._v("), "),a("code",[e._v("200")]),e._v(" is the appropriate status (resource will contain an empty "),a("code",[e._v("items")]),e._v(" array). If a resource item is 'soft deleted' in the underlying data, "),a("code",[e._v("200")]),e._v(" is not appropriate ("),a("code",[e._v("404")]),e._v(" is correct) unless the 'DELETED' status is intended to be exposed.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("POST")]),e._v(": The primary purpose of "),a("code",[e._v("POST")]),e._v(" is to create a resource. If the resource did not exist and was created as part of the execution, then a status code "),a("code",[e._v("201")]),e._v(" SHOULD be returned.")]),e._v(" "),a("ul",[a("li",[e._v("It is expected that on a successful execution, a reference to the resource created (in the form of a link or resource identifier) is returned in the response body.")]),e._v(" "),a("li",[e._v("Idempotency semantics: If this is a subsequent execution of the same invocation (including the "),a("a",{attrs:{href:"#http-custom-headers"}},[a("code",[e._v("Foo-Request-Id")])]),e._v(" header) and the resource was already created, then a status code of "),a("code",[e._v("200")]),e._v(" SHOULD be returned. For more details on idempotency in APIs, refer to "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#idempotency"}},[e._v("idempotency")]),e._v(".")],1),e._v(" "),a("li",[e._v("If a sub-resource is utilized ('controller' or data resource), and the primary resource identifier is non-existent, "),a("code",[e._v("404")]),e._v(" is an appropriate response.")])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("POST")]),e._v(" can also be used while utilizing the "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html##controller-resource"}},[e._v("controller pattern")]),e._v(", "),a("code",[e._v("200")]),e._v(" is the appropriate status code.")],1)]),e._v(" "),a("li",[a("p",[a("code",[e._v("PUT")]),e._v(": This method SHOULD return status code "),a("code",[e._v("204")]),e._v(" as there is no need to return any content in most cases as the request is to update a resource and it was successfully updated. The information from the request should not be echoed back.")]),e._v(" "),a("ul",[a("li",[e._v("In rare cases, server generated values may need to be provided in the response, to optimize client flow (if the client necessarily has to perform a "),a("code",[e._v("GET")]),e._v(" after "),a("code",[e._v("PUT")]),e._v("). In these cases, "),a("code",[e._v("200")]),e._v(" and a response body are appropriate.")])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("PATCH")]),e._v(": This method should follow the same status/response semantics as "),a("code",[e._v("PUT")]),e._v(", "),a("code",[e._v("204")]),e._v(" status and no response body.")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("200")]),e._v(" + response body should be avoided at all costs, as "),a("code",[e._v("PATCH")]),e._v(" performs partial updates, meaning multiple calls per resource is normal. As such, responding with the entire resource can result in large bandwidth usage, especially for bandwidth-sensitive mobile clients.")])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("DELETE")]),e._v(": This method SHOULD return status code "),a("code",[e._v("204")]),e._v(" as there is no need to return any content in most cases as the request is to delete a resource and it was successfully deleted.")]),e._v(" "),a("ul",[a("li",[e._v("As the "),a("code",[e._v("DELETE")]),e._v(" method MUST be idempotent as well, it SHOULD still return "),a("code",[e._v("204")]),e._v(", even if the resource was already deleted. Usually the API consumer does not care if the resource was deleted as part of this operation, or before. This is also the reason why "),a("code",[e._v("204")]),e._v(" instead of "),a("code",[e._v("404")]),e._v(" should be returned.")])])])]),e._v(" "),a("h1",{attrs:{id:"hypermedia"}},[e._v("Hypermedia")]),e._v(" "),a("h2",{attrs:{id:"hateoas"}},[e._v("HATEOAS")]),e._v(" "),a("p",[e._v("Hypermedia, an extension of the term "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Hypertext",target:"_blank",rel:"noopener noreferrer"}},[e._v("hypertext"),a("OutboundLink")],1),e._v(", is a nonlinear medium of information which includes graphics, audio, video, plain text and hyperlinks according to "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Hypermedia",target:"_blank",rel:"noopener noreferrer"}},[e._v("wikipedia"),a("OutboundLink")],1),e._v(". Hypermedia As The Engine Of Application State ("),a("code",[e._v("HATEOAS")]),e._v(") is a constraint of the REST application architecture described by Roy Fielding in his "),a("a",{attrs:{href:"https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm",title:"RESTful Architectural Style",target:"_blank",rel:"noopener noreferrer"}},[e._v("dissertation"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("In the context of RESTful APIs, a client could interact with a service entirely through hypermedia provided dynamically by the service. A hypermedia-driven service provides representation of resource(s) to its clients to navigate the API dynamically by including hypermedia links in the responses. This is different than other form of SOA, where servers and clients interact based on WSDL-based specification defined somewhere on the web or exchanged off-band.")]),e._v(" "),a("h2",{attrs:{id:"hateoas-api"}},[e._v("Hypermedia Compliant API")]),e._v(" "),a("p",[e._v("A hypermedia compliant API exposes a finite state machine of a service. Here, requests such as "),a("code",[e._v("DELETE")]),e._v(", "),a("code",[e._v("PATCH")]),e._v(", "),a("code",[e._v("POST")]),e._v(" and "),a("code",[e._v("PUT")]),e._v(" typically initiate a transition in state while responses indicate the change in the state. Lets take an example of an API that exposes a set of operations to manage a user account lifecycle and implements the HATEOAS interface constraint.")]),e._v(" "),a("p",[e._v("A client starts interaction with a service through a fixed URI "),a("code",[e._v("/users")]),e._v(". This fixed URI supports both "),a("code",[e._v("GET")]),e._v(" and "),a("code",[e._v("POST")]),e._v(" operations. The client decides to do a "),a("code",[e._v("POST")]),e._v(" operation to create a user in the system.")]),e._v(" "),a("p",[a("strong",[e._v("Request")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\nPOST https://api.foo.com/v1/customer/users\n\n{\n    "given_name": "James",\n    "surname" : "Greenwood",\n    ...\n\n}\n\n')])])]),a("p",[a("strong",[e._v("Response")]),e._v(":")]),e._v(" "),a("p",[e._v("The API creates a new user from the input and returns the following links to the client in the response.")]),e._v(" "),a("ul",[a("li",[e._v("A link to retrieve the complete representation of the user (aka "),a("code",[e._v("self")]),e._v(" link) ("),a("code",[e._v("GET")]),e._v(").")]),e._v(" "),a("li",[e._v("A link to update the user ("),a("code",[e._v("PUT")]),e._v(").")]),e._v(" "),a("li",[e._v("A link to partially update the user ("),a("code",[e._v("PATCH")]),e._v(").")]),e._v(" "),a("li",[e._v("A link to delete the user ("),a("code",[e._v("DELETE")]),e._v(").")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\n{\nHTTP/1.1 201 CREATED\nContent-Type: application/json\n...\n\n"links": [\n    {\n        "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n        "rel": "self",\n        \n    },\n    {\n        "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n        "rel": "delete",\n        "method": "DELETE"\n    },\n    {\n        "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n        "rel": "replace",\n        "method": "PUT"\n    },\n    {\n        "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n        "rel": "edit",\n        "method": "PATCH"\n    }\n]\n\n}\n')])])]),a("p",[e._v("A client can store these links in its database for later use.")]),e._v(" "),a("p",[e._v("A client may then want to display a set of users and their details before the admin decides to delete one of the users. So the client does a "),a("code",[e._v("GET")]),e._v(" to the same fixed URI "),a("code",[e._v("/users")]),e._v(".")]),e._v(" "),a("p",[a("strong",[e._v("Request")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GET https://api.foo.com/v1/customer/users\n\n")])])]),a("p",[e._v("The API returns all the users in the system with respective "),a("code",[e._v("self")]),e._v(" links.")]),e._v(" "),a("p",[a("strong",[e._v("Response")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\n{\n    "total_items": "166",\n    "total_pages": "83",\n    "users": [\n    {\n        "given_name": "James",\n        "surname": "Greenwood",\n        ...\n        "links": [\n            {\n                "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n                "rel": "self"\n            }\n        ]\n    },\n    {\n        "given_name": "David",\n        "surname": "Brown",\n        ...\n        "links": [\n            {\n                "href": "https://api.foo.com/v1/customer/users/ALT-MDFSKFGIFJ86DSF",\n                "rel": "self"\n            }\n   },\n   ...\n}\n\n')])])]),a("p",[e._v("The client MAY follow the "),a("code",[e._v("self")]),e._v(" link of the user and figure out all the possible operations that it can perform on the user resource.")]),e._v(" "),a("p",[a("strong",[e._v("Request")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GET https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI\n")])])]),a("p",[a("strong",[e._v("Response")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('HTTP/1.1 200 OK\nContent-Type: application/json\n{\n        "given_name": "James",\n        "surname": "Greenwood",\n        ...\n        "links": [\n        {\n            "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n            "rel": "self",\n        \n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n            "rel": "delete",\n            "method": "DELETE"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n            "rel": "replace",\n            "method": "PUT"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n            "rel": "edit",\n            "method": "PATCH"\n        }\n\n\n}\n')])])]),a("p",[e._v("To delete the user, the client retrieves the URI of the link relation type "),a("code",[e._v("delete")]),e._v(" from its data store and performs a delete operation on the URI.")]),e._v(" "),a("p",[a("strong",[e._v("Request")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("DELETE https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI\n")])])]),a("p",[e._v("In summary:")]),e._v(" "),a("ul",[a("li",[e._v("There is a well defined entry point for an API which a client navigates to in order to access all other resources.")]),e._v(" "),a("li",[e._v("The client does not need to build the logic of composing URIs to execute different requests or code any kind of business rule by looking into the response details (more in detail is described in the later sections) that may be associated with the URIs and state changes.")]),e._v(" "),a("li",[e._v("The client acknowledges the fact that the process of creating URIs belongs to the server.")]),e._v(" "),a("li",[e._v("Client treats URIs as opaque identifiers.")]),e._v(" "),a("li",[e._v("APIs using hypermedia in representations could be extended seamlessly. As new methods are introduced, responses could be extended with relevant HATEOAS links. In this way, clients could take advantage of the functionality in incremental fashion. For example, if the API starts supporting a new "),a("code",[e._v("PATCH")]),e._v(" operation then clients could use it to do partial updates.")])]),e._v(" "),a("p",[e._v("The mere presence of links does not decouple a client from having to learn the data required to make requests for a transition and all associated link semantics, particularly for "),a("code",[e._v("POST")]),e._v("/"),a("code",[e._v("PUT")]),e._v("/"),a("code",[e._v("PATCH")]),e._v(" operations. An API MUST provide documentation to clearly describe all the links, link relation types and request response formats for each of the URIs.")]),e._v(" "),a("p",[e._v("Subsequent sections provide more details about the structure of a link and what different relationship types mean.")]),e._v(" "),a("h2",{attrs:{id:"link-description-object"}},[e._v("Link Description Object")]),e._v(" "),a("p",[e._v("Links MUST be described using the "),a("em",[e._v("[Link Description Object (LDO)] "),a("a",{attrs:{href:"http://json-schema.org/latest/json-schema-hypermedia.html#anchor17",title:"Link Description Objects (LDO)",target:"_blank",rel:"noopener noreferrer"}},[e._v("4"),a("OutboundLink")],1)]),e._v(" schema. An LDO describes a single link relation in the links array. Following is brief description for properties of Link Description Object.")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("href")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("A value for the "),a("code",[e._v("href")]),e._v(" property MUST be provided.")])]),e._v(" "),a("li",[a("p",[e._v("The value of the "),a("code",[e._v("href")]),e._v(" property MUST be a "),a("em",[e._v("[URI template] "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6570",title:"URI template",target:"_blank",rel:"noopener noreferrer"}},[e._v("6"),a("OutboundLink")],1)]),e._v(" used to determine the target URI of the related resource. It SHOULD be resolved as a URI template per "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6570",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 6570"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("Use ONLY absolute URIs as a value for "),a("code",[e._v("href")]),e._v(" property. Clients usually bookmark the absolute URI of a link relation type from the representation to make API requests later. Developers MUST use the "),a("em",[a("a",{attrs:{href:"#uri-component-names"}},[e._v("URI Component Naming Conventions")])]),e._v(" to construct absolute URIs. The value from the incoming "),a("code",[e._v("Host")]),e._v(" header (e.g. api.foo.com) MUST be used as the "),a("code",[e._v("host")]),e._v(" field of the absolute URI.")])])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("rel")]),e._v(":")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("rel")]),e._v(" stands for relation as defined in Link Relation Type")])]),e._v(" "),a("li",[a("p",[e._v("The value of the "),a("code",[e._v("rel")]),e._v(" property indicates the name of the relation to the target resource.")])]),e._v(" "),a("li",[a("p",[e._v("A value for the "),a("code",[e._v("rel")]),e._v(" property MUST be provided.")])])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("method")]),e._v(":")]),e._v(" "),a("ul",[a("li",[e._v("The "),a("code",[e._v("method")]),e._v(" property identifies the HTTP verb that MUST be used to make a request to the target of the link. The "),a("code",[e._v("method")]),e._v(" property assumes a default value of "),a("code",[e._v("GET")]),e._v(" if it is ommitted.")])])]),e._v(" "),a("li",[a("p",[a("code",[e._v("title")]),e._v(":")]),e._v(" "),a("ul",[a("li",[e._v("The "),a("code",[e._v("title")]),e._v(" property provides a title for the link and is a helpful documentation tool to facilitate understanding by the end clients. This property is NOT REQUIRED.")])])])]),e._v(" "),a("h4",{attrs:{id:"not-using-http-headers-for-ldo"}},[e._v("Not Using HTTP Headers For LDO")]),e._v(" "),a("p",[e._v("Note that these API guidelines do not recommend using the HTTP "),a("code",[e._v("Location")]),e._v(" header to provide a link. Also, they do not recommend using the "),a("code",[e._v("Link")]),e._v(" header as described in "),a("a",{attrs:{href:"https://java.net/projects/jax-rs-spec/pages/Hypermedia",target:"_blank",rel:"noopener noreferrer"}},[e._v("JAX-RS"),a("OutboundLink")],1),e._v(". The scope of HTTP header is limited to point-to-point interaction between a client and a service. Since responses might be passed around to other layers and components on the client side which may not directly interact with the service, any information that is stored in a header may not be available. Therefore, we recommend returning Link Description Object(s) in HTTP response body.")]),e._v(" "),a("h2",{attrs:{id:"links-array"}},[e._v("Links Array")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("links")]),e._v(" array property of schemas is used to associate a Link Description Objects with a "),a("em",[e._v("[JSON hyper-schema draft-04] "),a("a",{attrs:{href:"http://json-schema.org/draft-04/hyper-schema#",title:"JSON hyper-schema draft-04",target:"_blank",rel:"noopener noreferrer"}},[e._v("3"),a("OutboundLink")],1)]),e._v(" instance.")]),e._v(" "),a("ul",[a("li",[e._v("This property MUST be an array.")]),e._v(" "),a("li",[e._v("Items in the array must be of type Link Description Object.")])]),e._v(" "),a("h4",{attrs:{id:"specifying-links-array"}},[e._v("Specifying the Links array")]),e._v(" "),a("p",[e._v("Here's an example of how you would describe links in the schema.")]),e._v(" "),a("ul",[a("li",[e._v("A links array similar to the one defined in the sample JSON schema below MUST be provided as part of the API resource schema definition. Please note that the links array needs to be declared within the "),a("code",[e._v("properties")]),e._v(" keyword of an object. This is required for code generators to add setter/getter methods for the links array in the generated object.")]),e._v(" "),a("li",[e._v("All possible links that an API returns as part of the response MUST be declared in the response schema using a URI template. The links array of URI templates MUST be declared outside the "),a("code",[e._v("properties")]),e._v(" keyword.")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "object",\n    "$schema": "http://json-schema.org/draft-04/hyper-schema#",\n    "description": "A sample resource representing a customer name.",\n    "properties": {\n        "id": {\n\t    "type": "string",\n            "description": "Unique ID to identify a customer."\n        },\n        "first_name": {\n            "type": "string",\n            "description": "Customer\'s first name."\n        },\n        "last_name": {\n            "type": "string",\n            "description": "Customer\'s last name."\n        },\n        "links": {\n            "type": "array",\n            "items": {\n                "$ref": "http://json-schema.org/draft-04/hyper-schema#definitions/linkDescription"\n            }\n        }\n    },\n    "links": [\n        {\n            "href": "https://api.foo.com/v1/customer/users/{id}",\n            "rel": "self"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/{id}",\n            "rel": "delete",\n            "method": "DELETE"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/{id}",\n            "rel": "replace",\n            "method": "PUT"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/{id}",\n            "rel": "edit",\n            "method": "PATCH"\n        }\n    ]\n\n}\n')])])]),a("p",[e._v("Below is an example response that is compliant with the above schema.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "id": "ALT-JFWXHGUV7VI",\n    "first_name": "John",\n    "last_name": "Doe",\n    "links": [\n        {\n            "href": "https://api.foo.com/v1/cusommer/users/ALT-JFWXHGUV7VI",\n            "rel": "self"\n        },\n        {\n            "href": "https://api.foo.com/v1/customer/users/ALT-JFWXHGUV7VI",\n            "rel": "edit",\n            "method": "PATCH"\n        }\n    ]\n}\n')])])]),a("h2",{attrs:{id:"link-relation-type"}},[e._v("Link Relation Type")]),e._v(" "),a("p",[e._v("A "),a("code",[e._v("Link Relation Type")]),e._v(" serves as an identifier for a link. An API MUST assign a meaningful link relation type that unambiguously describes the semantics of the link. Clients use the relevant Link Relation Type in order to identify the link to use from a representation.")]),e._v(" "),a("p",[e._v("When the semantics of a Link Relation Type defined in "),a("em",[e._v("[IANA's list of standardized link relations] "),a("a",{attrs:{href:"http://www.iana.org/assignments/link-relations/link-relations.xhtml",title:"IANA's list of standardized link relations",target:"_blank",rel:"noopener noreferrer"}},[e._v("5"),a("OutboundLink")],1)]),e._v(" matches with the one you want to define, then it MUST be used. The table below describes some of the commonly used link relation types. It also lists some additional lin relation types defined by these guidelines.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Link Relation Type")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("self")])]),e._v(" "),a("td",[e._v("Conveys an identifier for the link's context. Usually a link pointing to the resource itself.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("create")])]),e._v(" "),a("td",[e._v("Refers to a link that can be used to create a new resource.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("edit")])]),e._v(" "),a("td",[e._v("Refers to editing (or partially updating) the representation identified by the link. Use this to represent a "),a("code",[e._v("PATCH")]),e._v(" operation link.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("delete")])]),e._v(" "),a("td",[e._v("Refers to deleting a resource identified by the link. Use this "),a("code",[e._v("Extended link relation type")]),e._v(" to represent a "),a("code",[e._v("DELETE")]),e._v(" operation link.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("replace")])]),e._v(" "),a("td",[e._v("Refers to completely update (or replace) the representation identified by the link. Use this "),a("code",[e._v("Extended link relation type")]),e._v(" to represent a "),a("code",[e._v("PUT")]),e._v(" operation link.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("first")])]),e._v(" "),a("td",[e._v("Refers to the first page of the result list.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("last")])]),e._v(" "),a("td",[e._v("Refers to the last page of the result list provided "),a("code",[e._v("total_required")]),e._v(" is specified as a query parameter.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("next")])]),e._v(" "),a("td",[e._v("Refers to the next page of the result list.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("prev")])]),e._v(" "),a("td",[e._v("Refers to the previous page of the result list.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("collection")])]),e._v(" "),a("td",[e._v("Refers to a collections resource (e.g /v1/users).")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("latest-version")])]),e._v(" "),a("td",[e._v("Points to a resource containing the latest (e.g., current) version.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("search")])]),e._v(" "),a("td",[e._v("Refers to a resource that can be used to search through the link's context and related resources.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("up")])]),e._v(" "),a("td",[e._v("Refers to a parent resource in a hierarchy of resources.")])])])]),e._v(" "),a("p",[e._v("For all "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#controller-resource"}},[a("code",[e._v("controller")])]),e._v(" style complex operations, the controller "),a("code",[e._v("action")]),e._v(" name must be used as the link relation type (e.g. "),a("code",[e._v("activate")]),e._v(","),a("code",[e._v("cancel")]),e._v(","),a("code",[e._v("refund")]),e._v(").")],1),e._v(" "),a("h2",{attrs:{id:"use-cases"}},[e._v("Use Cases")]),e._v(" "),a("p",[e._v("See "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html#hateoas-use-cases"}},[e._v("HATEOAS Use Cases")]),e._v(" to find where HATEOAS could be used.")],1),e._v(" "),a("h1",{attrs:{id:"naming-conventions"}},[e._v("Naming Conventions")]),e._v(" "),a("p",[e._v("Naming conventions for URIs, query parameters, resources, fields and enums are described in this section. Let us emphasize here that these guidelines are less about following the conventions exactly as described here but they are more about defining some naming conventions and sticking to them in a consistent manner while designing APIs. For example, we have followed "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Snake_case",target:"_blank",rel:"noopener noreferrer"}},[e._v("snake_case"),a("OutboundLink")],1),e._v(" for field and file names, however, you could use other forms such as "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Camel_case",target:"_blank",rel:"noopener noreferrer"}},[e._v("CamelCase"),a("OutboundLink")],1),e._v(" or something else that you have devised yourself. It is important to adhere to a defined convention.")]),e._v(" "),a("h2",{attrs:{id:"uri-component-names"}},[e._v("URI Component Names")]),e._v(" "),a("p",[e._v("URIs follow "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc3986",title:"RFC 3968",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 3986"),a("OutboundLink")],1),e._v(" specification. This specification simplifies REST API service development and consumption. The guidelines in this section govern your URI structure and semantics following the RFC 3986 constraints.")]),e._v(" "),a("h3",{attrs:{id:"uri-components"}},[e._v("URI Components")]),e._v(" "),a("p",[e._v("According to RFC 3986, the generic URI syntax consists of a hierarchical sequence of components referred to as the scheme, authority, path, query, and fragment as shown in example below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("         https://example.com:8042/over/there?name=ferret#nose\n         \\___/   \\_______________/\\_________/\\_________/\\__/\n          |           |            |            |        |\n       scheme     authority       path        query   fragment\n")])])]),a("h3",{attrs:{id:"uri-naming-convention"}},[e._v("URI Naming Conventions")]),e._v(" "),a("p",[e._v('Following is a brief description of the URI specific naming convention guidelines for APIs. This specification uses parentheses "( )" to group, an asterisk " * " to specify zero or more occurrences, and brackets "[ ]" for optional fields.')]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[scheme\"://\"][host[':'port]]\"/v\" major-version '/'namespace '/'resource ('/'resource)* '?' query\n\n")])])]),a("ul",[a("li",[e._v("URIs MUST start with a letter and use only lower-case letters.")]),e._v(" "),a("li",[e._v("Literals/expressions in URI paths SHOULD be separated using a hyphen ( - ).")]),e._v(" "),a("li",[e._v("Literals/expressions in query strings SHOULD be separated using underscore ( _ ).")]),e._v(" "),a("li",[e._v("URI paths and query strings MUST percent encode data into "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Percent-encoding",target:"_blank",rel:"noopener noreferrer"}},[e._v("UTF-8 octets"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[e._v("Plural nouns SHOULD be used in the URI where appropriate to identify collections of data resources.\n"),a("ul",[a("li",[a("code",[e._v("/invoices")])]),e._v(" "),a("li",[a("code",[e._v("/statements")])])])]),e._v(" "),a("li",[e._v("An individual resource in a collection of resources MAY exist directly beneath the collection URI.\n"),a("ul",[a("li",[a("code",[e._v("/invoices/{invoice_id}")])])])]),e._v(" "),a("li",[e._v("Sub-resource collections MAY exist directly beneath an individual resource. This should convey a relationship to another collection of resources (invoice-items, in this example).\n"),a("ul",[a("li",[a("code",[e._v("/invoices/{invoice_id}/items")])])])]),e._v(" "),a("li",[e._v("Sub-resource individual resources MAY exist, but should be avoided in favor of top-level resources.\n"),a("ul",[a("li",[a("code",[e._v("/invoices/{invoice_id}/items/{item_id}")])]),e._v(" "),a("li",[e._v("Better: "),a("code",[e._v("/invoice-items/{invoice_item_id}")])])])]),e._v(" "),a("li",[e._v("Resource identifiers SHOULD follow "),a("a",{attrs:{href:"#resource-identifiers"}},[e._v("recommendations")]),e._v(" described in subsequent section.")])]),e._v(" "),a("p",[a("strong",[e._v("Examples")])]),e._v(" "),a("ul",[a("li",[a("code",[e._v("https://api.foo.com/v1/vault/credit-cards")])]),e._v(" "),a("li",[a("code",[e._v("https://api.foo.com/v1/vault/credit-cards/CARD-7LT50814996943336KESEVWA")])]),e._v(" "),a("li",[a("code",[e._v("https://api.foo.com/v1/payments/billing-agreements/I-V8SSE9WLJGY6/re-activate")])])]),e._v(" "),a("p",[a("strong",[e._v("Formal Definition:")])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Term")]),e._v(" "),a("th",[e._v("Defiition")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("URI")]),e._v(" "),a("td",[e._v("[end-point] '"),a("strong",[e._v("/")]),e._v("' resource-path ['"),a("strong",[e._v("?")]),e._v("'query]")])]),e._v(" "),a("tr",[a("td",[e._v("end-point")]),e._v(" "),a("td",[e._v('[scheme "'),a("strong",[e._v("😕/")]),e._v("\"][ host ['"),a("strong",[e._v(":")]),e._v("' port]]")])]),e._v(" "),a("tr",[a("td",[e._v("scheme")]),e._v(" "),a("td",[e._v('"'),a("strong",[e._v("http")]),e._v('" or "'),a("strong",[e._v("https")]),e._v('"')])]),e._v(" "),a("tr",[a("td",[e._v("resource-path")]),e._v(" "),a("td",[e._v('"'),a("strong",[e._v("/v")]),e._v("\" version  '"),a("strong",[e._v("/")]),e._v("' namespace-name '"),a("strong",[e._v("/")]),e._v("' resource ('"),a("strong",[e._v("/")]),e._v("' resource)")])]),e._v(" "),a("tr",[a("td",[e._v("resource")]),e._v(" "),a("td",[e._v("resource-name ['"),a("strong",[e._v("/")]),e._v("' resource-id]")])]),e._v(" "),a("tr",[a("td",[e._v("resource-name")]),e._v(" "),a("td",[e._v("Alpha (Alpha | Digit | '-')*")])]),e._v(" "),a("tr",[a("td",[e._v("resource-id")]),e._v(" "),a("td",[e._v("value")])]),e._v(" "),a("tr",[a("td",[e._v("query")]),e._v(" "),a("td",[e._v("name '"),a("strong",[e._v("=")]),e._v("' value ('"),a("strong",[e._v("&")]),e._v("' name = value)*")])]),e._v(" "),a("tr",[a("td",[e._v("name")]),e._v(" "),a("td",[e._v("Alpha (Alpha | Digit | '_')*")])]),e._v(" "),a("tr",[a("td",[e._v("value")]),e._v(" "),a("td",[e._v("URI Percent encoded value")])])])]),e._v(" "),a("p",[e._v("Legend")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("'   Surround a special character with single quotes\n\"\tSurround strings with double quotes\n()\tUse parentheses for grouping\n[]\tUse brackets to specify optional expressions\n*\tAn expression can be repeated zero or more times\n")])])]),a("h3",{attrs:{id:"resource-names"}},[e._v("Resource Names")]),e._v(" "),a("p",[e._v("When modeling a service as a set of resources, developers MUST follow these principles:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Nouns MUST be used, not verbs.")])]),e._v(" "),a("li",[a("p",[e._v("Resource names MUST be singular for singletons; collections' names MUST be plural.")]),e._v(" "),a("ul",[a("li",[e._v("A description of the automatic payments configuration on a user's account\n"),a("ul",[a("li",[a("code",[e._v("GET /autopay")]),e._v(" returns the full representation")])])]),e._v(" "),a("li",[e._v("A collection of hypothetical charges:\n"),a("ul",[a("li",[a("code",[e._v("GET /charges")]),e._v(" returns a list of charges that have been made")]),e._v(" "),a("li",[a("code",[e._v("POST /charges")]),e._v(" creates a new charge resource, "),a("code",[e._v("/charges/1234")])]),e._v(" "),a("li",[a("code",[e._v("GET /charges/1234")]),e._v(" returns a full representation of a single charge")])])])])]),e._v(" "),a("li",[a("p",[e._v("Resource names MUST be lower-case and use only alphanumeric characters and hyphens.")]),e._v(" "),a("ul",[a("li",[e._v("The hyphen character, ( - ), MUST be used as a word separator in URI path literals. "),a("strong",[e._v("Note")]),e._v(" that this is the only place where hyphens are used as a word separator. In nearly all other situations, the underscore character, ( _ ), MUST be used.")])])])]),e._v(" "),a("h3",{attrs:{id:"query-parameter-names"}},[e._v("Query Parameter Names")]),e._v(" "),a("ul",[a("li",[e._v("Literals/expressions in query strings SHOULD be separated using underscore ( _ ).")]),e._v(" "),a("li",[e._v("Query parameters values MUST be percent-encoded.")]),e._v(" "),a("li",[e._v("Query parameters MUST start with a letter and SHOULD be all in lower case. Only alpha characters, digits and the underscore ( _ ) character SHALL be used.")]),e._v(" "),a("li",[e._v("Query parameters SHOULD be optional.")]),e._v(" "),a("li",[e._v("Some query parameter names are reserved, as indicated in "),a("a",{attrs:{href:"#resource-collections"}},[e._v("Resource Collections")]),e._v(".")])]),e._v(" "),a("p",[e._v("For more specific info on the query parameter usage, see "),a("a",{attrs:{href:"#uri-standards-query"}},[e._v("URI Standards")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"field-names"}},[e._v("Field Names")]),e._v(" "),a("p",[e._v("The data model for the representation MUST conform to "),a("a",{attrs:{href:"http://json.org/",title:"JSON",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON"),a("OutboundLink")],1),e._v(". The values may themselves be objects, strings, numbers, booleans, or arrays of objects.")]),e._v(" "),a("ul",[a("li",[e._v("Key names MUST be lower-case words, separated by an underscore character, ( _ ).\n"),a("ul",[a("li",[a("code",[e._v("foo")])]),e._v(" "),a("li",[a("code",[e._v("bar_baz")])])])]),e._v(" "),a("li",[e._v("Prefix such as "),a("code",[e._v("is_")]),e._v(" or "),a("code",[e._v("has_")]),e._v(" SHOULD NOT be used for keys of type boolean.")]),e._v(" "),a("li",[e._v("Fields that represent arrays SHOULD be named using plural nouns (e.g. authenticators-contains one or more authenticators, products-contains one or more products).")])]),e._v(" "),a("h2",{attrs:{id:"enum-names"}},[e._v("Enum Names")]),e._v(" "),a("p",[e._v("Entries (values) of an enum SHOULD be composed of only upper-case alphanumeric characters and the underscore character, ( _ ).")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("FIELD_10")])]),e._v(" "),a("li",[a("code",[e._v("NOT_EQUAL")])])]),e._v(" "),a("p",[e._v("If there is an industry standard that requires us to do otherwise, enums MAY contain other characters.")]),e._v(" "),a("h2",{attrs:{id:"link-relation-names"}},[e._v("Link Relation Names")]),e._v(" "),a("p",[e._v("A link relation type represented by "),a("code",[e._v("rel")]),e._v(" must be in lower-case.")]),e._v(" "),a("ul",[a("li",[e._v("Example")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"links": [\n    {\n        "href": "https://uri.foo.com/v1/customer/partner-referrals/ALT-JFWXHGUV7VI/activate",\n        "rel": "activate",\n        "method": "POST"\n\n    }\n   ]\n')])])]),a("h2",{attrs:{id:"file-names"}},[e._v("File Names ")]),e._v(" "),a("p",[e._v("JSON schema for various types used by API SHOULD each be contained in separate files, referenced using the "),a("code",[e._v("$ref")]),e._v(" syntax (e.g. "),a("code",[e._v('"$ref":"object.json"')]),e._v("). JSON Schema files SHOULD use underscore naming syntax, e.g. "),a("code",[e._v("transaction_history.json")]),e._v(".")]),e._v(" "),a("h1",{attrs:{id:"uri"}},[e._v("URI")]),e._v(" "),a("h2",{attrs:{id:"resource-path"}},[e._v("Resource Path")]),e._v(" "),a("p",[e._v("An API's "),a("a",{attrs:{href:"#uri-components"}},[e._v("resource path")]),e._v(" consists of URI's path, query and fragment components. It would include API's major version followed by namespace, resource name and optionally one or more sub-resources. For example, consider the following URI.")]),e._v(" "),a("p",[a("code",[e._v("https://api.foo.com/v1/vault/credit-cards/CARD-7LT50814996943336KESEVWA")])]),e._v(" "),a("p",[e._v("Following table lists various pieces of the above URI's resource path.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Path Piece")]),e._v(" "),a("th",[e._v("Description")]),e._v(" "),a("th",[e._v("Definition")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("v1")])]),e._v(" "),a("td",[e._v("Specifies major version 1 of the API")]),e._v(" "),a("td",[e._v("The API major version is used to distinguish between two backward-incompatible versions of the same API. The API major version is an integer value which MUST be included as part of the URI.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("vault")])]),e._v(" "),a("td",[e._v("The namespace")]),e._v(" "),a("td",[e._v("Namespace identifiers are used to provide a context and scope for resources. They are determined by logical boundaries in the business capability model implemented by the API platform.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("credit-cards")])]),e._v(" "),a("td",[e._v("The resource name")]),e._v(" "),a("td",[e._v("If the resource name represents a collection of resources, then the "),a("code",[e._v("GET")]),e._v(" method on the resource should retrieve the list of resources. Query parameters should be used to specify the search criteria.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("CARD-7LT50814996943336KESEVWA")])]),e._v(" "),a("td",[e._v("The resource ID")]),e._v(" "),a("td",[e._v("To retrieve a particular resource out of the collection, a resource ID MUST be specified as part of the URI. Sub-resources are discussed below.")])])])]),e._v(" "),a("h4",{attrs:{id:"subresource-path"}},[e._v("Sub-Resources")]),e._v(" "),a("p",[e._v("Sub-resources represent a relationship from one resource to another. The sub-resource name provides a meaning for the relationship. If cardinality is 1:1, then no additional information is required. Otherwise, the sub-resource SHOULD provide a sub-resource ID for unique identification. If cardinality is 1:many, then all the sub-resources will be returned. No more than two levels of sub-resources SHOULD be supported.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Example")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("code",[e._v("GET https://api.foo.com/v1/customer-support/disputes/ABCD1234/documents")])]),e._v(" "),a("td",[e._v("This call should return all the documents associated with dispute ABCD1234.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("GET https://api.foo.com/v1/customer-support/disputes/ABCD1234/documents/102030")])]),e._v(" "),a("td",[e._v("This call should return only the details for a particular document associated with this dispute. Keep in mind that this is only an illustrative example  to show how to use sub-resource IDs. In practice, two step invocations SHOULD be avoided. If second identifier is unique, top-level resource (e.g. "),a("code",[e._v("/v1/customer-support/documents/102030")]),e._v(") is preferred.")])]),e._v(" "),a("tr",[a("td",[a("code",[e._v("GET https://api.foo.com/v1/customer-support/disputes/ABCD1234/transactions")])]),e._v(" "),a("td",[e._v("The following example should return all the transactions associated with this dispute and their details, so there SHOULD NOT be a need to specify a particular transaction ID. If specific transaction ID retrieval is needed, "),a("code",[e._v("/v1/customer-support/transactions/ABCD1234")]),e._v(" is preferred (assuming IDs are unique).")])])])]),e._v(" "),a("h3",{attrs:{id:"resource-identifiers"}},[e._v("Resource Identifiers")]),e._v(" "),a("p",[a("a",{attrs:{href:"#resource-identifier"}},[e._v("Resource identifiers")]),e._v(" identify a resource or a sub-resource. These "),a("strong",[e._v("MUST")]),e._v(" conform to the following guidelines.")]),e._v(" "),a("ul",[a("li",[e._v("The lifecycle of a resource identifier MUST be owned by the resource's domain model, where they can be guaranteed to uniquely identify a single resource.")]),e._v(" "),a("li",[e._v("APIs MUST NOT use the database sequence number as the resource identifier.")]),e._v(" "),a("li",[e._v("A "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Universally_unique_identifier",target:"_blank",rel:"noopener noreferrer"}},[e._v("UUID"),a("OutboundLink")],1),e._v(", Hashed Id ("),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Hash-based_message_authentication_code",target:"_blank",rel:"noopener noreferrer"}},[e._v("HMAC"),a("OutboundLink")],1),e._v(" based) is preferred as a resource identifier.")]),e._v(" "),a("li",[e._v("For security and data integrity reasons all sub-resource IDs MUST be scoped within the parent resource only."),a("br"),e._v(" "),a("strong",[e._v("Example:")]),e._v(" "),a("code",[e._v("/users/1234/linked-accounts/ABCD")]),a("br"),e._v(' Even if account "ABCD" exists, it MUST NOT be returned unless it is linked to user: 1234.')]),e._v(" "),a("li",[e._v("Enumeration values can be used as sub-resource IDs. String representation of the enumeration value SHOULD be used.")]),e._v(" "),a("li",[e._v("There MUST NOT be two resource identifiers one after the other."),a("br"),e._v(" "),a("strong",[e._v("Example:")]),e._v(" "),a("code",[e._v("https://api.foo.com/v1/payments/payments/12345/102030")])]),e._v(" "),a("li",[e._v("Resource IDs SHOULD try to use either Resource Identifier Characters or ASCII characters. There "),a("strong",[e._v("SHOULD NOT")]),e._v(" be any ID using UTF-8 characters.")]),e._v(" "),a("li",[e._v("Resource IDs and query parameter values MUST perform URI percent-encoding for any character other than URI unreserved characters. Query parameter values using UTF-8 characters MUST be encoded.")])]),e._v(" "),a("h2",{attrs:{id:"query-parameters"}},[e._v("Query Parameters")]),e._v(" "),a("p",[e._v("Query parameters are name/value pairs specified after the resource path, as prescribed in RFC 3986.\n"),a("a",{attrs:{href:"#naming-conventions"}},[e._v("Naming Conventions")]),e._v(" should also be followed when applying the following section.")]),e._v(" "),a("h4",{attrs:{id:"filter-a-resource-collection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filter-a-resource-collection"}},[e._v("#")]),e._v(" Filter a resource collection")]),e._v(" "),a("ul",[a("li",[e._v("Query parameters SHOULD be used only for the purpose of restricting the resource collection or as search or filtering criteria.")]),e._v(" "),a("li",[e._v("The resource identifier in a collection SHOULD NOT be used to filter collection results, resource identifier should be in the URI.")]),e._v(" "),a("li",[e._v("Parameters for pagination SHOULD follow "),a("a",{attrs:{href:"#pagination"}},[e._v("pagination")]),e._v(" guidelines.")]),e._v(" "),a("li",[e._v("Default sort order SHOULD be considered as undefined and non-deterministic. If a explicit sort order is desired, the query parameter "),a("code",[e._v("sort")]),e._v(" SHOULD be used with the following general syntax: "),a("code",[e._v("{field_name}|{asc|desc},{field_name}|{asc|desc}")]),e._v(". For instance: "),a("code",[e._v("/accounts?sort=date_of_birth|asc,zip_code|desc")])])]),e._v(" "),a("h4",{attrs:{id:"query-parameters-on-a-single-resource"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#query-parameters-on-a-single-resource"}},[e._v("#")]),e._v(" Query parameters on a single resource")]),e._v(" "),a("p",[e._v("In typical cases where one resource is utilized (e.g. "),a("code",[e._v("/v1/payments/billing-plans/P-94458432VR012762KRWBZEUA")]),e._v("), query parameters SHOULD NOT be used.")]),e._v(" "),a("h4",{attrs:{id:"cache-friendly-apis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cache-friendly-apis"}},[e._v("#")]),e._v(" Cache-friendly APIs")]),e._v(" "),a("p",[e._v("In rare cases where a resource needs to be highly cacheable (usually data with minimal change), query parameters MAY be utilized as opposed to "),a("code",[e._v("POST")]),e._v(" + request body. As "),a("code",[e._v("POST")]),e._v(" would make the response uncacheable, "),a("code",[e._v("GET")]),e._v(" is preferred in these situations. This is the only scenario in which query parameters MAY be required.")]),e._v(" "),a("h4",{attrs:{id:"query-parameters-with-post"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#query-parameters-with-post"}},[e._v("#")]),e._v(" Query parameters with POST")]),e._v(" "),a("p",[e._v("When "),a("code",[e._v("POST")]),e._v(" is utilized for an operation, query parameters are usually NOT RECOMMENDED in favor of request body fields. In cases where "),a("code",[e._v("POST")]),e._v(" provides paged results (typically in complex search APIs where "),a("code",[e._v("GET")]),e._v(" is not appropriate), query parameters MAY be used in order to provide hypermedia links to the next page of results.")]),e._v(" "),a("h4",{attrs:{id:"passing-multiple-values-for-the-same-query-parameter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#passing-multiple-values-for-the-same-query-parameter"}},[e._v("#")]),e._v(" Passing multiple values for the same query parameter")]),e._v(" "),a("p",[e._v("When using query parameters for search functionality, it is often necessary to pass multiple values. For instance, it might be the case that a resource could have many states, such as "),a("code",[e._v("OPEN")]),e._v(", "),a("code",[e._v("CLOSED")]),e._v(", and "),a("code",[e._v("INVALID")]),e._v(". What if an API client wants to find all items that are either "),a("code",[e._v("CLOSED")]),e._v(" or "),a("code",[e._v("INVALID")]),e._v("?")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("It is RECOMMENDED that APIs implement this functionality by repeating the query parameter. This is inherently supported by HTTP standards and already built in to most client libraries.")]),e._v(" "),a("ul",[a("li",[e._v("The query above would be implemented as "),a("code",[e._v("?status=CLOSED&status=INVALID")]),e._v(".")]),e._v(" "),a("li",[e._v("The parameter MUST be marked as repeatable in API specifications using "),a("code",[e._v('"repeated": true')]),e._v(" in the parameter's definition section.")]),e._v(" "),a("li",[e._v("The parameter's name SHOULD be singular.")])])]),e._v(" "),a("li",[a("p",[e._v("URIs have practical length limits that are quite low - most conservatively, about "),a("a",{attrs:{href:"https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url-in-different-browsers#417184",target:"_blank",rel:"noopener noreferrer"}},[e._v("2,000 characters"),a("OutboundLink")],1),e._v(". Therefore, there are situations where API designers MAY choose to use a single query parameter that accepts comma-separated values in order to accommodate more values in the query-string. Keep in mind that server and client libraries don't consistently provide this functionality, which means that implementers will need to write additional string parsing code. Due to the additional complexity and divergence from HTTP standards, this solution is NOT RECOMMENDED unless justified.")]),e._v(" "),a("ul",[a("li",[e._v("The query above would be implemented as "),a("code",[e._v("?statuses=CLOSED,INVALID")]),e._v(".")]),e._v(" "),a("li",[e._v("The parameter MUST NOT be marked as repeatable in API specifications.")]),e._v(" "),a("li",[e._v("The parameter MUST be marked as "),a("code",[e._v('"type": "string"')]),e._v(" in API specifications in order to accommodate comma-separated values. Any other "),a("code",[e._v("type")]),e._v(" value MUST NOT be used. The parameter description should indicate that comma separated values are accepted.")]),e._v(" "),a("li",[e._v("The query-parameter name SHOULD be plural, to provide a hint that this pattern is being employed.")]),e._v(" "),a("li",[e._v("The comma character (Unicode "),a("code",[e._v("U+002C")]),e._v(") SHOULD be used as the separator between values.")]),e._v(" "),a("li",[e._v("The API documentation MUST define how to escape the separator character, if necessary.")])])])]),e._v(" "),a("h1",{attrs:{id:"json-schema"}},[e._v("JSON Schema")]),e._v(" "),a("p",[e._v("We would assume that "),a("a",{attrs:{href:"http://json-schema.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON Schema"),a("OutboundLink")],1),e._v(" is used to describe request/response models. Determine the version of JSON Schema to use for your APIs. At the time of writing this, "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-04",title:"draft-04",target:"_blank",rel:"noopener noreferrer"}},[e._v("draft-04"),a("OutboundLink")],1),e._v(" is the latest version. JSON Schema "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-04",title:"JSON schema draft-04",target:"_blank",rel:"noopener noreferrer"}},[e._v("draft-03"),a("OutboundLink")],1),e._v(" has been deprecated, as support in tools is mostly focused on draft-04. The draft-04 is backwards incompatible with draft-03.")]),e._v(" "),a("h2",{attrs:{id:"api-contract-description"}},[e._v("API Contract Description")]),e._v(" "),a("p",[e._v("There are various options available to define the API's contract interface (API specification or API description). Examples are: "),a("a",{attrs:{href:"http://swagger.io/specification",title:"OpenAPI",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenAPI (fka Swagger)"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"https://developers.google.com/discovery/v1/reference/apis#method_discovery_apis_getRest",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Discovery Document"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"http://raml.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("RAML"),a("OutboundLink")],1),e._v(", "),a("RouterLink",{attrs:{to:"/api-style-guide/api-style-guide.html#https://apiblueprint.org/"}},[e._v("API BluePrint")]),e._v(" and so on.")],1),e._v(" "),a("p",[a("a",{attrs:{href:"http://swagger.io/specification",title:"OpenAPI",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenAPI"),a("OutboundLink")],1),e._v(" is a vendor neutral API description format. The OpenAPI "),a("a",{attrs:{href:"http://swagger.io/specification/#schemaObject",title:"OpenAPI Schema",target:"_blank",rel:"noopener noreferrer"}},[e._v("Schema Object"),a("OutboundLink")],1),e._v(" (or OpenAPI JSON) is based on the "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-04",title:"draft-04",target:"_blank",rel:"noopener noreferrer"}},[e._v("draft-04"),a("OutboundLink")],1),e._v(" and uses a predefined subset of the draft-04 schema. In addition, there are extensions provided by the  specification to allow for more complete documentation.")]),e._v(" "),a("p",[e._v("We have used OpenAPI wherever we need to describe the API specification throughout this document.")]),e._v(" "),a("h2",{attrs:{id:"schema"}},[e._v("$schema")]),e._v(" "),a("p",[a("strong",[e._v("A note about using $schema with OpenAPI")])]),e._v(" "),a("p",[e._v("As of writing this (Q12017), OpenAPI tools DO NOT recognize "),a("code",[e._v("$schema")]),e._v(" value and (incorrectly) assume the value of $schema to be "),a("code",[e._v("http://swagger.io/v2/schema.json#")]),e._v(" only. The following description applies to JSON schema (http://json-schema.org) used in API specification specified using specifications other than OpenAPI.")]),e._v(" "),a("p",[e._v("Use "),a("a",{attrs:{href:"http://json-schema.org/latest/json-schema-core.html#anchor22",target:"_blank",rel:"noopener noreferrer"}},[e._v("$schema"),a("OutboundLink")],1),e._v(" to indicate the version of JSON schema used by each JSON type you define as shown below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "object",\n    "$schema": "http://json-schema.org/draft-04/schema#",\n    "name": "Order",\n    "description": "An order transaction.",\n    "properties": {\n\n    }\n}\n\n')])])]),a("p",[e._v("In case your JSON type uses "),a("code",[e._v("links")]),e._v(", "),a("code",[e._v("media")]),e._v(" and other such keywords or schemas such as for "),a("code",[e._v("linkDescription")]),e._v(" that are defined in "),a("a",{attrs:{href:"http://json-schema.org/draft-04/hyper-schema",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://json-schema.org/draft-04/hyper-schema"),a("OutboundLink")],1),e._v(", you should provide the value for "),a("code",[e._v("$schema")]),e._v(" accordingly as shown below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "object",\n    "$schema": "http://json-schema.org/draft-04/hyper-schema#",\n    "name": "Linked-Order",\n    "description": "An order transaction using HATEOAS links.",\n    "properties": {\n\n    }\n}\n')])])]),a("p",[e._v("If you are unsure about the specific schema version to refer to, it would be safe to refer "),a("code",[e._v("http://json-schema.org/draft-04/hyper-schema#")]),e._v(" schema since it would cover all aspects of any JSON schema.")]),e._v(" "),a("h2",{attrs:{id:"readOnly"}},[e._v("readOnly")]),e._v(" "),a("p",[e._v("When resources contain immutable fields, "),a("code",[e._v("PUT")]),e._v("/"),a("code",[e._v("PATCH")]),e._v(" operations can still be utilized to update that resource. To indicate immutable fields in the resource, the "),a("code",[e._v("readOnly")]),e._v(" field can be specified on the immutable fields.")]),e._v(" "),a("h3",{attrs:{id:"example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example"}},[e._v("#")]),e._v(" Example")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"properties": {\n\t\t"id": {\n\t\t\t"type": "string",\n\t\t\t"description": "Identifier of the resource.",\n\t\t\t"readOnly": true\n\t\t},\n')])])]),a("h2",{attrs:{id:"migration-from-draft03"}},[e._v("Migration From draft-03")]),e._v(" "),a("p",[e._v("Key differences between JSON schema "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-03",title:"draft-03",target:"_blank",rel:"noopener noreferrer"}},[e._v("draft-03"),a("OutboundLink")],1),e._v(" and draft-04 have been captured by JSON Schema contributors in a "),a("a",{attrs:{href:"https://github.com/json-schema/json-schema/wiki/ChangeLog",target:"_blank",rel:"noopener noreferrer"}},[e._v("changelog"),a("OutboundLink")],1),e._v(". Additionally, this "),a("a",{attrs:{href:"http://stackoverflow.com/questions/17205260/json-schema-draft4-vs-json-schema-draft3",target:"_blank",rel:"noopener noreferrer"}},[e._v("StackOverflow thread"),a("OutboundLink")],1),e._v(" provides some additional quality migration guidance.")]),e._v(" "),a("p",[e._v("The following items are the most common migration issues API specifications will need to address:")]),e._v(" "),a("h4",{attrs:{id:"required"}},[e._v("required")]),e._v(" "),a("p",[e._v("draft-03 defines required fields in the composition of a field:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "object",\n    "$schema": "http://json-schema.org/draft-03/schema#",\n    "name": "Order",\n    "description": "An order transaction.",\n    "properties": {\n        "id": {\n            "type": "string",\n            "description": "Identifier of the order transaction."\n        },\n        "amount": {\n            "required": true,\n            "description": "Amount being collected.",\n            "$ref": "v1/schema/json/draft-04/amount.json"\n        }\n    }\n}\n')])])]),a("p",[e._v("In draft-04, an array as a peer to properties is used to designate the required fields:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "object",\n    "$schema": "http://json-schema.org/draft-04/schema#",\n    "name": "Order",\n    "description": "An order transaction.",\n    "required": [\n        "amount"\n    ],\n    "properties": {\n        "id": {\n            "type": "string",\n            "description": "Identifier of the order transaction."\n        },\n        "amount": {\n            "description": "Amount being collected.",\n            "$ref": "v1/schema/json/draft-04/amount.json"\n        }\n    }\n}\n')])])]),a("h4",{attrs:{id:"readOnly"}},[e._v("readOnly")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("readonly")]),e._v(" field was removed from draft-03, and replaced by "),a("a",{attrs:{href:"http://json-schema.org/latest/json-schema-hypermedia.html#anchor15",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("readOnly")]),a("OutboundLink")],1),e._v(" (note the upper case "),a("code",[e._v("O")]),e._v(").")]),e._v(" "),a("h4",{attrs:{id:"format"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#format"}},[e._v("#")]),e._v(" Format")]),e._v(" "),a("p",[e._v("The "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-03#section-5.23",target:"_blank",rel:"noopener noreferrer"}},[e._v("format"),a("OutboundLink")],1),e._v(" attribute is used when defining fields which fall into a certain predefined pattern.")]),e._v(" "),a("p",[e._v("These following formats are deprecated in draft-04:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("date")])]),e._v(" "),a("li",[a("code",[e._v("time")])])]),e._v(" "),a("p",[e._v("Therefore, only "),a("code",[e._v('"format": "date-time"')]),e._v(" MUST be used for any variation of date, time, or date and time. Any references to formats of "),a("code",[e._v("date")]),e._v(" or "),a("code",[e._v("time")]),e._v(" should be updated to "),a("code",[e._v("date-time")]),e._v(".")]),e._v(" "),a("p",[e._v("Field descriptions SHOULD indicate specifics of whether date or time is accepted. "),a("code",[e._v("date-time")]),e._v(" specifies that ISO-8601/RFC3339 dates are utilized, which includes date-only and time-only.")]),e._v(" "),a("h2",{attrs:{id:"advanced-syntax-draft04"}},[e._v("Advanced Syntax draft-04")]),e._v(" "),a("p",[e._v("Be aware that "),a("code",[e._v("anyOf")]),e._v("/"),a("code",[e._v("allOf")]),e._v("/"),a("code",[e._v("oneOf")]),e._v(" syntax can cause issues with tooling, as code generators, documentation tools and validation of these keywords is often not implemented.")]),e._v(" "),a("h3",{attrs:{id:"allof"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#allof"}},[e._v("#")]),e._v(" allOf")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("allOf")]),e._v(" keyword MUST only be used for the purposes listed here.")]),e._v(" "),a("h4",{attrs:{id:"extend-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#extend-object"}},[e._v("#")]),e._v(" Extend object")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("allOf")]),e._v(" keyword in JSON Schema SHOULD be used for extending objects. In draft-03, this was implemented with the "),a("code",[e._v("extends")]),e._v(" keyword, which has been deprecated in draft-04.")]),e._v(" "),a("h5",{attrs:{id:"example-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-2"}},[e._v("#")]),e._v(" Example")]),e._v(" "),a("p",[e._v("A common need is to extend a common type with additional fields. In this example, we will extend the "),a("a",{attrs:{href:"v1/schema/json/draft-04/address_portable.json"}},[e._v("address")]),e._v(" with a "),a("code",[e._v("type")]),e._v(" field.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"shipping_address": { "$ref": "v1/schema/json/draft-04/address_portable.json" }\n')])])]),a("p",[e._v("Using the "),a("code",[e._v("allOf")]),e._v(" keyword, we can combine both the common type address schema and an extra schema snippet for the address type:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"shipping_address": {\n  "allOf": [\n    // Here, we include our "core" address schema...\n    { "$ref": "v1/schema/json/draft-04/address_portable.json" },\n\n    // ...and then extend it with stuff specific to a shipping\n    // address\n    { "properties": {\n        "type": { "enum": [ "residential", "business" ] }\n      },\n      "required": ["type"]\n    }\n  ]\n}\n')])])]),a("h3",{attrs:{id:"anyof-oneof"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#anyof-oneof"}},[e._v("#")]),e._v(" anyOf/oneOf")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("anyOf")]),e._v(" and "),a("code",[e._v("oneOf")]),e._v(" keywords SHOULD NOT be used to design APIs. A variety of problems occur from these keywords:")]),e._v(" "),a("ul",[a("li",[e._v("Codegen tools do not have accurate way to generate models/objects from these definitions.")]),e._v(" "),a("li",[e._v("Developer portals would have significant difficulty in clearly explaining to API consumers the meaning of these relationships.")]),e._v(" "),a("li",[e._v("Consumers using statically typed languages (e.g. C#, Java) have a more complex experience trying to conditionally deserialize objects which change based on some element.\n"),a("ul",[a("li",[e._v("Custom deserialization code is required to represent objects based on the response, standard libraries do not accommodate this out of the box.")]),e._v(" "),a("li",[e._v("Flat structures which combine all possible fields in an object are automatically deserialized properly.")])])])]),e._v(" "),a("h5",{attrs:{id:"anyof-oneof-problems-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#anyof-oneof-problems-example"}},[e._v("#")]),e._v(" anyOf/oneOf Problems: Example")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "activity_type": {\n        "description": "The entity type of the item. One of \'PAYMENT\', \'MONEY-REQUEST\', \'RECURRING-PAYMENT-PROFILE\', \'ORDER\', \'PAYOUT\', \'SUBSCRIPTION\', \'INVOICE\'",\n        "type": "string",\n        "enum": [\n            "PAYMENT",\n            "MONEY-REQUEST"\n        ]\n    },\n    "extensions": {\n        "type": "object",\n        "description": "Extension to core activity fields",\n        "oneOf": [\n            {\n                "$ref": "extended_properties.json#/definitions/payment_properties"\n            },\n            {\n                "$ref": "extended_properties.json#/definitions/money_request_properties"\n            }\n        ]\n    }\n}\n')])])]),a("p",[e._v("In order for an API consumer to deserialize this response (where POJO/POCO objects are used), standard mechanisms would not work. Because the "),a("code",[e._v("extensions")]),e._v(" field can change on any given response, the consumer is forced to create a composite object to represent both "),a("code",[e._v("payment_properties.json")]),e._v(" and "),a("code",[e._v("money_request_properties.json")]),e._v(".")]),e._v(" "),a("p",[e._v("A better approach:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "activity_type": {\n        "description": "The entity type of the item. One of \'PAYMENT\', \'MONEY-REQUEST\', \'RECURRING-PAYMENT-PROFILE\', \'ORDER\', \'PAYOUT\', \'SUBSCRIPTION\', \'INVOICE\'",\n        "type": "string",\n        "enum": [\n            "PAYMENT",\n            "MONEY-REQUEST"\n        ]\n    },\n    "payment": {\n        "type": "object",\n        "description": "Payment-specific activity.",\n        "$ref": "payment.json"\n    },\n    "money_request": {\n        "type": "object",\n        "description": "Money request-specific activity.",\n        "$ref": "money_request.json"    \n    }\n}\n')])])]),a("p",[e._v("In this scenario, both "),a("code",[e._v("payment")]),e._v(" and "),a("code",[e._v("money_request")]),e._v(" are in the definition. However, in practice, only one field would be serialized based on the "),a("code",[e._v("activity_type")]),e._v(".")]),e._v(" "),a("p",[e._v("For API consumers, this is a very predictable response, and allows for easy deserialization through standard libraries, without writing custom deserializers.")]),e._v(" "),a("h1",{attrs:{id:"json-types"}},[e._v("JSON Types")]),e._v(" "),a("p",[e._v("This section provides guidelines related to usage of "),a("a",{attrs:{href:"#json-primitive"}},[e._v("JSON primitive types")]),e._v(" as well as "),a("a",{attrs:{href:"#common-types"}},[e._v("commonly useful JSON types")]),e._v(" for address, name, currency, money, country, phone, among other things.")]),e._v(" "),a("h2",{attrs:{id:"json-primitive"}},[e._v("JSON Primitive Types")]),e._v(" "),a("p",[e._v("JSON Schema "),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-04",title:"draft-04",target:"_blank",rel:"noopener noreferrer"}},[e._v("draft-04"),a("OutboundLink")],1),e._v(" SHOULD be used to define all fields in APIs. As such, the following notes about the JSON Schema primitive types SHOULD be respected. Following are the guidelines governing use of JSON primitive type representations.")]),e._v(" "),a("h3",{attrs:{id:"string"}},[e._v("String")]),e._v(" "),a("p",[e._v("At a minimum, "),a("code",[e._v("strings")]),e._v(" SHOULD always explicitly define a "),a("code",[e._v("minLength")]),e._v(" and "),a("code",[e._v("maxLength")]),e._v(".")]),e._v(" "),a("p",[e._v("There are several reasons for doing so.")]),e._v(" "),a("ol",[a("li",[e._v("Without a maximum length, it is impossible to reliably define a database column to store a given string.")]),e._v(" "),a("li",[e._v("Without a maximum and minimum, it is also impossible to predict whether a change in length will break backwards-compatibility with existing clients.")]),e._v(" "),a("li",[e._v("Finally, without a minimum length, it is often possible for clients to send an empty string when they should not be allowed to do so.")])]),e._v(" "),a("p",[e._v("APIs MAY avoid defining "),a("code",[e._v("minLength")]),e._v(" and "),a("code",[e._v("maxLength")]),e._v(" only if the string value is from another upstream system that has refused to provide any information on these values. This decision must be documented in the schema.")]),e._v(" "),a("p",[e._v("API authors SHOULD consider practical limitations when defining "),a("code",[e._v("maxLength")]),e._v(". For example, when using the VARCHAR2 type, modern versions of Oracle can safely store a Unicode string of no more than 1,000 characters. (The size limit is "),a("a",{attrs:{href:"https://docs.oracle.com/cd/B28359_01/server.111/b28320/limits001.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("4,000"),a("OutboundLink")],1),e._v(" bytes and each Unicode character may take up to four bytes for storage).")]),e._v(" "),a("p",[a("code",[e._v("string")]),e._v(" SHOULD utilize the "),a("code",[e._v("pattern")]),e._v(" property as appropriate, especially when defining enumerated values or numbers. However, it is RECOMMENDED not to overly constrain fields without a valid technical reason.")]),e._v(" "),a("h3",{attrs:{id:"enum"}},[e._v("Enumeration")]),e._v(" "),a("p",[e._v("The JSON Schema "),a("code",[e._v("enum")]),e._v(" keyword is difficult to use safely. It is not possible to add new values to an "),a("code",[e._v("enum")]),e._v(" in a schema that describes a service response without breaking backwards compatibility. In that scenario, clients will often reject responses with values that are not in the older copy of the schema that they posess. This is usually not the desired behavior. Clients should usually handle unknown values more gracefully, but since you can't control nor verify their behavior, it is not safe to add new enum values.")]),e._v(" "),a("p",[e._v("For the reasons stated above, the schema author MUST comply with the following guidelines while using an "),a("code",[e._v("enum")]),e._v(" with the JSON type "),a("code",[e._v("string")]),e._v(".")]),e._v(" "),a("ul",[a("li",[e._v("The keyword "),a("code",[e._v("enum")]),e._v(" SHOULD be used only when the set of values are fixed and would never change in future.")]),e._v(" "),a("li",[e._v("If you anticipate adding new values to the "),a("code",[e._v("enum")]),e._v(" array in future, avoid using the keyword "),a("code",[e._v("enum")]),e._v(". You SHOULD instead use a "),a("code",[e._v("string")]),e._v(" type and document all acceptable values for the "),a("code",[e._v("string")]),e._v(". When using a "),a("code",[e._v("string")]),e._v(" type to express enumerated values, you SHOULD enforce "),a("a",{attrs:{href:"#enum-names"}},[e._v("naming conventions")]),e._v(" through a "),a("code",[e._v("pattern")]),e._v(" field.")]),e._v(" "),a("li",[e._v("If there is no technical reason to do otherwise -- for instance, a pre-existing database column of smaller size -- "),a("code",[e._v("maxLength")]),e._v(" should be set to 255. "),a("code",[e._v("minLength")]),e._v(" should be set to 1 to prevent clients sending the empty string.")]),e._v(" "),a("li",[e._v("All possible values of an "),a("code",[e._v("enum")]),e._v(" field SHOULD be precisely defined in the documentation. If there is not enough space in the "),a("code",[e._v("description")]),e._v(" field to do so, you SHOULD use the API’s user guide to define them.")])]),e._v(" "),a("p",[e._v("Given below is the JSON snippet for enforcing naming conventions and length constraints.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "string",\n    "minLength": 1,\n    "maxLength": 255,\n    "pattern": "^[0-9A-Z_]+$",\n    "description": "A description of the field. The possible values are OPTION_ONE and OPTION_TWO."\n}\n\n')])])]),a("h3",{attrs:{id:"number"}},[e._v("Number")]),e._v(" "),a("p",[e._v("There are a number of difficulties associated with "),a("code",[e._v("number")]),e._v(" type in JSON.")]),e._v(" "),a("p",[e._v("JSON itself defines a "),a("code",[e._v("number")]),e._v(" very simply: it is an unbounded, fixed-point value. This is illustrated well by the railroad diagram for "),a("code",[e._v("number")]),e._v(" at "),a("a",{attrs:{href:"http://json.org/",title:"JSON",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON"),a("OutboundLink")],1),e._v(". There is only one "),a("code",[e._v("number")]),e._v(" type in JSON; there is no separate "),a("code",[e._v("integer")]),e._v(" type.")]),e._v(" "),a("p",[e._v("JSON Schema diverges from JSON and defines two number types: "),a("code",[e._v("number")]),e._v(" and "),a("code",[e._v("integer")]),e._v(". This is purely a convenience for schema validation; the JSON number type is used to implement both. Just as in JSON, both types are unbounded unless the schema author provides explicit "),a("code",[e._v("minimum")]),e._v(" and "),a("code",[e._v("maximum")]),e._v(" values.")]),e._v(" "),a("p",[e._v("Many programming languages do not safely handle unbounded values in JSON. JavaScript is an excellent example. A JSON deserializer is provided as part of the "),a("a",{attrs:{href:"http://www.ecma-international.org/publications/standards/Ecma-262.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("ECMAScript"),a("OutboundLink")],1),e._v(" specification. However, it requires that all JSON numbers are deserialized into the only "),a("code",[e._v("number")]),e._v(" type supported by JavaScript -- 64-bit floating point. This means that attempting to deserialize any JSON number larger than about 2^53 in a JavaScript client will result in an exception.")]),e._v(" "),a("p",[e._v("To ensure the greatest degree of cross-client compatibility possible, schema authors SHOULD:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Never use the JSON Schema "),a("code",[e._v("number")]),e._v(" type. Some languages may interpret it as a fixed-point value, and some as floating-point. Always use "),a("code",[e._v("string")]),e._v(" to represent a decimal value.")])]),e._v(" "),a("li",[a("p",[e._v("Only define "),a("code",[e._v("integer")]),e._v(" types for values that can be represented in a 32-bit signed integer, that is to say, values between ("),a("code",[e._v("(2^31) - 1) and -(2^31")]),e._v("). This ensures compatibility across a wide range of programming languages and circumstances. For example, array indices in JavaScript are signed 32-bit integers.")])]),e._v(" "),a("li",[a("p",[e._v("When using an "),a("code",[e._v("integer")]),e._v(" type, always provide an explicit minimum and a maximum. This not only allows backwards-incompatible changes to be detected, it also guarantees that all values can fit in a 32-bit signed integer. If there are no technical reasons to do otherwise, the "),a("code",[e._v("maximum")]),e._v(" and "),a("code",[e._v("minimum")]),e._v(" should be defined as "),a("code",[e._v("2147483647 (((2^31) - 1))")]),e._v(" and "),a("code",[e._v("-2147483648 (-(2^31))")]),e._v(" or "),a("code",[e._v("0")]),e._v(" respectively. Common sense should be used to determine whether to allow negative values. Business logic that could change in the future generally SHOULD NOT be used to determine boundaries; business rules can easily change and break backwards compatibility.")])])]),e._v(" "),a("p",[e._v("If there is any possibility that the value could not be represented by a signed 32-bit integer, now or in the future, not use the JSON Schema "),a("code",[e._v("integer")]),e._v(" type. Use a "),a("code",[e._v("string")]),e._v(" instead.")]),e._v(" "),a("p",[a("strong",[e._v("Examples")])]),e._v(" "),a("p",[e._v("This "),a("code",[e._v("integer")]),e._v(" type might be used to define an array index or page count, or perhaps the number of months an account has been open.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "integer",\n    "minimum": 0,\n    "maximum": 2147483647\n}\n')])])]),a("p",[e._v("When using a "),a("code",[e._v("string")]),e._v(" type to represent a number, authors MUST provide boundaries on size using "),a("code",[e._v("minLength")]),e._v(" and "),a("code",[e._v("maxLength")]),e._v(", and constrain the definition of the string to only represent numbers using "),a("code",[e._v("pattern")]),e._v(".")]),e._v(" "),a("p",[e._v("For example, this definition only allows positive integers and zero, with a maximum value of 999999:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "string",\n    "pattern": "^[0-9]+$",\n    "minLength": 1,\n    "maxLength": 6\n}\n')])])]),a("p",[e._v("The following definition allows the representation of fixed-point decimal values both positive or negative, with a maximum length of 32 and no requirements on scale:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "type": "string",\n    "pattern": "^(-?[0-9]+|-?([0-9]+)?[.][0-9]+)$"\n    "maxLength": 32,\n    "minLength": 1,\n}\n')])])]),a("h3",{attrs:{id:"array"}},[e._v("Array")]),e._v(" "),a("p",[e._v("JSON defines "),a("code",[e._v("array")]),e._v(" as unbounded.")]),e._v(" "),a("p",[e._v("Although practical limits are often much lower due to memory constraints, many programming languages do place maximum theoretical limits on the size of arrays. For example, JavaScript is limited to the length of a 32-bit unsigned integer by the ECMA-262 specification. Java is "),a("a",{attrs:{href:"https://stackoverflow.com/questions/3038392/do-java-arrays-have-a-maximum-size#3039805",target:"_blank",rel:"noopener noreferrer"}},[e._v("limited to about "),a("code",[e._v("Integer.MAX_VALUE - 8")]),a("OutboundLink")],1),e._v(", which is less than half of JavaScript.")]),e._v(" "),a("p",[e._v("To ensure maximum compatibility across languages and encourage paginated APIs, "),a("code",[e._v("maxItems")]),e._v(" SHOULD always be defined by schema authors. "),a("code",[e._v("maxItems")]),e._v(" SHOULD NOT have a value greater than can be represented by a 16-bit signed integer, in other words, "),a("code",[e._v("32767")]),e._v(" or "),a("code",[e._v("(2^15) - 1)")]),e._v(".")]),e._v(" "),a("p",[e._v("Note that developers MAY choose to set a smaller value; the value "),a("code",[e._v("32767")]),e._v(" is a default choice to be used when no better choice is available. However, developers SHOULD design their API for growth. For example, although a paginated API may only support a maximum of 100 results per page today, performance improvements may allow deveopers to improve that to 1,000 results next year. Therefore, "),a("code",[e._v("maxItems")]),e._v(" SHOULD NOT be used to communicate maximum page size.")]),e._v(" "),a("p",[a("code",[e._v("minItems")]),e._v(" SHOULD also be defined. In most situations, its value will be either "),a("code",[e._v("0")]),e._v(" or "),a("code",[e._v("1")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"null"}},[e._v("Null")]),e._v(" "),a("p",[e._v("APIs MUST NOT produce or consume "),a("code",[e._v("null")]),e._v(" values.")]),e._v(" "),a("p",[a("code",[e._v("null")]),e._v(" is a primitive type in JSON. When validating a JSON document against JSON Schema, a property's value can be "),a("code",[e._v("null")]),e._v(" only when it is explicitly allowed by the schema, using the "),a("code",[e._v("type")]),e._v(" keyword (e.g. "),a("code",[e._v('{"type": "null"}')]),e._v("). Since in an API "),a("code",[e._v("type")]),e._v(" will always need to be defined to some other value such as "),a("code",[e._v("object")]),e._v(" or "),a("code",[e._v("string")]),e._v(", and these standards prohibit using schema composition keywords such as "),a("code",[e._v("anyOf")]),e._v(" or "),a("code",[e._v("oneOf")]),e._v(" that allow multiple types, if an API produces or consumes null values, it is unlikely that, according to the API's own schemas, this is actually valid data.")]),e._v(" "),a("p",[e._v("In addition, in JSON, a property that doesn't exist or is missing in the object is considered to be undefined; this is conceptually separate from a property that is defined with a value of "),a("code",[e._v("null")]),e._v(", but many programming languages have difficulty drawing this distinction.")]),e._v(" "),a("p",[e._v("For example, a property "),a("code",[e._v("my_property")]),e._v(" defined as "),a("code",[e._v('{"type": "null"}')]),e._v(" is represented as")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "my_property": null\n}\n')])])]),a("p",[e._v("While a property that is "),a("code",[e._v("undefined")]),e._v(" would not be present in the object:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("{ }\n")])])]),a("p",[e._v("In most strongly typed languages, such as Java, there is no concept of an "),a("code",[e._v("undefined")]),e._v(" type, which means that for all undefined fields in a JSON object, a deserializer would return the value of such types as "),a("code",[e._v("null")]),e._v(" when you try to retrieve them. Similarly, some Java-based JSON serializers serialize fields to JSON "),a("code",[e._v("null")]),e._v(" by default, even though it is not possible for the serializer to determine whether the author of the Java object intended for that property to be defined with a value of "),a("code",[e._v("null")]),e._v(", or simply undefined. In Jackson, for example, this behavior is moderated through use of the "),a("a",{attrs:{href:"https://fasterxml.github.io/jackson-annotations/javadoc/2.8/com/fasterxml/jackson/annotation/JsonInclude.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("JsonInclude")]),a("OutboundLink")],1),e._v(" annotation. On the other hand, the org.json library defines an object called "),a("a",{attrs:{href:"https://stleary.github.io/JSON-java/org/json/JSONObject.html#NULL",target:"_blank",rel:"noopener noreferrer"}},[e._v("NULL"),a("OutboundLink")],1),e._v(" to distinguish between "),a("code",[e._v("null")]),e._v(" and "),a("code",[e._v("undefined")]),e._v(".")]),e._v(" "),a("p",[e._v("Eschewing JSON null completely helps avoid many of these subtle cross-language compatibility traps.")]),e._v(" "),a("h3",{attrs:{id:"additional-properties"}},[e._v("Additional Properties")]),e._v(" "),a("p",[e._v("Setting of "),a("a",{attrs:{href:"http://json-schema.org/latest/json-schema-validation.html#anchor134",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("additionalProperties")]),a("OutboundLink")],1),e._v(" to "),a("code",[e._v("false")]),e._v(" in schema objects breaks backward compatibility in those clients that use an API's JSON schemas (defined by its contract) to validate the API requests and responses. For the same reason, the schema author MUST not explicitly set the "),a("code",[e._v("additionalProperties")]),e._v(" to "),a("code",[e._v("false")]),e._v(".")]),e._v(" "),a("p",[e._v("The API implementation SHOULD instead enforce the conformance of requests and responses to an API contract by hard validating the requests and responses against the defined API contract at run-time.")]),e._v(" "),a("h2",{attrs:{id:"common-types"}},[e._v("Common Types")]),e._v(" "),a("p",[e._v("Resource representations in API MUST reuse the "),a("a",{attrs:{href:"v1/schema/json/draft-04",title:"Common Types"}},[e._v("common data type")]),e._v(" definitions where possible. Following sections provide some details about some of these common types. Please refer to the "),a("RouterLink",{attrs:{to:"/api-style-guide/v1/schema/json/draft-04/",title:"README"}},[a("code",[e._v("README")])]),e._v("and the "),a("a",{attrs:{href:"v1/schema/json/draft-04",title:"Common Types"}},[e._v("schema")]),e._v(" for more details.")],1),e._v(" "),a("h3",{attrs:{id:"address"}},[e._v("Address")]),e._v(" "),a("p",[e._v("We recommend using "),a("a",{attrs:{href:"v1/schema/json/draft-04/address_portable.json",title:"address_portable.json"}},[a("code",[e._v("address_portable.json")])]),e._v(" for all requirements related to address. The "),a("code",[e._v("address_portable.json")]),e._v(" is")]),e._v(" "),a("ul",[a("li",[e._v("backward compatible with "),a("a",{attrs:{href:"http://microformats.org/wiki/hcard",target:"_blank",rel:"noopener noreferrer"}},[e._v("hcard"),a("OutboundLink")],1),e._v(" address microformats,")]),e._v(" "),a("li",[e._v("forward compatible with Google open-source address validation metadata ("),a("a",{attrs:{href:"http://tools.ietf.org/html/draft-zyp-json-schema-03",title:"draft-03",target:"_blank",rel:"noopener noreferrer"}},[e._v("i18n-api"),a("OutboundLink")],1),e._v(") and W3 HTML5.1 "),a("a",{attrs:{href:"http://swagger.io/specification",title:"OpenAPI",target:"_blank",rel:"noopener noreferrer"}},[e._v("autofill"),a("OutboundLink")],1),e._v(" fields,")]),e._v(" "),a("li",[e._v("allows mapping to and from many address normalization services (ANS) such as "),a("a",{attrs:{href:"https://github.com/googlei18n/libaddressinput/wiki/AddressValidationMetadata",title:"i18n-api",target:"_blank",rel:"noopener noreferrer"}},[e._v("AddressDoctor"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("Please refer to "),a("a",{attrs:{href:"http://swagger.io/specification/#schemaObject",title:"OpenAPI Schema",target:"_blank",rel:"noopener noreferrer"}},[e._v("README for Address"),a("OutboundLink")],1),e._v(" for more details about the address type, guidance on how to map it to i18n-api's address and W3 HTML5.1's autofill fields.")]),e._v(" "),a("h3",{attrs:{id:"money"}},[e._v("Money")]),e._v(" "),a("p",[e._v("Money is a standard type to represent amounts. The Common Type "),a("a",{attrs:{href:"v1/schema/json/draft-04/money.json",title:"money_json"}},[a("code",[e._v("money.json")])]),e._v(" provides common definition of money.")]),e._v(" "),a("p",[a("strong",[e._v("Data-type integrity rules:")])]),e._v(" "),a("ul",[a("li",[e._v("Both "),a("code",[e._v("currency_code")]),e._v(" and "),a("code",[e._v("value")]),e._v(" MUST exist for this type to be valid.")]),e._v(" "),a("li",[e._v('Some currencies such as "JPY" do not have sub-currency, which means the decimal portion of the value should be ".0".')]),e._v(" "),a("li",[e._v("An amount MUST NOT be negative. For example a $5 bill is never negative. Negative or positive is an internal notion in association with a particular account/transaction and in respect of the type of the transaction performed.")])]),e._v(" "),a("h3",{attrs:{id:"apr"}},[e._v("Percentage, Interest rate, or APR")]),e._v(" "),a("p",[e._v("Percentages and interest rates are very common when dealing with money. One of the most common examples is annual percentage rate, or APR. These interest rates SHOULD always be represented according to the following rules:")]),e._v(" "),a("ul",[a("li",[e._v("The  Common Type "),a("a",{attrs:{href:"v1/schema/json/draft-04/percentage.json"}},[a("code",[e._v("percentage.json")])]),e._v(" MUST be used. This ensures that the rate is represented as a fixed-point decimal.\n"),a("ul",[a("li",[e._v("All validation rules defined in the type MUST be followed.")])])]),e._v(" "),a("li",[e._v("The value MUST be represented as a percentage.\n"),a("ul",[a("li",[a("strong",[e._v("Example:")]),e._v(" if the interest rate is 19.99%, the value returned by the API MUST be "),a("code",[e._v("19.99")]),e._v(".")])])]),e._v(" "),a("li",[e._v("The field's JSON schema description field SHOULD inform clients how the representation works.\n"),a("ul",[a("li",[a("strong",[e._v("Example:")]),e._v(' "The interest rate is represented as a percentage. For example, an interest rate of 19.99% would be serialized as 19.99."')])])]),e._v(" "),a("li",[e._v("It is the responsibility of the client to transform this value into a format suitable for display to the end-user. For example, some countries use the comma ( , ) as a decimal separator instead of the period ( . ). Services MUST NOT vary the format of values passed to or from a service based on end-user display concerns.")])]),e._v(" "),a("h3",{attrs:{id:"internationalization"}},[e._v("Internationalization")]),e._v(" "),a("p",[e._v("The following common types MUST be used with regard to global country, currency, language and locale.")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/country_code.json"}},[a("code",[e._v("country_code")])]),e._v(" "),a("ul",[a("li",[e._v("All APIs and services MUST use the "),a("a",{attrs:{href:"http://www.iso.org/iso/country_codes.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("ISO 3166-1 alpha-2"),a("OutboundLink")],1),e._v(" two letter country code standard.")])])]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/currency_code.json"}},[a("code",[e._v("currency_code")])]),e._v(" "),a("ul",[a("li",[e._v("Currency type MUST use the three letter currency code as defined in "),a("a",{attrs:{href:"http://www.currency-iso.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("ISO 4217"),a("OutboundLink")],1),e._v(". For quick reference on currency codes, see "),a("a",{attrs:{href:"http://en.wikipedia.org/wiki/ISO_4217",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://en.wikipedia.org/wiki/ISO_4217"),a("OutboundLink")],1),e._v(".")])])]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/language.json"}},[a("code",[e._v("language.json")])]),e._v(" "),a("ul",[a("li",[e._v("Language type uses "),a("a",{attrs:{href:"https://tools.ietf.org/html/bcp47",target:"_blank",rel:"noopener noreferrer"}},[e._v("BCP-47"),a("OutboundLink")],1),e._v(" language tag.")])])]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/locale.json"}},[a("code",[e._v("locale.json")])]),e._v(" "),a("ul",[a("li",[e._v("Locale type defines the concept of locale, which is composed of "),a("code",[e._v("country_code")]),e._v(" and "),a("code",[e._v("language")]),e._v(". Optionally, IANA timezone can be included to further define the locale.")])])]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/province.json"}},[a("code",[e._v("province.json")])]),e._v(" "),a("ul",[a("li",[e._v("Province type provides detailed definition of province or state, based on "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/ISO_3166-2",target:"_blank",rel:"noopener noreferrer"}},[e._v("ISO-3166-2"),a("OutboundLink")],1),e._v(" country subdivisions, with room for variant local, international, and abbreviated representations of province names. Useful for logistics, statistics, and building state pull-downs for on-boarding.")])])])]),e._v(" "),a("h3",{attrs:{id:"date-time"}},[e._v("Date, Time and Timezone")]),e._v(" "),a("p",[e._v("When dealing with date and time, all APIs MUST conform to the following guidelines.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("The date and time string MUST conform to the "),a("code",[e._v("date-time")]),e._v(" universal format defined in section "),a("code",[e._v("5.6")]),e._v(" of "),a("a",{attrs:{href:"https://www.ietf.org/rfc/rfc3339.txt",title:"RFC3339",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC3339"),a("OutboundLink")],1),e._v(". In use cases where you would require only a subset of the fields (e.g "),a("code",[e._v("full-date")]),e._v(" or "),a("code",[e._v("full-time")]),e._v(") from the RFC3339 "),a("code",[e._v("date-time")]),e._v(" format, you SHOULD use the "),a("a",{attrs:{href:"#date-common-types"}},[e._v("Date Time Common Types")]),e._v(" to express these.")])]),e._v(" "),a("li",[a("p",[e._v("All APIs MUST only emit "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Coordinated_Universal_Time",target:"_blank",rel:"noopener noreferrer"}},[e._v("UTC"),a("OutboundLink")],1),e._v(" time (aka "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/List_of_military_time_zones",target:"_blank",rel:"noopener noreferrer"}},[e._v("Zulu time"),a("OutboundLink")],1),e._v(" or "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Greenwich_Mean_Time",target:"_blank",rel:"noopener noreferrer"}},[e._v("GMT"),a("OutboundLink")],1),e._v(") in the responses.")])]),e._v(" "),a("li",[a("p",[e._v("When processing requests, an API SHOULD accept "),a("code",[e._v("date-time")]),e._v(" or time fields that contain an offset from UTC. For example, "),a("code",[e._v("2016-09-28T18:30:41.000+05:00")]),e._v(" SHOULD be accepted as equivalent to "),a("code",[e._v("2016-09-28T13:30:41.000Z")]),e._v(". This helps ensure compatibility with third parties who may not be capable of normalizing values to UTC before sending requests. In such cases the offset SHOULD only be used to calculate the equivalent UTC time before it is persisted in the system (because of known platform/language/DB interoperability issues). A UTC offset MUST NOT be used to derive anything else.")])]),e._v(" "),a("li",[a("p",[e._v("If the business logic requires expressing the timezone of an event, it is RECOMMENDED that you capture the timezone explicitly by using a separate request/response field. You SHOULD NOT use offset to derive the timezone information. The offset alone is insufficient to accurately transform the stored UTC time back to a local time later. The reason is that a UTC offset might be same for many geographical regions and based on the time of the year there may be additional factors such as daylight savings. For example, an offset UTC-05:00 represents Eastern Standard Time during winter, Central Dayight Time during summer, and year-round offset for Panama, Columbia, and Peru.")])]),e._v(" "),a("li",[a("p",[e._v("The timezone string MUST be per "),a("a",{attrs:{href:"https://www.iana.org/time-zones",target:"_blank",rel:"noopener noreferrer"}},[e._v("IANA timezone database"),a("OutboundLink")],1),e._v(" (aka "),a("strong",[e._v("Olson")]),e._v(" database or "),a("strong",[e._v("tzdata")]),e._v(" or "),a("strong",[e._v("zoneinfo")]),e._v(" database), for example "),a("em",[e._v("America/Los_Angeles")]),e._v(" for Pacific Time, or "),a("em",[e._v("Europe/Berlin")]),e._v(" for Central European Time.")])]),e._v(" "),a("li",[a("p",[e._v("When expressing "),a("a",{attrs:{href:"https://www.w3.org/International/wiki/FloatingTime",target:"_blank",rel:"noopener noreferrer"}},[e._v("floating"),a("OutboundLink")],1),e._v(" time values that are not tied to specific time zones such as user's date of birth, expiry date, publication date etc. in requests or responses, an API SHOULD NOT associate it with a timezone. The reason is that a UTC offset changes the meaning of a floating time value. For examples, all countries with timezones west of prime meridian would consider a floating time value to be the previous day.")])])]),e._v(" "),a("h4",{attrs:{id:"date-common-types"}},[e._v("Date Time Common Types")]),e._v(" "),a("p",[e._v("The following common types MUST be used to express various date-time formats:")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/date_time.json"}},[a("code",[e._v("date_time.json")])]),e._v(" SHOULD be used to express an RFC3339 "),a("code",[e._v("date-time")]),e._v(".")]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/date_no_time.json"}},[a("code",[e._v("date_no_time.json")])]),e._v(" SHOULD be used to express "),a("code",[e._v("full-date")]),e._v(" from RFC 3339.")]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/time_nodate.json"}},[a("code",[e._v("time_nodate.json")])]),e._v(" SHOULD be used to express "),a("code",[e._v("full-time")]),e._v(" from RFC3339.")]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/date_year_month.json"}},[a("code",[e._v("date_year_month.json")])]),e._v(" SHOULD be used to express a floating date that contains only the "),a("strong",[e._v("month")]),e._v(" and "),a("strong",[e._v("year")]),e._v(". For example, card expiry date ("),a("code",[e._v("2016-09")]),e._v(").")]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/time_zone.json"}},[a("code",[e._v("time_zone.json")])]),e._v(" SHOULD be used for expressing timezone of a RFC3339 "),a("code",[e._v("date-time")]),e._v(" or a "),a("code",[e._v("full-time")]),e._v(" field.")])]),e._v(" "),a("h1",{attrs:{id:"error-handling"}},[e._v("Error Handling")]),e._v(" "),a("p",[e._v("As per HTTP specifications, the outcome of a request execution could be specifiedusing an integer and a message. The number is known as the "),a("em",[e._v("status code")]),e._v(" and the message as the "),a("em",[e._v("reason phrase")]),e._v(". The reason phrase is a human readable message used to clarify the outcome of the response. The HTTP status codes in the "),a("code",[e._v("4xx")]),e._v(" range indicate client-side errors (validation or logic errors), while those in the "),a("code",[e._v("5xx")]),e._v(" range indicate server-side errors (usually defect or outage). However, these status codes and human readable reason phrase are not sufficient to convey enough information about an error in a machine-readable manner. To resolve an error, non-human consumers of RESTful APIs need additional help.")]),e._v(" "),a("p",[e._v("Therefore, APIs MUST return a JSON error representation that conforms to the "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json")])]),e._v(" schema defined in the "),a("a",{attrs:{href:"v1/schema/json/draft-04",title:"Common Types"}},[e._v("Common Types")]),e._v(" repository. It is recommended that the namespace that an API belongs to has an error catalog associated with it. Please refer to "),a("a",{attrs:{href:"#error-catalog"}},[e._v("Error Catalog")]),e._v(" for more details.")]),e._v(" "),a("h2",{attrs:{id:"error-schema"}},[e._v("Error Schema")]),e._v(" "),a("p",[e._v("An error response following "),a("code",[e._v("error.json")]),e._v(" as schema MUST include the following fields:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("name")]),e._v(": A human-readable, unique name for the error. It is recommended that this value would be retrieved from the error catalog "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec.json",title:"error_spec.json"}},[a("code",[e._v("error_spec.json#name")])]),e._v(" before sending the error response.")]),e._v(" "),a("li",[a("code",[e._v("details")]),e._v(": An array that contains individual instance(s) of the error with specifics such as the following. This field is required for client side errors ("),a("code",[e._v("4xx")]),e._v(").\n"),a("ul",[a("li",[a("code",[e._v("field")]),e._v(": "),a("a",{attrs:{href:"http://tools.ietf.org/html/rfc6901",title:"JavaScript Object Notation (JSON) Pointer",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON Pointer"),a("OutboundLink")],1),e._v(" to the field in error if in body, else name of the path parameter or query parameter.")]),e._v(" "),a("li",[a("code",[e._v("value")]),e._v(": Value of the field in error.")]),e._v(" "),a("li",[a("code",[e._v("issue")]),e._v(": Reason for error. It is recommended that this value would be retrieved from the error catalog "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec_issue.json",title:"error_spec_issue.json"}},[a("code",[e._v("error_spec_issue.json#issue")])]),e._v(" before sending the error response.")]),e._v(" "),a("li",[a("code",[e._v("location")]),e._v(": The location of the field in the error, either "),a("code",[e._v("query")]),e._v(", "),a("code",[e._v("path")]),e._v(", or "),a("code",[e._v("body")]),e._v(". If this field is not present, the default value is "),a("code",[e._v("body")]),e._v(".")])])]),e._v(" "),a("li",[a("code",[e._v("debug_id")]),e._v(": A unique error identifier generated on the server-side and logged for correlation purposes.")]),e._v(" "),a("li",[a("code",[e._v("message")]),e._v(": A human-readable message, describing the error. This message MUST be a description of the problem NOT a suggestion about how to fix it. It is recommended that this value would be retrieved from the error catalog "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec.json",title:"error_spec.json"}},[a("code",[e._v("error_spec.json#message")])]),e._v(" before sending the error response.")]),e._v(" "),a("li",[a("code",[e._v("links")]),e._v(": "),a("RouterLink",{attrs:{to:"/api-style-guide/hypermedia.html"}},[e._v("HATEOAS")]),e._v(" links specific to an error scenario. Use these links to provide more information about the error scenario and how to resolve it. You could insert links from "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec.json",title:"error_spec.json"}},[a("code",[e._v("error_spec.json#suggested_application_actions")])]),e._v(" and/or "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec.json",title:"error_spec.json"}},[a("code",[e._v("error_spec.json#suggested_user_actions")])]),e._v(" here as well as other HATEOAS links relevant to the API.")],1)]),e._v(" "),a("p",[e._v("The following fields are optional:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("information_link")]),e._v(": ("),a("code",[e._v("deprecated")]),e._v(") A URI for expanded developer information related to this error; this SHOULD be a link to the publicly available documentation for the type of error. Use "),a("code",[e._v("links")]),e._v(" instead.")])]),e._v(" "),a("h5",{attrs:{id:"use-of-json-pointer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-of-json-pointer"}},[e._v("#")]),e._v(" Use of JSON Pointer")]),e._v(" "),a("p",[e._v("If you have used some other means to identify the "),a("code",[e._v("field")]),e._v(" in an already released API, you could continue using your existing approach. However, if you plan to migrate to the approach suggested, you would want to bump up the major version of your API and provide migration assistance to your clients as this could be a potential breaking change for them.")]),e._v(" "),a("p",[e._v("The JSON Pointer for the "),a("code",[e._v("field")]),e._v(" SHOULD be a "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6901#section-5",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON string value"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"input-errors"}},[e._v("Input Validation Errors")]),e._v(" "),a("p",[e._v("In validating requests, there are a variety of concerns that should be addressed in the following order:")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Request Validation Issue")]),e._v(" "),a("th",[e._v("HTTP status code")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Not well-formed JSON.")]),e._v(" "),a("td",[a("code",[e._v("400 Bad Request")])])]),e._v(" "),a("tr",[a("td",[e._v("Contains validation errors that the client can change.")]),e._v(" "),a("td",[a("code",[e._v("400 Bad Request")])])]),e._v(" "),a("tr",[a("td",[e._v("Cannot be executed due to factors outside of the request body. The request was well-formed but was unable to be followed due to semantic errors.")]),e._v(" "),a("td",[a("code",[e._v("422 Unprocessable Entity")])])])])]),e._v(" "),a("h2",{attrs:{id:"error-samples"}},[e._v("Error Samples")]),e._v(" "),a("p",[e._v("This section provides some samples to describe usage of "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json")])]),e._v(" in various scenarios.")]),e._v(" "),a("h4",{attrs:{id:"sampleresponse-invalid"}},[e._v("Validation Error Response - Single Field")]),e._v(" "),a("p",[e._v("The following sample shows a validation error of type "),a("code",[e._v("VALIDATION_ERROR")]),e._v(" in one field. Because this is a client error, a "),a("code",[e._v("400 Bad Request")]),e._v(" HTTP status code should be returned.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\n{  \n   "name":"VALIDATION_ERROR",\n   "details":[  \n      {  \n         "field":"#/credit_card/expire_month",\n         "issue":"Required field is missing",\n         "location":"body"\n      }\n   ],\n   "debug_id":"123456789",\n   "message":"Invalid data provided",\n   "information_link":"http://developer.foo.com/apidoc/blah#VALIDATION_ERROR"\n}\n')])])]),a("h4",{attrs:{id:"sampleresponse-multi"}},[e._v("Validation Error Response - Multiple Fields")]),e._v(" "),a("p",[e._v("The following sample shows a validation error of the same  type, "),a("code",[e._v("VALIDATION_ERROR")]),e._v(", in two fields. Note that "),a("code",[e._v("details")]),e._v(" is an array listing all the instances in the error. Because both these are a client errors, a "),a("code",[e._v("400 Bad Request")]),e._v(" HTTP status code should be returned.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\n{  \n   "name": "VALIDATION_ERROR",\n   "details": [  \n      {  \n         "field": "/credit_card/expire_month",\n         "issue": "Required field is missing",\n         "location": "body"\n      },\n      {  \n         "field": "/credit_card/currency",\n         "value": "XYZ",\n         "issue": "Currency code is invalid",\n         "location": "body"\n      }\n   ],\n   "debug_id": "123456789",\n   "message": "Invalid data provided",\n   "information_link": "http://developer.foo.com/apidoc/blah#VALIDATION_ERROR"\n}\n\n')])])]),a("h4",{attrs:{id:"sampleresponse-bulk"}},[e._v("Validation Error Response - Bulk ")]),e._v(" "),a("p",[e._v("For heterogenous types of client-side errors shown below, "),a("code",[e._v("OBJECT_NOT_FOUND_ERROR")]),e._v(" and "),a("code",[e._v("MULTIPLE_CORE_BUNDLES")]),e._v(", an array named "),a("code",[e._v("errors")]),e._v(" is returned. Each error instance is represented as an item in this array. Because these are client validation errors, a "),a("code",[e._v("400 Bad Request")]),e._v(" HTTP status code should be returned.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(' \n   "errors": [  \n      {  \n         "name": "OBJECT_NOT_FOUND_ERROR",\n         "debug_id": "38cdd677a83a4",\n         "message": "Bundle is not found.",\n         "information_link": "<link to public doc describing OBJECT_NOT_FOUND_ERROR error>",\n         "details": [  \n            {  \n               "field": "/bundles/0/bundle_id",\n               "value": "33333",\n               "issue": "BUNDLE_NOT_FOUND",\n               "location": "body"\n            }\n         ]\n      },\n      {  \n         "name": "MULTIPLE_CORE_BUNDLES",\n         "debug_id": "52cde38284sd3",\n         "message": "Multiple CORE bundles.",\n         "information_link": "<link to public doc describing MULTIPLE_CORE_BUNDLES error>",\n         "details": [  \n            {  \n               "field": "/bundles/5/bundle_id",\n               "value": "88888",\n               "issue": "MULTIPLE_CORE_BUNDLES",\n               "location": "body"\n            }\n         ]\n      }\n   ]\n')])])]),a("h4",{attrs:{id:"sampleresponse-422"}},[e._v("Semantic Validation Error Response ")]),e._v(" "),a("p",[e._v("In cases where client input is well-formed and valid but the request action may require interaction with APIs or processes outside of this URI, an HTTP status code "),a("code",[e._v("422 Unprocessable Entity")]),e._v(" should be returned.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{  \n   "name": "BALANCE_ERROR",\n   "debug_id": "123456789",\n   "message": "The account balance is too low. Add balance to your account to proceed.",\n   "information_link": "http://developer.foo.com/apidoc/blah#BALANCE_ERROR"\n}\n')])])]),a("h2",{attrs:{id:"error-declaration"}},[e._v("Error Declaration In API Specification")]),e._v(" "),a("p",[e._v("It is important that documentation generation tools and client/server-side binding generation tools recognize "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json")])]),e._v(". Following section shows how you could refer "),a("code",[e._v("error.json")]),e._v(" in an API specification confirming to OpenAPI.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"responses": {\n          "200": {\n            "description": "Address successfully found and returned.",\n            "schema": {\n              "$ref": "address.json"\n            }\n          },\n          "403": {\n            "description": "Unauthorized request.  This error will occur if the SecurityContext header is not provided or does not include a party_id."\n          },\n          "404": {\n            "description": "The requested address does not exist.",\n            "schema": {\n              "$ref": "v1/schema/json/draft-04/error.json"\n            }\n          },\n          "default": {\n            "description": "Unexpected error response.",\n            "schema": {\n              "$ref": "v1/schema/json/draft-04/error.json"\n            }\n          }\n        }\n   \n')])])]),a("h2",{attrs:{id:"userguide-errors"}},[e._v("Samples with Error Scenarios in Documentation")]),e._v(" "),a("p",[e._v("The User Guide of an API is a document that is exposed to API consumers. In addition to linking to samples showing successful execution for invocation on various methods exposed by the API, the API developer should also provide links to samples showing error scenarios. It is equally, or perhaps more, important to show the API consumers how an API would propagate errors in a machine-readable form in order to build applications that take necessary actions to handle errors gracefully and in a meaningful manner.")]),e._v(" "),a("p",[e._v("In conclusion, we reiterate the message we started with that non-human consumers of RESTful APIs need more help to take necessary actions to resolve an error in a machine-readable manner. Therefore, a representation of errors following the "),a("a",{attrs:{href:"#error-schema"}},[e._v("schema")]),e._v(" described here MUST be returned by APIs for any HTTP status code that falls into the ranges of 4xx and 5xx.")]),e._v(" "),a("h2",{attrs:{id:"error-catalog"}},[e._v("Error Catalog")]),e._v(" "),a("p",[e._v("Error handling "),a("a",{attrs:{href:"#error-handling"}},[e._v("guidelines")]),e._v(" described earlier show how to provide error related details responses at runtime. This section explains how to catalog the errors so they can be easily consumed in service runtime and for generating documentation.")]),e._v(" "),a("p",[e._v("An Error Catalog is a single JSON file that contains a collection of error specifications (or error metadata) for a namespace. Each error specification includes error name, error message, issue details and related links among other things. The error catalog supports multiple locales or languages. For a specific error catalog, there should be exactly one default version, known as the top-level catalog, which could be in English for example. There should be corresponding locale-specific catalogs, one for each additional supported locale, as needed.")]),e._v(" "),a("h3",{attrs:{id:"reasons-to-catalog-errors"}},[e._v("Reasons To Catalog Errors")]),e._v(" "),a("p",[e._v("Following are some reasons to catalog the errors for an API:")]),e._v(" "),a("ol",[a("li",[e._v("To "),a("em",[e._v("externalize")]),e._v(' hard-coded error message strings from the API implementation: Developers are good at writing code but not necessarily good at writing error messages. Often error messages written by a developer make a lot of assumptions about the context and audience. It is hard to change such error messages if these are embedded in implementation code. For example, to change a message from "Add Card refused due to compliance guidelines" to '),a("code",[e._v("Could not add card due to failure to comply with guideline %s")]),e._v(", a service developer has to make the change and also redeploy the service emitting that error.")]),e._v(" "),a("li",[e._v("To "),a("em",[e._v("localize")]),e._v(" the error strings: If error related strings such as "),a("code",[e._v("message")]),e._v(", "),a("code",[e._v("issue")]),e._v(", "),a("code",[e._v("actions")]),e._v(", among other things in "),a("code",[e._v("error.json")]),e._v(" are externalized, it is easy for the documentation and an internationalization team to modify and localize these without any help from service developers and without requiring redeployment of the services.")]),e._v(" "),a("li",[e._v("To keep service's implementation and the API documentation in "),a("em",[e._v("sync")]),e._v(" with regards to errors: API consumers should be able to refer with confidencethe API's documentation for errors generated by the services at runtime. This helps to reduce the cost and the time spent supporting an API and increases "),a("code",[e._v("adoptability")]),e._v(" of the API.")])]),e._v(" "),a("h3",{attrs:{id:"error-catalog-schema"}},[e._v("Error Catalog Schema")]),e._v(" "),a("p",[e._v("There are four main JSON schema files for the Error Catalog.")]),e._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/error_catalog.json",title:"error_catalog.json"}},[a("code",[e._v("error_catalog.json")])]),e._v(" defines top-level catalog container.\n"),a("ul",[a("li",[a("code",[e._v("namespace")]),e._v(": API namespace")]),e._v(" "),a("li",[a("code",[e._v("language")]),e._v(": language used to catalog the errors. Default is US English. This value MUST be a "),a("a",{attrs:{href:"https://tools.ietf.org/html/bcp47",target:"_blank",rel:"noopener noreferrer"}},[e._v("BCP-47"),a("OutboundLink")],1),e._v(" language tag as in "),a("code",[e._v("en")]),e._v(" or "),a("code",[e._v("en-US")]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("errors")]),e._v(": one or more error catalog items.")])])]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/error_catalog_item.json",title:"error_catalog_item.json"}},[a("code",[e._v("error_catalog_item.json")])]),e._v(" defines an item in error catalog. This schema in its initial version only includes error specification "),a("code",[e._v("error_spec")]),e._v(". In future versions, it would provide a space to establish relationship between an error specification and method specifications that would use the error specification to respond with error.")]),e._v(" "),a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec.json",title:"error_spec.json"}},[a("code",[e._v("error_spec.json")])]),e._v(" is where the core of error specification is defined. The specification includes the following properties.\n"),a("ul",[a("li",[a("code",[e._v("name")]),e._v(": A human-readable, unique name for the error. This value MUST be the value set in "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json#name")])]),e._v(" before sending the error response.")]),e._v(" "),a("li",[a("code",[e._v("message")]),e._v(": A human-readable message, describing the error. This message MUST be a description of the problem NOT a suggestion about how to fix it. This value MUST be the value set in "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json#message")])]),e._v(" before sending the error response. This value could be localized.")]),e._v(" "),a("li",[a("code",[e._v("log_level")]),e._v(": Log level associated with this error. This MUST NOT be streamed out in error responses or exposed in any external documentation.")]),e._v(" "),a("li",[a("code",[e._v("legacy_code")]),e._v(": Legacy error code. Use if and only if the existing and published error metadata uses the code and it must continue to be supported. Utilize "),a("code",[e._v("additionalProperties")]),e._v(" of "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json")])]),e._v(" to send this code in the error response.")]),e._v(" "),a("li",[a("code",[e._v("http_status_codes")]),e._v(": Applicable HTTP status codes for this error.")]),e._v(" "),a("li",[a("code",[e._v("suggested_application_actions")]),e._v(": Suggest practical actions that the developer of application consuming the API could take in order to resolve the error condition. These MUST be in English.")]),e._v(" "),a("li",[a("code",[e._v("suggested_user_actions")]),e._v(": Suggest practical actions that a user of the application consuming the API could take in order to resolve the error condition. These MUST be in the language used "),a("code",[e._v("error_catalog.json#language")]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("links")]),e._v(": Error context specific "),a("a",{attrs:{href:"#hypermedia"}},[e._v("HATEOAS")]),e._v(" links. Corresponds to "),a("a",{attrs:{href:"v1/schema/json/draft-04/error.json",title:"error.json"}},[a("code",[e._v("error.json#links")])]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("issues")]),e._v(": Issues associated with this error as defined in "),a("code",[e._v("error_spec_issue.json")]),e._v(". Each issue corresponds to an item in "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_details.json",title:"error_details.json"}},[a("code",[e._v("error_details.json")])]),e._v(".")])])])]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"v1/schema/json/draft-04/error_spec_issue.json",title:"error_spec_issue.json"}},[a("code",[e._v("error_spec_issue.json")])]),e._v(" defines details related to the error. For example, there could be multiple validation errors triggering "),a("code",[e._v("400 BAD REQUEST")]),e._v(". Each invalid field MUST be listed in the "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_details.json",title:"error_details.json"}},[a("code",[e._v("error_details.json")])]),e._v(" while sending the error response.\n"),a("ul",[a("li",[a("code",[e._v("id")]),e._v(": Catalog-unique identifier of the issue. This is required in order to search for the "),a("code",[e._v("error_spec_issue")]),e._v(" from cached error catalog.")]),e._v(" "),a("li",[a("code",[e._v("issue")]),e._v(": Reason for error. This value MUST be the value set in "),a("a",{attrs:{href:"v1/schema/json/draft-04/error_details.json",title:"error_details.json"}},[a("code",[e._v("error_details.json#issue")])]),e._v(". The issue string could have variables. Please use parametrized string following the Java String Formatter syntax. This value chould be localized.")])])])]),e._v(" "),a("h3",{attrs:{id:"string-format"}},[e._v("String Format")]),e._v(" "),a("p",[e._v("For API services that are implemented in Java, various strings found in the error catalog MUST be formatted using Java's "),a("code",[e._v("printf-style")]),e._v(" inspired format. It's recommended to use Java's "),a("a",{attrs:{href:"https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#summary",target:"_blank",rel:"noopener noreferrer"}},[e._v("format specification"),a("OutboundLink")],1),e._v(" for values of "),a("code",[e._v("message")]),e._v(" and "),a("code",[e._v("issue")]),e._v(" fields in the error catalog where applicable.")]),e._v(" "),a("p",[e._v("Service developers are strongly encouraged to use tools, such as "),a("a",{attrs:{href:"https://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java String Formatter"),a("OutboundLink")],1),e._v(" or similar, to interpret the formatted strings as found in the error catalog.")]),e._v(" "),a("p",[e._v("For example, an "),a("code",[e._v("error_spec")]),e._v(" having value "),a("code",[e._v("Could not add card due to failure to comply with guideline %s")]),e._v(" for "),a("code",[e._v("message")]),e._v(" must be interpreted using a formatter as shown below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('com.foo.platform.error.ErrorSpec errorSpec = <find errorSpec from catalog>\n\ncom.foo.platform.error.Error error = new Error();\nerror.setName(errorSpec.getName());\nerror.setDebugId("debugId-777");\nerror.setLogLevel(errorSpec.getLogLevel());\nString errorMessageString = String.format(errorSpec.getMessage(), "GUIDELINE: XYZ");\nerror.setMessage(errorMessageString);\n\nList<Detail> details = new ArrayList<>();\nDetail detail = new Detail();\nString issueString = String.format(errorSpec.getIssues().get(0).getIssue(), ... <variables in issue string>);\ndetail.setIssue(issueString);\ndetails.add(detail);\nerror.setDetails(details);\n\nResponse response = Response.status(Response.Status.BAD_REQUEST).entity(error).encoding(MediaType.APPLICATION_JSON).build();\nthrow new WebApplicationException(response);\n')])])]),a("p",[e._v("The above example code is for illustration purposes only.")]),e._v(" "),a("h3",{attrs:{id:"samples"}},[e._v("Samples")]),e._v(" "),a("p",[e._v("This section provides some sample error catalogs.")]),e._v(" "),a("h4",{attrs:{id:"sample-catalog-namespace-payments"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-catalog-namespace-payments"}},[e._v("#")]),e._v(" Sample catalog : namespace : payments")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n\t"namespace": "payments",\n\t"language": "en-US",\n\t"errors": [{\n\t\t"error_spec": {\n\t\t\t"name": "VALIDATION_ERROR",\n\t\t\t"message": "Invalid request - see details",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t400\n\t\t\t],\n\t\t\t"issues": [{\n\t\t\t\t"id": "InvalidCreditCardType",\n\t\t\t\t"issue": "Value is invalid (must be visa, mastercard, amex, or discover)"\n\t\t\t}],\n\t\t\t"suggested_application_actions": [\n\t\t\t\t"Provide an acceptable card type and resend the request."\n\t\t\t]\n\t\t}\n\t}, {\n\t\t"error_spec": {\n\t\t\t"name": "PAYEE_ACCOUNT_LOCKED_OR_CLOSED",\n\t\t\t"message": "Payee account is locked or closed",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t422\n\t\t\t],\n\t\t\t"legacy_code": "PAYER_ACCOUNT_LOCKED_OR_CLOSED",\n\t\t\t"issues": [{\n\t\t\t\t"id": "PayerAccountLocked",\n\t\t\t\t"issue": "The account receiving this payment is locked or closed and cannot receive payments."\n\t\t\t}],\n\t\t\t"suggested_user_actions": [\n\t\t\t\t"Contact Customer Service at contact@foo.com"\n\t\t\t]\n\t\t}\n\t}]\n}\n')])])]),a("h4",{attrs:{id:"sample-catalog-namespace-wallet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-catalog-namespace-wallet"}},[e._v("#")]),e._v(" Sample catalog : namespace : wallet")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n\t"namespace": "wallet",\n\t"language": "en-US",\n\t"errors": [{\n\t\t"error_spec": {\n\t\t\t"name": "INVALID_ISSUER_DETAILS",\n\t\t\t"message": "Invalid issuer details",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t400\n\t\t\t],\n\t\t\t"issues": [{\n\t\t\t\t"id": "ISSUER_DATA_NOT_FOUND",\n\t\t\t\t"issue": "Issuer data not found"\n\t\t\t}],\n\t\t\t"suggested_application_actions": [\n\t\t\t\t"Provide issuer related data and resend the request."\n\t\t\t]\n\t\t}\n\t}, {\n\t\t"error_spec": {\n\t\t\t"name": "INSTRUMENT_BLOCKED",\n\t\t\t"message": "Instrument is currently blocked.",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t422\n\t\t\t],\n\t\t\t"issues": [{\n\t\t\t\t"id": "BankAccountBlocked",\n\t\t\t\t"issue": "Bank account is blocked due max random deposit retries. "\n\t\t\t}],\n\t\t\t"suggested_user_actions": [\n\t\t\t\t"Contact Customer Service at contact@foo.com."\n\t\t\t]\n\t\t}\n\t}]\n}\n')])])]),a("h4",{attrs:{id:"sample-catalog-namespace-payment-networks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-catalog-namespace-payment-networks"}},[e._v("#")]),e._v(" Sample catalog : namespace : payment-networks")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n\t"namespace": "payment-networks",\n\t"language": "en-US",\n\t"errors": [{\n\t\t"error_spec": {\n\t\t\t"name": "VENDOR_TIMEOUT",\n\t\t\t"message": "Transaction timed out while waiting for response from downstream service provided by a 3rd party vendor.",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t504\n\t\t\t],\n\t\t\t"suggested_application_actions": [\n\t\t\t\t"Retry again later."\n\t\t\t]\n\t\t}\n\t}, {\n\t\t"error_spec": {\n\t\t\t"name": "INTERNAL_TIMEOUT",\n\t\t\t"message": "Internal error due to timeout. Request took too long to process. The status of the transaction is unknown.",\n\t\t\t"log_level": "ERROR",\n\t\t\t"http_status_codes": [\n\t\t\t\t500\n\t\t\t],\n\t\t\t"suggested_application_actions": [\n\t\t\t\t"Contact Customer Service at contact@foo.com and provide Correlation-Id and debug_id for diagnosis along with other details."\n\t\t\t]\n\t\t}\n\t}]\n}\n')])])]),a("h1",{attrs:{id:"api-versioning"}},[e._v("API Versioning")]),e._v(" "),a("p",[e._v("This section describes how to version APIs. It describes API's lifecycle states, enumerates versioning policy, describes backwards compatiblity related guidelines and describes an End-Of-Life policy.")]),e._v(" "),a("h2",{attrs:{id:"api-lifecycle"}},[e._v("API Lifecycle")]),e._v(" "),a("p",[e._v("Following is an example of states of an API's lifecycle.")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("State")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("PLANNED")]),e._v(" "),a("td",[e._v("API has been scheduled for development. API release plans have been established.")])]),e._v(" "),a("tr",[a("td",[e._v("BETA")]),e._v(" "),a("td",[e._v("API is operational and is available to selected new subscribers in production for the purposes of testing, validating, and rolling out a new API.")])]),e._v(" "),a("tr",[a("td",[e._v("LIVE")]),e._v(" "),a("td",[e._v("API is operational and is available to new subscribers in production. API version is fully supported.")])]),e._v(" "),a("tr",[a("td",[e._v("DEPRECATED")]),e._v(" "),a("td",[e._v("API is operational and available at runtime to existing subscribers. API version is fully supported, including bug fixes addressed in backwards compatible way. API version is not available to new subscribers.")])]),e._v(" "),a("tr",[a("td",[e._v("RETIRED")]),e._v(" "),a("td",[e._v("API is unpublished from production and no longer available at runtime to any subscribers. The footprint of all deployed applications entering this state must be completely removed from production and stage environments.")])])])]),e._v(" "),a("h2",{attrs:{id:"api-versioning-policy"}},[e._v("API Versioning Policy")]),e._v(" "),a("p",[e._v("API’s are versioned products and MUST adhere to the following versioning principles.")]),e._v(" "),a("ol",[a("li",[e._v("API specifications MUST follow the versioning scheme where where the "),a("code",[e._v("v")]),e._v(" introduces the version, the major is an ordinal starting with "),a("code",[e._v("1")]),e._v(" for the first LIVE release, and minor is an ordinal starting with "),a("code",[e._v("0")]),e._v(" for the first minor release of any major release.")]),e._v(" "),a("li",[e._v("Every time there is an incremental change to an API, whether or not backward compatible, the API specification MUST be versioned. This allows the change to be labeled, documented, reviewed, discussed, published and communicated.")]),e._v(" "),a("li",[e._v("API endpoints MUST only reflect the major version.")]),e._v(" "),a("li",[e._v("API specification versions reflect interface changes and MAY be separate from service implementation versioning schemes.")]),e._v(" "),a("li",[e._v("A minor API version MUST maintain backward compatibility with all previous minor versions, within the same major version.")]),e._v(" "),a("li",[e._v("A major API version MAY maintain backward compatibility with a previous major version.")])]),e._v(" "),a("p",[e._v("For a given functionality set, there MUST be only one API version in the "),a("code",[e._v("LIVE")]),e._v(" state at any given time across all major and minor versions. This ensures that subscribers always understand which versioned API product they should be using. For example, v1.2 "),a("code",[e._v("RETIRED")]),e._v(", v1.3 "),a("code",[e._v("DEPRECATED")]),e._v(", or v2.0 "),a("code",[e._v("LIVE")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"backwards-compatibility"}},[e._v("Backwards Compatibility")]),e._v(" "),a("p",[e._v("APIs SHOULD be designed in a forward and extensible way to maintain compatibility and avoid duplication of resources, functionality and excessive versioning.")]),e._v(" "),a("p",[e._v("APIs MUST adhere to the following principles to be considered backwards compatible:")]),e._v(" "),a("ol",[a("li",[e._v("All changes MUST be additive.")]),e._v(" "),a("li",[e._v("All changes MUST be optional.")]),e._v(" "),a("li",[e._v("Semantics MUST NOT change.")]),e._v(" "),a("li",[e._v("Query-parameters and request body parameters MUST be unordered.")]),e._v(" "),a("li",[e._v("Additional functionality for an existing resource MUST be implemented either:\n"),a("ol",[a("li",[e._v("As an optional extension, or")]),e._v(" "),a("li",[e._v("As an operation on a new child resource, or")]),e._v(" "),a("li",[e._v("By altering a request body, while still accepting all the previous, existing request variations, if an existing operation (e.g., resource creation) cannot be reasonably extended.")])])])]),e._v(" "),a("h3",{attrs:{id:"backwards-incompatible-changes"}},[e._v("Non-exhaustive List of Backwards Incompatible Changes")]),e._v(" "),a("p",[a("b",[e._v("URIs")])]),e._v(" "),a("ol",[a("li",[e._v("A resource URI MAY support additional query parameters but they CANNOT be mandatory.")]),e._v(" "),a("li",[e._v("There MUST NOT be any change in the behavior of the API for request URIs without the newly added query parameters.")]),e._v(" "),a("li",[e._v("A new parameter with a required constraint SHALL NOT be added to a request.")]),e._v(" "),a("li",[e._v("The semantics of an existing parameter, entire representation, or resource SHOULD NOT be changed.")]),e._v(" "),a("li",[e._v("A service MUST recognize a previously valid value for a parameter and SHOULD NOT throw an error when used.")]),e._v(" "),a("li",[e._v("There MUST NOT be any change in the HTTP status codes returned by the URIs.")]),e._v(" "),a("li",[e._v("There MUST NOT be any change in the HTTP verbs (e.g. "),a("code",[e._v("GET")]),e._v(", "),a("code",[e._v("POST")]),e._v(", "),a("code",[e._v("PUT")]),e._v(" or "),a("code",[e._v("PATCH")]),e._v(") supported earlier by the URI. The URI MAY however support a new HTTP verb.")]),e._v(" "),a("li",[e._v("There MUST NOT be any change in the name and type of the request or response headers of an URI. Additional headers MAY be added, provided they’re optional.")])]),e._v(" "),a("p",[a("b",[e._v("APIs only support media type "),a("code",[e._v("application/json")]),e._v(". The following applies for JSON representation stability.")])]),e._v(" "),a("ol",[a("li",[e._v("An existing property in a JSON object of an API response MUST continue to be returned with same name and JSON type (number, integer, string, array, object).")]),e._v(" "),a("li",[e._v("If the value of a response field is an array, then the type of the contents in the array MUST NOT change.")]),e._v(" "),a("li",[e._v("If the value of the response field is an object, then the compatibility policy MUST apply to the JSON object as a whole.")]),e._v(" "),a("li",[e._v("New properties MAY be added to a representation any time, but it SHOULD NOT alter the meaning of an existing property.")]),e._v(" "),a("li",[e._v("New properties that are added MUST NOT be mandatory.")]),e._v(" "),a("li",[e._v("Mandatory fields are guaranteed to be present in the response.")]),e._v(" "),a("li",[e._v("For primitive types, unless there is a constraint described in the API documentation (e.g. length of the string, possible values for an ENUM type), clients MUST not assume that the values are constrained in any way.")]),e._v(" "),a("li",[e._v("If the property of an object is a URI, then it MUST have the same stability mentioned as URIs.")]),e._v(" "),a("li",[e._v("For an API returning HATEOAS links as part of the representation, the values of rel and href MUST remain the same.")]),e._v(" "),a("li",[e._v("For ENUM types, there MUST NOT be any change in already supported enumerated values or meaning of these values.")])]),e._v(" "),a("h2",{attrs:{id:"eol-policy"}},[e._v("End of Life Policy")]),e._v(" "),a("p",[e._v("The End-of-Life (EOL) policy regulates how API versions move from the "),a("code",[e._v("LIVE")]),e._v(" to the "),a("code",[e._v("RETIRED")]),e._v(" state. It is designed to ensure a consistent and reasonable transition period for API customers who need to migrate from the old to the new API version while enabling a healthy process to retire technical debt.")]),e._v(" "),a("p",[a("b",[e._v("Minor API Version EOL")])]),e._v(" "),a("p",[e._v("Per versioning policy, minor API versions MUST be backwards compatible with preceding minor versions within the same major version. Thus, minor API versions are "),a("code",[e._v("RETIRED")]),e._v(" immediately after a newer minor version of the same major version becomes "),a("code",[e._v("LIVE")]),e._v(". This change should have no impact on existing subscribers so there is no need to transition through a "),a("code",[e._v("DEPRECATED")]),e._v(" state to facilitate client migration.")]),e._v(" "),a("p",[a("b",[e._v("Major API Version EOL")])]),e._v(" "),a("p",[e._v("Per versioning policy, major API versions MAY be backwards compatible with preceding major versions. As such, the following rules apply when retiring a major API version.")]),e._v(" "),a("ol",[a("li",[e._v("A major API version MUST NOT be in the "),a("code",[e._v("DEPRECATED")]),e._v(" state until a replacement service is "),a("code",[e._v("LIVE")]),e._v(" that provides a clear customer migration path for all functionality that will be retained moving forward. This SHOULD include documentation and, as appropriate, migration tools and sample code that provide customers what they need to make a clean migration.")]),e._v(" "),a("li",[e._v("The deprecated API version MUST be in the "),a("code",[e._v("DEPRECATED")]),e._v(" state for a minimum period of time to give client customers adequate notice to migrate. Deprecation of API versions with external clients SHOULD be considered on a case-by-case basis and may require additional deprecation time and/or constraints to minimize impact to the business.")]),e._v(" "),a("li",[e._v("If a versioned API in "),a("code",[e._v("LIVE")]),e._v(" or "),a("code",[e._v("DEPRECATED")]),e._v(" state has no clients, it MAY move to the "),a("code",[e._v("RETIRED")]),e._v(" state immediately.")])]),e._v(" "),a("h3",{attrs:{id:"eol-policy-replacement"}},[e._v("End of Life Policy – Replacement Major API Version Introduction")]),e._v(" "),a("p",[e._v("Since a new major API version that results in deprecation of a pre-existing API version is a significant business investment decision, API owners MUST justify the new major version before beginning significant design and development work.  API owners SHOULD explore all possible alternatives to introducing a new major API version with the objective of minimizing the impact on customers before deciding to introduce a new version. Justification SHOULD include the following:")]),e._v(" "),a("p",[e._v("Business Case")]),e._v(" "),a("ol",[a("li",[e._v("Customer value delivered by new version that is not possible with existing version.")]),e._v(" "),a("li",[e._v("Cost-benefit analysis of deprecated version versus the new version.")]),e._v(" "),a("li",[e._v("Explanation of alternatives to introducing an new major version and why those were not chosen.")]),e._v(" "),a("li",[e._v("If a backwards incompatible change is required to address a critical security issue, items 1 and 2 (above) are not required.")])]),e._v(" "),a("p",[e._v("API Design")]),e._v(" "),a("ol",[a("li",[e._v("A domain model of all resources in the new API version and how they compare to the domain model of the previous major API version.")]),e._v(" "),a("li",[e._v("Description of APIs operations and use cases they implement.")]),e._v(" "),a("li",[e._v("Definition of service level objectives for performance and availability that are equal or better to the major API version to be deprecated.")])]),e._v(" "),a("p",[e._v("Migration Strategy")]),e._v(" "),a("ol",[a("li",[e._v("Number of existing customers impacted; internal, external, and partners.")]),e._v(" "),a("li",[e._v("Communication and support plan to inform existing customers of new version, value, and migration path.")])]),e._v(" "),a("h1",{attrs:{id:"deprecation"}},[e._v("Deprecation")]),e._v(" "),a("p",[e._v("This document describes a solution to deprecate parts of an API as the API evolves. It is an extension to the API Versioning Policy.")]),e._v(" "),a("h3",{attrs:{id:"deprecation-terms-used"}},[e._v("Terms Used")]),e._v(" "),a("p",[e._v("The term "),a("em",[a("code",[e._v("API Element")])]),e._v(" is used throughout this document to refer to the "),a("em",[e._v("things")]),e._v(" that could be deprecated in an API. Examples of an "),a("code",[e._v("API Element")]),e._v(" are: an endpoint, a query parameter, a path parameter, a property within a JSON Object schema, JSON Object schema of a type or a custom HTTP header among other things.")]),e._v(" "),a("p",[e._v("The term "),a("em",[a("code",[e._v("old API")])]),e._v(" is used to indicate existing minor or major version of your API or an existing different API that your API supersedes.")]),e._v(" "),a("p",[e._v("The term "),a("em",[a("code",[e._v("new API")])]),e._v(" is used to indicate a new minor or major version of your API or a new different API that supersedes the "),a("code",[e._v("old API")]),e._v(".")]),e._v(" "),a("p",[a("em",[a("code",[e._v("API definition")])]),e._v(" is in the form of specification of an interface of a service following the "),a("a",{attrs:{href:"http://swagger.io/specification",title:"OpenAPI",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenAPI"),a("OutboundLink")],1),e._v(". API's definition could be found in "),a("code",[e._v("swagger.json")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"deprecation-background"}},[e._v("Background")]),e._v(" "),a("p",[e._v('When defining your API, you must make a lot of material decisions that have long lasting implications. The objective is to make a long-lived, durable, and reusable API. You are trying to get it "right". Practically speaking, however, you are not going to succeed every time. New requirements come in. Your understanding of the problem changes. What probably looked like a good decision at the time, may now limit your ability to elegantly extend your API to satisfy your new understanding. Lightweight decisions made in the past now seem somewhat heavy as the implications come into focus. Maintaining backward compatibility is a persistent challenge.')]),e._v(" "),a("p",[e._v("One option is to create a new major version of your API. This allows you to leave past decisions behind and start fresh. Unfortunately, it also means that all of your clients now need to migrate to new endpoints for any of the new work to deliver customer value. This is hard. Many clients will not move without good incentives. There is a lot of overhead in managing the customer migration. You also need to support two sets of interfaces for quite some time. The other consideration is that your API product may have multiple endpoints, but the breaking changes that you want to make only affect one. Making your customers migrate their applications for all the API endpoints just so you can “fix” one small part is a pretty heavyweight and expensive change. While pure and simple from a philosophical and engineering point of view, it is often unjustifiable from an ROI standpoint. The goal of this guideline is to find a middle ground that provides a more practical path forward when minor changes are needed, but which is still consistent, in spirit, with the "),a("a",{attrs:{href:"#api-versioning-policy"}},[e._v("API Versioning Policy")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"deprecation-requirements"}},[e._v("Requirements")]),e._v(" "),a("p",[e._v("Here are the requirements for deprecation.")]),e._v(" "),a("ol",[a("li",[e._v("An API developer should be able to deprecate an "),a("code",[e._v("API Element")]),e._v(" in a minor version of an API.")]),e._v(" "),a("li",[e._v("An API specification MUST highlight one or more deprecated elements of the API so the API consumers are aware.")]),e._v(" "),a("li",[e._v("An API server MUST inform client app(s) regarding deprecated elements present in request and/or response at runtime so that tools can recognize this, log warnings and highlight the usage of deprecated elements as needed.")]),e._v(" "),a("li",[e._v("Deprecated "),a("code",[e._v("API Elements")]),e._v(" must remain supported for the life of the major version or until customers are no longer using them (the means to determine this are left to the discretion of the API owner since it's their customers who will ultimately be impacted).")])]),e._v(" "),a("h2",{attrs:{id:"deprecation-solution"}},[e._v("Solution")]),e._v(" "),a("p",[e._v("The following describes how to address the requirements listed above. The solution involves addressing documentation related requirement using an annotation and using a custom header to address the runtime related requirement.")]),e._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"#deprecation-documentation"}},[e._v("Documentation")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#deprecation-runtime"}},[e._v("Runtime")])])]),e._v(" "),a("h3",{attrs:{id:"deprecation-documentation"}},[e._v("Documentation")]),e._v(" "),a("p",[e._v("An optional annotation named "),a("code",[e._v("x-deprecated")]),e._v(" is used to mark an "),a("code",[e._v("API Element")]),e._v(" as deprecated in the definition of the API.")]),e._v(" "),a("h4",{attrs:{id:"deprecation-annotation"}},[e._v("Annotation: x-deprecated")]),e._v(" "),a("p",[a("code",[e._v("x-deprecated")]),e._v(" can be used to deprecate any kind of "),a("code",[e._v("API Element")]),e._v(". The annotation should be used inline precisely where the "),a("code",[e._v("API Element")]),e._v(" is defined. It is expected that the API tools generating documentation by introspecting the API definition would recognize this annotation and highlight the corresponding "),a("code",[e._v("API Element")]),e._v(" as deprecated. It is also assumed that this annotation can be completely ignored by tools including those generating implementation bindings (POJO). In other words, it is not in scope of this solution that any implementation language specific construct (such as Java annotation "),a("code",[e._v("@deprecated")]),e._v(") would be generated for the "),a("code",[e._v("x-deprecated")]),e._v(" annotation.")]),e._v(" "),a("p",[e._v("It is expected that the API documentation would highlight deprecated "),a("code",[e._v("API Elements")]),e._v(" annotated by "),a("code",[e._v("x-deprecated")]),e._v(" in the API specification distinctly and at the appropriate granularity.")]),e._v(" "),a("h4",{attrs:{id:"deprecation-schema-annotation"}},[e._v("Schema for x-deprecated Annotation")]),e._v(" "),a("p",[e._v("We have provided specific JSON object types to use for deprecation of specific "),a("code",[e._v("API Elements")]),e._v(". This section lists schema for these types. The intent in providing schema for specific application of "),a("code",[e._v("x-annotation")]),e._v(" is to make it easy for API developers to annotate the "),a("code",[e._v("API definition")]),e._v(" and for API tool(s) to highlight each deprecated "),a("code",[e._v("API Element")]),e._v(" with appropriate details.")]),e._v(" "),a("h5",{attrs:{id:"common-schema-elements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-schema-elements"}},[e._v("#")]),e._v(" Common Schema Elements")]),e._v(" "),a("p",[e._v("Following are common schema types that are used across new JSON object types to be used for deprecation.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\n\t\t"x-deprecatedValue": {\n\t\t\t"type": "string",\n\t\t\t"description": "Value of the element that is deprecated. Use to deprecate a particular value in parameter or schema property as applicable."\n\t\t},\n\t\t"x-deprecatedSee": {\n\t\t\t"type": "string",\n\t\t\t"description": "URI (indirect or absolute) or name of to new parameter, resource, method, api_element, as applicable."\n\t\t},\n\t\t"x-apiVersion": {\n\t\t\t"pattern": "^[1-9][0-9]*[.][0-9]+$",\n\t\t\t"minLength": 3,\n\t\t\t"maxLength": 8,\n\t\t\t"description": "This string should contain the release or version number at which this schema element became deprecated. Version should be in the format \'{major}.{minor}\' (no leading \'v\')."\n\t\t}\n\n')])])]),a("h5",{attrs:{id:"deprecation-schema-resource"}},[e._v("Deprecated Resource")]),e._v(" "),a("p",[e._v("The following schema MUST be used to deprecate resource objects in "),a("code",[e._v("API definition")]),e._v(". Examples of resource object in "),a("code",[e._v("swagger.json")]),e._v(" are: "),a("code",[e._v("operation")]),e._v(" and "),a("code",[e._v("paths")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\t\t"x-deprecatedResource": {\n\t\t\t"type": "object",\n\t\t\t"title": "Schema for a deprecated resource.",\n\t\t\t"description": "Schema for deprecating a resource API element. A resource API element could be an operation or paths.",\n\t\t\t"properties": {\n\t\t\t\t"see": {\n\t\t\t\t\t"$ref": "#/definitions/x-deprecatedSee"\n\t\t\t\t},\n\t\t\t\t"since_version": {\n\t\t\t\t\t"$ref": "#/definitions/x-apiVersion"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n')])])]),a("p",[e._v("The following section provides several examples showing usage of "),a("code",[e._v("deprecatedResource")]),e._v(" for "),a("code",[e._v("x-deprecated")]),e._v(" annotation at resource level.")]),e._v(" "),a("h6",{attrs:{id:"deprecation-example-resource"}},[e._v("Example: Deprecated Resource")]),e._v(" "),a("p",[e._v("The following example shows deprecated resource named "),a("code",[e._v("commercial-entities")]),e._v(" in "),a("code",[e._v("swagger.json")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('    "paths": {\n       \n        "/commercial-entities": {\n             "x-deprecated": {\n            \t\t"see": "financial-entities",\n            \t\t"since_version": "1.4"\n            \t},\n        ...\n        }\n\n')])])]),a("h6",{attrs:{id:"deprecation-example-method"}},[e._v("Example: Deprecated Method")]),e._v(" "),a("p",[e._v("The following example shows a deprecated method "),a("code",[e._v("PUT /commercial-entities/{merchant_id}/agreements")]),e._v(" and encourages to use new method "),a("code",[e._v("PATCH /commercial-entities/{merchant_id}/agreements")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('    "paths": {\n        "/commercial-entities/{merchant_id}/agreements": {\n            "put": {\n                "summary": "Updates the Commercial Entity Agreements Details for a Merchant.",\n                "operationId": "commercial-entity.agreement.update",\n                "x-deprecated": {\n            \t\t\t"see": "patch",\n            \t\t\t"since_version": "1.4"\n            \t},\n            \t"parameters": [\n                    {\n                        "name": "merchant_id",\n                        "in": "path",\n                        "description": "The encrypted Merchant\'s identifier.",\n                        "required": true,\n                        "type": "string"\n                    },\n                    {\n                        "name": "Agreements",\n                        "in": "body",\n                        "description": "An array of AgreementDetails",\n                        "required": true,\n                        "schema": {\n                            "$ref": "./model/agreement_details.json"\n                        }\n                    }\n                ],\n            ...\n         }\n')])])]),a("h5",{attrs:{id:"deprecation-schema-parameter"}},[e._v("Deprecated Parameter")]),e._v(" "),a("p",[a("code",[e._v("swagger.json")]),e._v(" provides a way to define one or more parameter for a method. The type of parameters are: path, query and header. Typically, query and header parameters can be deprecated. The following schema MUST be used while using "),a("code",[e._v("x-deprecated")]),e._v(" annotation for a parameter.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\t\t"x-deprecatedParameter": {\n\t\t\t"type": "object",\n\t\t\t"title": "Schema for a deprecated parameter.",\n\t\t\t"description": "Schema for deprecating an API element inline. The API element could be a custom HTTP header or a query param.",\n\t\t\t"properties": {\n\t\t\t\t"value": {\n\t\t\t\t\t"$ref": "#/definitions/x-deprecatedValue"\n\t\t\t\t},\n\t\t\t\t"see": {\n\t\t\t\t\t"$ref": "#/definitions/x-deprecatedSee"\n\t\t\t\t},\n\t\t\t\t"since_version": {\n\t\t\t\t\t"$ref": "#/definitions/x-apiVersion"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n')])])]),a("p",[e._v("The following section provides several examples showing usage of "),a("code",[e._v("deprecatedParameter")]),e._v(" for "),a("code",[e._v("x-deprecated")]),e._v(" annotation at parameter level.")]),e._v(" "),a("h6",{attrs:{id:"deprecation-example-query-parameter"}},[e._v("Example: Deprecated Query Parameter")]),e._v(" "),a("p",[e._v("The following example shows usage of the "),a("code",[e._v("x-deprecated")]),e._v(" annotation in "),a("code",[e._v("swagger.json")]),e._v(" to indicate deprecation of a query parameter "),a("code",[e._v("record_date")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        "/commercial-entities/{merchant_id}": {\n            "get": {\n                "summary": "Gets a Commercial Entity as denoted by the merchant_id.",\n                "description": "Gets the Commercial Entity as denoted by the merchant_id.",\n                "operationId": "commercial-entity.get",\n                "parameters": [\n                    {\n                        "name": "record_date",\n                        "in": "query",\n                        "description": "The date to use for the query; defaulted to yesterday.",\n                        "required": false,\n                        "type": "string",\n                        "format": "date",\n                        "x-deprecated": {\n                            "since_version": "1.5",\n                            "see": "transaction_date"\n                        }\n                    },\n                    {\n                        "name": "transaction_date",\n                        "in": "query",\n                        "description": "The date to use for the query; defaulted to yesterday.",\n                        "required": false,\n                        "type": "string",\n                        "format": "date"\n                    },\n                    ...\n')])])]),a("h6",{attrs:{id:"deprecation-example-header"}},[e._v("Example: Deprecated Header")]),e._v(" "),a("p",[e._v("The following example shows a deprecated custom HTTP header called "),a("code",[e._v("CLIENT_INFO")]),e._v(".")]),e._v(" "),a("h6",{attrs:{id:"openapi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openapi"}},[e._v("#")]),e._v(" OpenAPI")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        "/commercial-entities/{merchant_id}": {\n            "get": {\n                "summary": "Gets a Commercial Entity as denoted by the merchant_id.",\n                "description": "Gets the Commercial Entity as denoted by the merchant_id.",\n                "operationId": "commercial-entity.get",\n                "parameters": [\n                    ...\n                    {\n                        "name": "CLIENT_INFO",\n                        "in": "header",\n                        "description": "Optional header for all the API\'s to pass on api caller tracking information. This header helps capture any input from the caller service and pass it along to analytics for tracking .",\n                        "in" : "header",\n                        "x-deprecated": {\n                             "since_version": "1.5"\n                        }\n\n                    }\n                    ...\n')])])]),a("h6",{attrs:{id:"deprecation-example-query-parameter-value"}},[e._v("Example: Deprecated Query Parameter Value")]),e._v(" "),a("p",[e._v("The following example shows usage of the "),a("code",[e._v("x-deprecated")]),e._v(" annotation in "),a("code",[e._v("swagger.json")]),e._v(" to indicate deprecation of a specific value ("),a("code",[e._v("y")]),e._v(") for a query parameter named "),a("code",[e._v("fields")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        "/commercial-entities": {\n            "get": {\n                "summary": "Gets Commercial Entities.",\n                "description": "Gets the Commercial Entities.",\n                "operationId": "commercial-entity.get",\n                "parameters": [\n                    {\n                        "name": "fields",\n                        "in": "query",\n                        "description": "Fields to return in response, default is x, possible values are x, y, z.",\n                        "required": false,\n                        "type": "string",\n                        "x-deprecated": {\n                            "since_version": "1.5",\n                            "value": "y"\n                        }\n                    },\n                    {\n                        "name": "transaction_date",\n                        "in": "query",\n                        "description": "The date to use for the query; defaulted to yesterday.",\n                        "required": false,\n                        "type": "string",\n                        "format": "date"\n                    },\n                    ...\n')])])]),a("h5",{attrs:{id:"deprecation-schema-object"}},[e._v("Deprecated JSON Object Schema")]),e._v(" "),a("p",[e._v("In order to deprecate a schema of JSON Object itself or one or more properties within the JSON Object schema, we recommend using a schema called "),a("code",[e._v("deprecatedSchema")]),e._v(" for the "),a("code",[e._v("x-deprecated")]),e._v(" annotation.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\t\t"x-deprecatedSchema": {\n\t\t\t"type": "array",\n\t\t\t"description": "Schema for a collection of deprecated items in a schema.",\n\t\t\t"items": {\n\t\t\t\t"$ref": "#/definitions/x-deprecatedSchemaProperty"\n\t\t\t}\n\t\t}\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('\t\t"x-deprecatedSchemaProperty": {\n\t\t\t"type": "object",\n\t\t\t"title": "Schema for a deprecated schema property or schema itself.",\n\t\t\t"description": "Schema for deprecating an API element within JSON Object schema. The API element could be an individual property of a schema of a JSON type or an entire schema representing JSON object.",\n\t\t\t"required": ["api_element"],\n\t\t\t"properties": {\n\t\t\t\t"api_element": {\n\t\t\t\t\t"type": "string",\n\t\t\t\t\t"description": "JSON pointer to API element that is deprecated. If the API element is JSON Object schema of a type itself, JSON pointer MUST point to the root of that schema. If the API element is a property of schema, the JSON pointer MUST point to that property."\n\t\t\t\t},\n\t\t\t\t"value": {\n\t\t\t\t\t"$ref": "#/definitions/x-deprecatedValue"\n\t\t\t\t},\n\t\t\t\t"see": {\n\t\t\t\t\t"$ref": "#/definitions/x-deprecatedSee"\n\t\t\t\t},\n\t\t\t\t"since_version": {\n\t\t\t\t\t"$ref": "#/definitions/x-apiVersion"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n')])])]),a("p",[e._v("In order to avoid extending JSON draft-04 schema with "),a("code",[e._v("keywords")]),e._v(" needed to either deprecate the schema itself by using "),a("code",[e._v("x-annotation")]),e._v(" in metadata section of the schema or deprecate individual properties inline, we have chosen a less disruptive route of using "),a("code",[e._v("x-annotation")]),e._v(" next to references for JSON Object in "),a("code",[e._v("API definition")]),e._v(". Therefore, this annotation SHOULD be used in "),a("code",[e._v("API definition")]),e._v(' where schema is "referred". In case if you are OK with inlining, you should go ahead and annotate individual deprecated properties in schema or schema itself.')]),e._v(" "),a("p",[e._v("As of March 2017, "),a("a",{attrs:{href:"https://github.com/OAI/OpenAPI-Specification/blob/OpenAPI.next/versions/3.0.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenAPI 3.0.0-rc0"),a("OutboundLink")],1),e._v(" has introduced "),a("code",[e._v("deprecated")]),e._v(" flag to apply at operation, parameter and schema field levels. "),a("code",[e._v("x-annotation")]),e._v(" could be used alongside the "),a("code",[e._v("deprecated")]),e._v(" flag to provide additional useful information for the deprecated "),a("code",[e._v("API Element")]),e._v(".")]),e._v(" "),a("h6",{attrs:{id:"deprecation-example-schema-property"}},[e._v("Example: Deprecated Property In Response")]),e._v(" "),a("p",[e._v("The following example shows usage of the "),a("code",[e._v("x-deprecated")]),e._v(" annotation in "),a("code",[e._v("API definitions")]),e._v(" to indicate deprecation of a property named "),a("code",[e._v("address")]),e._v(" in response.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        "/commercial-entities/{merchant_id}": {\n            "get": {\n                "summary": "Gets a Commercial Entity as denoted by the merchant_id.",\n                "description": "Gets the Commercial Entity as denoted by the merchant_id.",\n                "operationId": "commercial-entity.get",\n                "responses": {\n                    "200": {\n                        "description": "The Commercial Entity.",\n                        "schema": {\n                            "$ref": "./model/interaction/commercial-entities/merchant_id/get_response.json",\n                            "x-deprecated": [\n            \t\t\t\t\t   {\n            \t\t\t\t\t\t  "api_element": "./model/interaction/commercial-entities/merchant_id/get_response.json#/address",\n            \t\t\t\t\t\t  "see": "./model/interaction/commercial-entities/merchant_id/get_response.json#/global_address",\n            \t\t\t\t\t\t  "since_version": "1.4"\n            \t\t\t\t\t   }\n            \t\t\t\t    ] \n                        }\n                    },\n                    "default": {\n                        "description": "Unexpected error",\n                        "schema": {\n                            "$ref": "v1/schema/json/draft-04/error.json"\n                        }\n                    }\n                }\n')])])]),a("h6",{attrs:{id:"deprecation-example-enum"}},[e._v("Example: Deprecated Enum In Response")]),e._v(" "),a("p",[e._v("The following example shows usage of the "),a("code",[e._v("x-deprecated")]),e._v(" annotation in "),a("code",[e._v("API definitions")]),e._v(" to indicate deprecation of an enum "),a("code",[e._v("FAILED")]),e._v(" used by a property named "),a("code",[e._v("state")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('       "/commercial-entities/{merchant_id}": {\n            "get": {\n                "summary": "Gets a Commercial Entity as denoted by the specified merchant identifier.",\n                "description": "Gets the Commercial Entity as denoted by the specified merchant identifier.",\n                "operationId": "commercial-entity.get",\n                "responses": {\n                    "200": {\n                        "description": "The Commercial Entity.",\n                        "schema": {\n                            "$ref": "./model/interaction/commercial-entities/merchant_id/get_response.json",\n                            "x-deprecated": [\n            \t\t\t\t\t   {\n            \t\t\t\t\t\t  "api_element": "./model/interaction/commercial-entities/merchant_id/get_response.json#/state",\n            \t\t\t\t\t\t  "value": "FAILED",\n            \t\t\t\t\t\t  "since_version": "1.4"\n            \t\t\t\t\t   }\n            \t\t\t\t    ] \n                        }\n                    },\n                    "default": {\n                        "description": "Unexpected error",\n                        "schema": {\n                            "$ref": "v1/schema/json/draft-04/error.json"\n                        }\n                    }\n                }\n\t\t\t\n\n')])])]),a("h3",{attrs:{id:"deprecation-runtime"}},[e._v("Runtime")]),e._v(" "),a("p",[e._v("The API server MUST inform client app(s) of the deprecated "),a("code",[e._v("API element")]),e._v("(s) present in request and/or response.")]),e._v(" "),a("h4",{attrs:{id:"deprecation-header"}},[e._v("Header: Foo-Deprecated")]),e._v(" "),a("p",[e._v("It is recommended to use a custom HTTP header named "),a("code",[e._v("Foo-Deprecated")]),e._v(" to convey deprecation related information. The service MUST respond with the "),a("code",[e._v("Foo-Deprecated")]),e._v(" header in the following cases:")]),e._v(" "),a("ol",[a("li",[e._v("The caller has used one or more deprecated element in request.")]),e._v(" "),a("li",[e._v("There is one or more deprecated element in the response.")])]),e._v(" "),a("p",[e._v("In order to avoid bloating the responses with static information related to deprecation that does not change from response to response on the same end point, we recommend that API developers provide just an empty JSON object as a value as shown below. In the future, we plan to replace this with something that still does not bloat the responses but still provides enough information so that tools could scan responses for deprecation and take appropriate actions such as notifying App developers/administrators.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"Foo-Deprecated": "{}"\n')])])]),a("p",[a("strong",[e._v("Note")]),e._v(": Applications consuming this header MUST not take any action based on the value of the header at this time. Instead, we recommend that these applications SHOULD take action based only on the existence of the header in the response.")]),e._v(" "),a("p",[e._v("References")]),e._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"http://openjdk.java.net/jeps/277",target:"_blank",rel:"noopener noreferrer"}},[e._v("JEP Enhanced Deprecation"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"http://docs.oracle.com/javase/7/docs/technotes/guides/javadoc/deprecation/deprecation.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("How and When to Deprecate APIs"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"http://semver.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Semantic Versioning 2.0"),a("OutboundLink")],1)])]),e._v(" "),a("h1",{attrs:{id:"patterns-and-use-cases"}},[e._v("Patterns And Use Cases")]),e._v(" "),a("p",[e._v("Please refer to "),a("RouterLink",{attrs:{to:"/api-style-guide/patterns.html"}},[e._v("Patterns And Use Cases")]),e._v(".")],1)])}),[],!1,null,null,null);t.default=s.exports}}]);